{"PublicRelease": "\u00a92020 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-03607-4", "Techniques": [{"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "An MSSP detection for \"T1043\" occurred containing evidence of powershell.exe connecting to 192.168.0.5 on TCP 443.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12807.png", "ScreenshotCaption": "MSSP - B3/4/5 - port information"}]}, {"DetectionNote": "Telemetry showed powershell.exe connecting outbound to 192.168.0.5 on TCP 443. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6515.png", "ScreenshotCaption": "B3/4/5 - Network connection, powershell exchanging data with host over https"}]}]}, {"SubStep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "An MSSP detection for \"T1043\" occurred containing evidence of PowerShell making network connection to C2 (192.168.0.4) over port 443 via HTTPS.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12849.png", "ScreenshotCaption": "MSSP - A13/14/15 - network information"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6810.png", "ScreenshotCaption": "A13/14/15 - Connection information including, IP, port, protocol, and encryption dectection"}, {"ScreenshotName": "SentinelOne-APT29-6786.png", "ScreenshotCaption": "A11 - Regkey software/windows/CurrentVersion/run being added"}]}]}]}, {"TechniqueId": "T1140", "TechniqueName": "Deobfuscate/Decode Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Detections": [{"DetectionNote": "An MSSP detection for \"T1140\" occurred containing evidence of the extracted root folder being created, and the contents extracted.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12810.png", "ScreenshotCaption": "MSSP - A3- file unzipping"}]}, {"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6523.png", "ScreenshotCaption": "A3 - Shows the unzipped files being created"}, {"ScreenshotName": "SentinelOne-APT29-7187.png", "ScreenshotCaption": "CC - A3 - Generic alert created for Expand-Archive execution"}]}]}, {"SubStep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Detections": [{"DetectionNote": "An MSSP detection for \"T1140\" occurred containing evidence of certutil.exe decoding kxwn.lock with command-line arguments.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12848.png", "ScreenshotCaption": "MSSP - A10/11/12"}]}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6784.png", "ScreenshotCaption": "A10 - Certutil calling decode on kxwn.lock"}]}]}, {"SubStep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Detections": [{"DetectionNote": "An MSSP detection for \"T1027\" occurred containing evidence of \"wmidump\" function definition and WMI indicators reading from Win32_AuditCode.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12872.png", "ScreenshotCaption": "MSSP - WMIDUMP SBL"}, {"ScreenshotName": "SentinelOne-APT29-12873.png", "ScreenshotCaption": "MSSP - WMI read audit of code"}]}, {"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7261.png", "ScreenshotCaption": "CC - B6 - Powershell alert of Get-WmiObject"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"TechniqueId": "T1122", "TechniqueName": "Component Object Model Hijacking", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of\u00a0the DelegateExecute\u00a0\u200bsubkey in\u00a0\u200bHKCU\\Software\\Classes\\Folder\\shell\\open\\\u200b\u200bcommand\u200b\u200b", "Detections": [{"DetectionNote": "An MSSP detection for \"T1122\" occurred containing evidence of DelegateExecute subkey being added to the Registry.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12804.png", "ScreenshotCaption": "MSSP - B1 - Registry additions"}]}, {"DetectionNote": "Telemetry showed addition of the DelegateExecute Registry Value. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6508.png", "ScreenshotCaption": "B.1 - shows creation of new regkey, AND mention DelegateExecute"}]}]}, {"SubStep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Detections": [{"DetectionNote": "An MSSP detection for \"T1122\" occurred containing evidence of \"bypass\" function definition with Software\\classes\\folder Registry key being modified and leveraged in COM hijacking.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12863.png", "ScreenshotCaption": "MSSP - HI PowerShell, SBL"}]}, {"DetectionNote": "Telemetry showed PowerShell function definition of \"bypass\" which adds the DelegateExecute subkey. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7254.png", "ScreenshotCaption": "CC - A1/3 - Powershell alert of bypass function containing add and delete"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Detections": [{"DetectionNote": "An MSSP detection for \"basic discovery\" containing evidence of $env:USERDOMAIN usage.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12815.png", "ScreenshotCaption": "MSSP - C1-5 - readme.ps1"}]}]}, {"SubStep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "A Technique alert detection for \"SuspiciousWMIQuery\" under \"Discovery {T1016}\" was generated on a suspicious WMI query targeting Win32_ComputerSystem.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6793.png", "ScreenshotCaption": "A4/6/7 - WMI win32_computer system"}]}, {"DetectionNote": "An MSSP detection for \"information discovery\" occurred containing evidence of WMI query targeting Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12845.png", "ScreenshotCaption": "MSSP - pnp, process enumeration, win32_process, file enumeration"}]}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-17530.png", "ScreenshotCaption": "11.A.7 - WMIOperation for Win32_ComputerSystem"}]}]}, {"SubStep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-17874.png", "ScreenshotCaption": "13.B.1 - MSSP"}]}, {"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7249.png", "ScreenshotCaption": "CC - B1 - Generic powershell alert showing NetWkstaGetInfo call"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"TechniqueId": "T1005", "TechniqueName": "Data from Local System", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "A Technique alert detection for \"Data from Local System {T1005}\" was generated on powershell.exe executing Get-ChildItem and reading C:\\Users\\Pam\\*. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7164.png", "ScreenshotCaption": "CC - A3 - All files being read in C:\\users\\pam\\links\\*"}, {"ScreenshotName": "SentinelOne-APT29-7161.png", "ScreenshotCaption": "CC - A3 - File open alert of file in C:\\users\\pam\\links\\desktop.lnk"}], "Footnotes": ["A Detection Configuration Change was made to Get-ChildItem to align usage with Data from Local System (T1005)."]}, {"DetectionNote": "An MSSP detection for \"PowerShell is seen enumerating the system and searching for files\" contained evidence of file reads to C:/Users/Pam/*.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12797.png", "ScreenshotCaption": "A2/3 - MSSP - ChildItem call"}]}, {"DetectionNote": "Telemetry showed powershell.exe reading files from C:\\Users\\Pam\\*. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7164.png", "ScreenshotCaption": "CC - A3 - All files being read in C:\\users\\pam\\links\\*"}], "Footnotes": ["A Detection Configuration Change was made to Get-ChildItem to align usage with Data from Local System (T1005)."]}]}, {"SubStep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Detections": [{"DetectionNote": "A Technique alert detection for \"Data from Local System {T1005}\" was generated due to powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Configuration Change (Detections)", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14732.png", "ScreenshotCaption": "7.B.1 - Process file reads in Downloads"}], "Footnotes": ["A Detection Configuration Change was made to align PowerShell process file reads with Data from Local System (T1005)"]}, {"DetectionNote": "No detection capability demonstrated for this procedure, though data showing file reads was retrieved from the encrypted cache on the host by an analyst.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6686.png", "ScreenshotCaption": "B1 - Host query of to be zipped files being accessed"}], "Footnotes": ["The script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation."]}]}, {"SubStep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "A Technique alert detection for \"OpenedFile\" under \"Data from Local System {T1005}\" was generated when a known malicious powershell.exe read files in C:\\Users\\Pam\\*. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7240.png", "ScreenshotCaption": "CC - B4 -  enumeration of C:/users/pam via OpenFile alert"}, {"ScreenshotName": "SentinelOne-APT29-7241.png", "ScreenshotCaption": "CC - B4 -  enumeration of C:/users/pam via OpenFile alert"}], "Footnotes": ["A Detection Configuration Change was made to Get-ChildItem to align usage with Data from Local System (T1005)."]}]}, {"SubStep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "A Technique alert detection for Data from Local System was generated for a process reading MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Configuration Change (Detections)", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7266.png", "ScreenshotCaption": "CC - B1 - File Read to C:\\Windows\\Temp\\WindowsParentalControlMigration\\ MITRE-ATTACK-EVALS.HTML"}], "Footnotes": ["The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change."]}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby ", "Detections": [{"DetectionNote": "An MSSP detection for \"T1136\" occurred containing evidence of Invoke-Command with command-line arguments adding the user Toby.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12894.png", "ScreenshotCaption": "MSSP - PS-session + user add"}]}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net1.exe with the command-line arguments to add the new user Toby.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7041.png", "ScreenshotCaption": "B3 - net1.exe creating user toby"}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "An MSSP detection for \"T1012\" occurred containing scriptblock with registry query for installed software.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12856.png", "ScreenshotCaption": "MSSP - C1/2 - SBL"}]}, {"DetectionNote": "Telemetry showed script block with registry query for installed software. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7246.png", "ScreenshotCaption": "CC - C1 - Powershell alert showing query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}, {"SubStep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "An MSSP detection for \"T1012\" occurred containing scriptblock with registry query for installed software.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12856.png", "ScreenshotCaption": "MSSP - C1/2 - SBL"}]}, {"DetectionNote": "Telemetry showed scriptblock with registry query for installed software. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7247.png", "ScreenshotCaption": "CC - C2 - powershell alert showing query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall"}]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Detections": [{"DetectionNote": "A Technique alert detection for \"StartupDirectory\" under was generated due to the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6559.png", "ScreenshotCaption": "B1 - Additional indicator of persistence "}]}, {"DetectionNote": "An MSSP detection for \"T1060\" occurred containing evidence of PowerShell placing LNK in startup folder, gaining persistence to launch hostui.bat.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12821.png", "ScreenshotCaption": "MSSP - B1 - powershell SBL"}, {"ScreenshotName": "SentinelOne-APT29-12820.png", "ScreenshotCaption": "MSSP - B1 - houstui.lnk/.bat/.exe"}]}, {"DetectionNote": "Telemetry showed the creation of hostui.lnk in the Startup folder. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14685.png", "ScreenshotCaption": "5.B.1 - File Creation for hostui.lnk in Startup"}]}]}, {"SubStep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Detections": [{"DetectionNote": "A Technique alert detection for \"StartedFromLnk\" under \"Registry Run Keys / Startup Folder {T1060}\" was generated due to hostui.lnk triggering on login from the StartUp Folder.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7243.png", "ScreenshotCaption": "CC - B1 - hostui.lnk in startup folder - StartedFromLnk indicator"}], "Footnotes": ["A Detection Configuration Change was made to capture .lnk files triggering on login from the StartUp folder. Aligned usage with \"StartedFromLnk\" under \"Registry Run Keys / Startup Folder {T1060}\"."]}, {"DetectionNote": "An MSSP detection for \"startup persistence\" occurred containing evidence of hostui.lnk executing from Startup Folder.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12842.png", "ScreenshotCaption": "MSSP - B1 - .lnk "}]}, {"DetectionNote": "Telemetry showed hostui.lnk executing from the Startup Folder.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7243.png", "ScreenshotCaption": "CC - B1 - hostui.lnk in startup folder - StartedFromLnk indicator"}]}]}, {"SubStep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Detections": [{"DetectionNote": "A Technique alert detection for \"RegistryAutorun\" under \"Persistence {T1060}\" was generated for powershell.exe adding Run key persistence into the Registry.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6786.png", "ScreenshotCaption": "A11 - Regkey software/windows/CurrentVersion/run being added"}]}, {"DetectionNote": "An MSSP detection for \"T1060\" occurred containing evidence of Webcache subkey added to Registry.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12848.png", "ScreenshotCaption": "MSSP - A10/11/12"}]}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6786.png", "ScreenshotCaption": "A11 - Regkey software/windows/CurrentVersion/run being added"}]}]}]}, {"TechniqueId": "T1097", "TechniqueName": "Pass the Ticket", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Detections": [{"DetectionNote": "A General alert detection for \"TokenPrivAdd\" under \"Privilege Escalation/Defense Evation {T1134} \" was generated when Invoke-Mimikatz (kerberos::golden) to create and inject ticket into current session was executed. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7011.png", "ScreenshotCaption": "B1 - Token Manipulation alert generated"}]}, {"DetectionNote": "An MSSP detection for \"T1097\" occurred containing evidence of  Invoke-Mimikatz (kerberos::golden) usage along with Token Manipulation indicator.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12893.png", "ScreenshotCaption": "MSSP - Invoke + indicator"}]}]}]}, {"TechniqueId": "T1099", "TechniqueName": "Timestomp", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection for \"FileTimeCopied\" was generated due to GetCreationTime API call targeting kxwn.lock. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6828.png", "ScreenshotCaption": "Powershell parent process"}]}, {"DetectionNote": "An MSSP detection for \"T1099\" occurred containing evidence of timestamp modifications of kxwn.lock.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12852.png", "ScreenshotCaption": "MSSP - A1 - FileEnum + gci SBL"}, {"ScreenshotName": "SentinelOne-APT29-12853.png", "ScreenshotCaption": "MSSP - A2 - FileTime alerts"}]}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "A Technique alert detection for \"ProcessEnumeration\" under \"Discovery {T1057}\" was generated for PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14654.png", "ScreenshotCaption": "4.B.1 - Process Discovery from PowerShell"}]}, {"DetectionNote": "An MSSP detection for \"T1057\" occurred containing evidence of PowerShell listing current process via \u201cGet-Process\u201d.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12811.png", "ScreenshotCaption": "MSSP - B1 - Get-Process"}]}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7189.png", "ScreenshotCaption": "CC - B1 - Generic alert for Execution of Get-Process in UI"}], "Footnotes": ["A UX Configuration Change was made to bring Get-Process usage from host logs into the user interface."]}]}, {"SubStep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Detections": [{"DetectionNote": "A Technique alert detection for \"ProcessEnumeration\" was generated when PowerShell accessed $PID. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6536.png", "ScreenshotCaption": "C5 - Shows general discovery, no mention of environment variable."}]}, {"DetectionNote": "An MSSP detection for \"basic discovery\" containing evidence of $PID usage.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12815.png", "ScreenshotCaption": "MSSP - C1-5 - readme.ps1"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing: $PID.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "A Technique alert detection for \"ProcessEnumeration\" under \"Discovery {T1057}\" was generated due to Invoke-Command executing Get-Process. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6696.png", "ScreenshotCaption": "A3 - wmirm alert - Process enumeration"}]}, {"DetectionNote": "An MSSP detection for \"ProcessEnumeration\" occurred containing evidence of WinRM alerting on Get-Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12831.png", "ScreenshotCaption": "MSSP - More WinRM alerts and Get-Process"}]}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7233.png", "ScreenshotCaption": "CC - A3 - Powershell using Get-Process"}], "Footnotes": ["A UX Configuration Change was made to bring Get-Process usage from host logs into the user interface."]}]}, {"SubStep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Detections": [{"DetectionNote": "A Technique alert detection for \"ProcessEnumeration\" under \"Discovery {T1057}\" was generated due to the PowerShell gwmi query for Win32_Process.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14983.png", "ScreenshotCaption": "11.A.8 - Process Discovery"}]}, {"DetectionNote": "A Tactic alert detection for \"Discovery\" under \"SuspiciousWMIQuery\" was generated on a suspicious WMI query targeting Win32_Process. ", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6794.png", "ScreenshotCaption": "A8 - WMI win32_process"}]}, {"DetectionNote": "An MSSP detection for \"information discovery\" occurred containing evidence of Process Enumeration relating to WMI query targeting Win32_Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12845.png", "ScreenshotCaption": "MSSP - pnp, process enumeration, win32_process, file enumeration"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-17534.png", "ScreenshotCaption": "11.A.8 - WMIOperation for Win32_Process"}]}]}, {"SubStep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Detections": [{"DetectionNote": "A Technique alert detection for \"ProcessEnumeration\" was generated due to running processes being enumerated. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6846.png", "ScreenshotCaption": "D1 - Alert generated for process enumeration"}]}, {"DetectionNote": "An MSSP detection for \"T1057\" occurred containing evidence of Process Enumeration and \"pslist\" function which calls CreateToolhelp32Snapshot API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12859.png", "ScreenshotCaption": "MSSP - D1 - pslist SBL and alert"}]}, {"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7252.png", "ScreenshotCaption": "CC - D1 - Powershell alert containing call to CreateToolhelp32Snapshot API"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}, {"SubStep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "A Technique alert detection for \"ProcessEnumeration\" under \"Discovery {T1057}\" was generated for PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6876.png", "ScreenshotCaption": "B2 - Process enumeration alert"}]}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7258.png", "ScreenshotCaption": "CC - B2 - Powershell alert of command containing get-process"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Detections": [{"DetectionNote": "An MSSP detection for \"basic discovery\" containing evidence of $env:USERNAME usage.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12815.png", "ScreenshotCaption": "MSSP - C1-5 - readme.ps1"}]}]}, {"SubStep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "A Tactic alert detection for \"Discovery\" was generated on a suspicious WMI query targeting Win32_ComputerSystem.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6793.png", "ScreenshotCaption": "A4/6/7 - WMI win32_computer system"}]}, {"DetectionNote": "An MSSP detection for \"information discovery\" occurred containing evidence of WMI query targeting Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12845.png", "ScreenshotCaption": "MSSP - pnp, process enumeration, win32_process, file enumeration"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-17530.png", "ScreenshotCaption": "11.A.7 - WMIOperation for Win32_ComputerSystem"}]}]}, {"SubStep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell script block log with function definition of \"user\" which calls GetUserNameEx API. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7250.png", "ScreenshotCaption": "CC - C1 - Powershell alert of GetUserNameEx API being used"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}, {"SubStep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Detections": [{"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7262.png", "ScreenshotCaption": "CC - A1 - Powershell alert of wmi function definition which shows  $env:Username reference "}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}, {"SubStep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Detections": [{"DetectionNote": "An MSSP detection for \"T1033\" occurred containing evidence of ConvertSidToStringSid API usage.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12877.png", "ScreenshotCaption": "MSSP - ConvertSidToStringSid, Advapi32.dll"}]}, {"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7264.png", "ScreenshotCaption": "CC - B1/2 - Powershell alert of ConvertSidToStringSid being used in script"}, {"ScreenshotName": "SentinelOne-APT29-7265.png", "ScreenshotCaption": "CC - B1/2 - powershell alert of siduser function definition "}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "An MSSP detection for \"T1041\" containing evidence of a cod.3aka3.scr reading Draft.zip and a network connection to C2 (192.168.0.5).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12800.png", "ScreenshotCaption": "B1 - MSSP - file read + network connection"}]}, {"DetectionNote": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14572.png", "ScreenshotCaption": "2.B.1 - rcs.3aka3.doc network connection"}, {"ScreenshotName": "SentinelOne-APT29-14571.png", "ScreenshotCaption": "2.B.1 - rcs.3aka3.doc opening Draft.zip"}], "Footnotes": ["A UX Configuration Change was made to bring host file reads into the UI."]}]}, {"SubStep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe\u00a0reading the file working.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "An MSSP detection for \"T1041\" occurred containing evidence of the C2 instance of Python.exe being observed establishing a network connection to 192.168.0.4 on port 8443 (https). ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-13193.png", "ScreenshotCaption": "MSSP - B8 - network connection"}, {"ScreenshotName": "SentinelOne-APT29-12839.png", "ScreenshotCaption": "MSSP - B5/6 - file creation event"}]}, {"DetectionNote": "Telemetry showed file read event for working.zip and an existing C2 channel (192.168.0.4 over TCP port 8443).", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7242.png", "ScreenshotCaption": "CC - B8 - Python.exe opening working.zip"}, {"ScreenshotName": "SentinelOne-APT29-6748.png", "ScreenshotCaption": "B8 - Python connecting to 192.168.0.4 over 8443"}], "Footnotes": ["A UX Configuration Change was made to bring host file reads into the UI."]}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Detections": [{"DetectionNote": "A Technique alert detection for \"TokenMismatch\" under \"Privilege Escalation {T1134}\" was generated when the parent process's, hostui.exe, token did not match the child token process's, powershell.exe, token. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6772.png", "ScreenshotCaption": "B2/3 - hostui.exe executing powershell. Token mismatch alert"}]}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetGroups\u00a0API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "4.C.11", "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetLocalGroups\u00a0API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1028", "TechniqueName": "Windows Remote Management", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection for \"WinRMSession\" under \"Lateral Movement {T1028}\" was generated when a connection to remote host Scranton (10.0.1.4) from host Nashua (10.0.1.6) over port 5985 using the wsman protocol was issued.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6698.png", "ScreenshotCaption": "A2 -  Connection from Nashua to Scranton over port 5985"}, {"ScreenshotName": "SentinelOne-APT29-6695.png", "ScreenshotCaption": "A2 - wmirm alert - Lateral movement"}]}, {"DetectionNote": "An MSSP detection for \"T1028\" occurred containing evidence of Lateral Movement via WinRM with wsman network connection to host Scranton (10.0.1.4) over port 5985.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12830.png", "ScreenshotCaption": "MSSP - ldap, wsman, SBL of AD-Search"}, {"ScreenshotName": "SentinelOne-APT29-12831.png", "ScreenshotCaption": "MSSP - More WinRM alerts and Get-Process"}]}]}, {"SubStep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection for \"WinRMSession\" was generated for the creation of a WinRM session. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6913.png", "ScreenshotCaption": "C1 - WinRM Session alert generated"}]}, {"DetectionNote": "An MSSP detection for \"T1028\" occurred containing evidence of a connection to remote host NewYork (10.0.0.4) over port 5985 using the wsman protocol, and a WinRM indicator for Lateral Movement.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12879.png", "ScreenshotCaption": "MSSP - network information"}]}, {"DetectionNote": "Telemetry showed connection to remote host NewYork (10.0.0.4) over port 5985 using the wsman protocol. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6910.png", "ScreenshotCaption": "C1 - Connection to NewYork over 5985"}, {"ScreenshotName": "SentinelOne-APT29-15014.png", "ScreenshotCaption": "16.C.1 - Correlation of WinRM to prior context"}]}]}, {"SubStep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "An MSSP detection for \"T1028\" occurred containing evidence of Enter-PSSession to create WinRM session to remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12894.png", "ScreenshotCaption": "MSSP - PS-session + user add"}]}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to remote host Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7016.png", "ScreenshotCaption": "B2 - Powershell connecting to Scranton over port 5985 via wsman protocol"}]}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Detections": [{"DetectionNote": "A Technique alert detection for \"SuspiciousKeylogging\" was generated due to GetAsyncKeyState execution. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7214.png", "ScreenshotCaption": "CC - A2/3 - Alerts for Suspicious keylogging and screenshots"}], "Footnotes": ["A Detection Configuration Change was made to align GetAsyncKeyState usage with \"SuspiciousKeylogging\" under \"Collection {T1056}\"."]}, {"DetectionNote": "An MSSP detection for \"T1056\" occurred containing evidence of GetAsyncKeyState API calls and Get-Keystrokes function call.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12826.png", "ScreenshotCaption": "MSSP - A3 - KeyLogging alert"}, {"ScreenshotName": "SentinelOne-APT29-12827.png", "ScreenshotCaption": "MSSP - A3 - SBL GetSyncState"}]}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7211.png", "ScreenshotCaption": "CC - A3 - Powershell script using the GetAsyncKeyState API call"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Detections": [{"DetectionNote": "A Technique alert detection for \"ClipBoardAccess\" was generated due to PowerShell executing Get-Clipboard. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7216.png", "ScreenshotCaption": "CC - A2/3 - Alerts for Clipboard Access"}], "Footnotes": ["A Detection Configuration Change was made to align Get-Clipboard cmdlet usage with \"ClipBoardAccess\"."]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7206.png", "ScreenshotCaption": "CC - A2 - Powershell calling Get-Clipboard"}], "Footnotes": ["A UX Configuration Change was made to bring Get-Clipboard usage from host logs into the user interface."]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Detections": [{"DetectionNote": "An MSSP detection for \"T1018\" occurred containing evidence of Ad-Search function definition along with LDAP network connection to NewYork (10.0.0.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12830.png", "ScreenshotCaption": "MSSP - ldap, wsman, SBL of AD-Search"}]}, {"DetectionNote": "Telemetry showed powershell.exe establishing a connection identified as LDAP over port 389 to NewYork (10.0.0.4). The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6690.png", "ScreenshotCaption": "A1 - Shows LDAP connection from Nashua to Scranton"}, {"ScreenshotName": "SentinelOne-APT29-6692.png", "ScreenshotCaption": "A1 - Specifically identifies protocol as LDAP"}]}]}, {"SubStep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Detections": [{"DetectionNote": "Telemetry showed PowerShell loading System.DirectoryServices.dll and making a network connection to the domain controller NewYork (10.0.0.4).", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6899.png", "ScreenshotCaption": "A1 -  LDAP network connection information"}, {"ScreenshotName": "SentinelOne-APT29-6906.png", "ScreenshotCaption": "A1 - System.directoryservices.dll being loaded by powershell"}]}]}]}, {"TechniqueId": "T1102", "TechniqueName": "Web Service", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Detections": [{"DetectionNote": "An MSSP detection for \"T1102\" occurred containing evidence of net.exe with command-line arguments connecting to OneDrive public IP and URL over port 443 using HTTPS.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12887.png", "ScreenshotCaption": "MSSP - Outlook network information"}, {"ScreenshotName": "SentinelOne-APT29-12886.png", "ScreenshotCaption": "MSSP - net.exe CLI ARGs"}]}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6952.png", "ScreenshotCaption": "A1 - net.exe making connection to OneDrive domain"}, {"ScreenshotName": "SentinelOne-APT29-6955.png", "ScreenshotCaption": "A1 - Network connection information port, ip, protocol using Net Command and shows HTTPS"}]}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav\u00a0network share (192.168.0.4:80)", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of exfiltration via WebDav.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12829.png", "ScreenshotCaption": "MSSP - B4 - wmi and network connection"}, {"ScreenshotName": "SentinelOne-APT29-12828.png", "ScreenshotCaption": "MSSP - B2/3/4 - Invoke-Exfil SBL and OfficeSupplies.zip creation"}]}, {"DetectionNote": "Telemetry showed PoweShell Copy-Item to remote a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7231.png", "ScreenshotCaption": "CC - B4 -Powershell alert containing Copy-Item and also password used by redteam"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}, {"SubStep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Detections": [{"DetectionNote": "An MSSP detection for \"T1048\" occurred containing evidence of PowerShell executing Copy-Item on WindowsParentalControlMigration.tmp.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12887.png", "ScreenshotCaption": "MSSP - Outlook network information"}]}, {"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7282.png", "ScreenshotCaption": "CC - A2 - Generic powershell alert showing Copy-Item call"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process \u200bOR the original filename (cod.3aka.scr)", "Detections": [{"DetectionNote": "A Technique alert detection called \"Masquerading\" was generated for \"SuspiciousCharInPath\" observed on rcs.3aka.doc.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6463.png", "ScreenshotCaption": "A.2 - Specifically shows and describes masquerading via a specific character"}]}, {"DetectionNote": "An MSSP detection for the RTLO character in [?]cod.3aka3.scr was used to masquerade as rcs.3aka.doc.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12369.png", "ScreenshotCaption": "A2 - MSSP - Description of LTR override char"}]}]}, {"SubStep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesscheck.exe is not the legitimate Sysinternals tool", "Detections": [{"DetectionNote": "An MSSP detection for \"T1036\" occurred containing evidence of accesschk.exe with an MD5 value which was also found publicly and is known to be malicious.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12822.png", "ScreenshotCaption": "MSSP - A1/3 - asscesschk.exe usage and alerts"}]}, {"DetectionNote": "Telemetry showed accesschk.exe is not a signed Microsoft binary with hash value provided. This can be used to verify it is not the legitimate Sysinternals tool. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6562.png", "ScreenshotCaption": "A3 - Shows Sysinternals is not signed"}, {"ScreenshotName": "SentinelOne-APT29-6569.png", "ScreenshotCaption": "Showing hash value of Sysinternals"}]}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Detections": [{"DetectionNote": "An MSSP detection for \"basic discovery\" containing evidence of $env:COMPUTERNAME usage.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12815.png", "ScreenshotCaption": "MSSP - C1-5 - readme.ps1"}]}]}, {"SubStep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing\u200b Gwmi Win32_OperatingSystem", "Detections": [{"DetectionNote": "A Technique alert detection for \"Local Environment Information Discovery\" specific to WMI was generated when PowerShell executed the suspicious WMI query containing Win32_OperatingSystem. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6535.png", "ScreenshotCaption": "C6 - Local environment discovery via Win32_OperatingSystem discovery\n"}]}, {"DetectionNote": "A MSSP detection for \"use of Gwmi\" occurred containing evidence of WMI query containing Win32_OperatingSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12816.png", "ScreenshotCaption": "MSSP - C6 - Gwmi Win32_OperatingSystem\u200b"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing\u200b Gwmi Win32_OperatingSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Detections": [{"DetectionNote": "A Tactic alert detection for \"Discovery\" was generated on a suspicious WMI query targeting Win32_BIOS and Win32_ComputerSystem.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6791.png", "ScreenshotCaption": "A3/4 - WMI win32_bios "}, {"ScreenshotName": "SentinelOne-APT29-6793.png", "ScreenshotCaption": "A4/6/7 - WMI win32_computer system"}]}, {"DetectionNote": "An MSSP detection for \"T1082\" occurred containing evidence of WMI query targeting Win32_BIOS and Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12844.png", "ScreenshotCaption": "MSSP - bios and computer system"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Detections": [{"DetectionNote": "An MSSP detection for \"T1082\" occurred containing evidence of PowerShell calling the GetComputerNameEx API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12857.png", "ScreenshotCaption": "MSSP - A1 - SBL"}]}, {"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7248.png", "ScreenshotCaption": "CC - A1 - GetComputerNameEx in powershell alert"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Detections": [{"DetectionNote": "An MSSP detection for \"Exfiltrate\" occurred containing evidence of Compress-7zip compressing and encrypting the download directory with 7z using the password \u201clolol.\"", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12828.png", "ScreenshotCaption": "MSSP - B2/3/4 - Invoke-Exfil SBL and OfficeSupplies.zip creation"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7224.png", "ScreenshotCaption": "CC - B3 - Alert for powershell execution showing Compress-Zip with password"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}, {"SubStep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Detections": [{"DetectionNote": "An MSSP detection for \"T1022\" occurred containing evidence of rar.exe being executed with an encryption password parameter passed.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12839.png", "ScreenshotCaption": "MSSP - B5/6 - file creation event"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6744.png", "ScreenshotCaption": "B6/7 - powershell executing rar.exe"}]}]}]}, {"TechniqueId": "T1086", "TechniqueName": "PowerShell", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u00a0spawning from cmd.exe", "Detections": [{"DetectionNote": "A Tactic alert detection called \"ProcessCreationExtra\" was generated for powershell.exe spawning from cmd.exe.", "DetectionType": "Tactic", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14541.png", "ScreenshotCaption": "1.B.2 - Execution for powershell.exe spawning from cmd.exe."}]}, {"DetectionNote": "An MSSP detection for \u201cT1086\u201d contained evidence of powershell.exe spawning from cmd.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12795.png", "ScreenshotCaption": "B2 - MSSP - powershell"}, {"ScreenshotName": "SentinelOne-APT29-12794.png", "ScreenshotCaption": "B1/2 - MSSP - Command-line interface/powershell"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6477.png", "ScreenshotCaption": "B.2 - Shows all process spawning with additional information about the execution - shows powershell"}]}]}, {"SubStep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Detections": [{"DetectionNote": "A Tactic alert detection called \"ProcessCreationExtra\" was generated for powershell.exe executing powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Tactic", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14583.png", "ScreenshotCaption": "4.A.2 - Execution of powershell.exe by powershell.exe"}]}, {"DetectionNote": "An MSSP detection for \"T1086\" occurred containing evidence of a new interactive session of PowerShell being created.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-11807.png", "ScreenshotCaption": "MSSP - A2 - Process creation event"}]}, {"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6524.png", "ScreenshotCaption": "A2 - shows HI powershell spawning powershell"}]}]}, {"SubStep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u200b spawning from python.exe", "Detections": [{"DetectionNote": "An MSSP detection for \"T1086\" occurred containing evidence of python.exe executing powershell.exe\u200b.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12837.png", "ScreenshotCaption": "MSSP - B1 - process tree"}]}, {"DetectionNote": "Telemetry showed python.exe executing powershell.exe\u200b. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6753.png", "ScreenshotCaption": "B1 - Process tree of python executing powershell"}]}]}, {"SubStep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Detections": [{"DetectionNote": "An MSSP detection for \"T1086\" occurred containing evidence of PowerShell stager executing (IEX) from schemas via script block logs.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12848.png", "ScreenshotCaption": "MSSP - A10/11/12"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6785.png", "ScreenshotCaption": "A1/2 - Process tree showing explorer.exe executing  powershell calling Get-Content"}]}]}, {"SubStep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Detections": [{"DetectionNote": "An MSSP detection for \"PowerShell\" occurred containing evidence of WMI Provider Host spawning PowerShell.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12892.png", "ScreenshotCaption": "MSSP - WMI -> powershell"}]}, {"DetectionNote": "Telemetry showed a SYSTEM-level powershell.exe spawning from wmiprvse.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6991.png", "ScreenshotCaption": "A3 - wmiprvse.exe Process tree overview of spawning processes"}, {"ScreenshotName": "SentinelOne-APT29-6992.png", "ScreenshotCaption": "A2/3 - Detailed wmiprvse.exe executing powershell stager"}]}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesscheck.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Detections": [{"DetectionNote": "A Technique alert detection for \"BrowserInfoStealing\" under \"Collection {T1213}\" was generated when accesschk.exe read the Chrome database file for credentials. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6564.png", "ScreenshotCaption": "A1 - Browser info stealing via accesschk.exe "}]}, {"DetectionNote": "An MSSP detection for \"T1081\" occurred containing evidence of accesschk.exe reading the Chrome database file for credentials.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12822.png", "ScreenshotCaption": "MSSP - A1/3 - asscesschk.exe usage and alerts"}]}]}]}, {"TechniqueId": "T1145", "TechniqueName": "Private Keys", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Detections": [{"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6570.png", "ScreenshotCaption": "B1 - File creation of $RandomFileName.pfx with full path"}]}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Detections": [{"DetectionNote": "A Tactic alert detection called \"ProcessCreationExtra\" was generated due to PSEXESVC.exe executing python.exe.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14734.png", "ScreenshotCaption": "8.C.3 - Execution of python.exe from PSEXESVC.exe"}]}, {"DetectionNote": "An MSSP detection for \"T1035\" occurred containing evidence of PsExec executing python.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12835.png", "ScreenshotCaption": "MSSP - C2/3 -network info + psexec + admin share access"}]}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6727.png", "ScreenshotCaption": "C3 - PSEXECSVC being spawned from python.exe"}]}]}, {"SubStep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Detections": [{"DetectionNote": "A Tactic alert detection called \"ProcessCreationExtra\" was generated when services.exe executed javamtsup.exe.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14736.png", "ScreenshotCaption": "10.A.1 - Execution of javamtsup.exe by services.exe"}]}, {"DetectionNote": "An MSSP detection for \"T1035\" occurred containing evidence of javamtsup.exe with parent process services.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12841.png", "ScreenshotCaption": "MSSP - A1 - process tree"}]}, {"DetectionNote": "Telemetry showed javamtsup.exe with parent process services.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6770.png", "ScreenshotCaption": "A1 - javamtsup.exe with parent process services.exe via process tree flow"}]}]}]}, {"TechniqueId": "T1027", "TechniqueName": "Obfuscated Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within\u00a0monkey.png", "Detections": [{"DetectionNote": "A Technique alert detection for \"Steganography\" was generated when identifying the PowerShell script contained within monkey.png.  The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7279.png", "ScreenshotCaption": "CC - A2 - Steganography Alert Generated"}], "Footnotes": ["A Detection Configuration Change was made to detect common extensions without the appropriate file type content in the file."]}, {"DetectionNote": "An MSSP detection for \"T1027\" occurred containing evidence of the PowerShell script contained within monkey.png.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12802.png", "ScreenshotCaption": "MSSP - A2 - Powershell decoding stego"}]}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7278.png", "ScreenshotCaption": "A1 - Cleaner view of powershell script generating monkey.png"}]}]}, {"SubStep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Detections": [{"DetectionNote": "An MSSP detection for \"T1027\" occurred containing evidence of \"wmidump\" function definition and WMI indicators writing to Win32_AuditCode.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12871.png", "ScreenshotCaption": "MSSP - WMI write audit of code"}, {"ScreenshotName": "SentinelOne-APT29-12872.png", "ScreenshotCaption": "MSSP - WMIDUMP SBL"}]}, {"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7260.png", "ScreenshotCaption": "CC - B5 - Powershell alert of Set-WmiInstance"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}, {"SubStep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Detections": [{"DetectionNote": "A Technique alert detection called \"HeaderExtensionMismatch\" was generated due to file header not matching file extension. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7274.png", "ScreenshotCaption": "CC - C2 - HeaderExtensionMismatch alert generated"}], "Footnotes": ["A Detection Configuration Change was made to identify \"HeaderExtensionMismatch\", generated on file header not matching file extension."]}, {"DetectionNote": "An MSSP detection occurred containing evidence that additional bytes were used to disguise a zip as a GIF image format.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12885.png", "ScreenshotCaption": "MSSP - alert, SBL"}]}, {"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-15040.png", "ScreenshotCaption": "17.C.2 - zip function definition script block"}, {"ScreenshotName": "SentinelOne-APT29-15041.png", "ScreenshotCaption": "17.C.2 - zip function being called"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"TechniqueId": "T1084", "TechniqueName": "Windows Management Instrumentation Event Subscription", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Detections": [{"DetectionNote": "A Technique alert detection for \"WMI\" under \"Persistence {T1084}\" was generated when a WMI binding was created under root/subscription. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6895.png", "ScreenshotCaption": "A2 - WMI Persistence Alert of root/subscription"}]}, {"DetectionNote": "A General detection for a suspicious \"WMIOperation\" showed WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "General", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6896.png", "ScreenshotCaption": "A2 - Specific WindowsParentalControlMigration in root/subscription"}]}, {"DetectionNote": "An MSSP detection for \"T1084\" occurred containing evidence of WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12875.png", "ScreenshotCaption": "MSSP - A2 - WMI info pt2"}, {"ScreenshotName": "SentinelOne-APT29-12874.png", "ScreenshotCaption": "MSSP - A2 - WMI info"}, {"ScreenshotName": "SentinelOne-APT29-12876.png", "ScreenshotCaption": "MSSP - A1/2 - SBL"}]}]}, {"SubStep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of wmiprvse.exe executing the PowerShell stager.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-17876.png", "ScreenshotCaption": "20.A.2 - MSSP"}]}, {"DetectionNote": "Telemetry showed the WMI Provider Host executing the PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6992.png", "ScreenshotCaption": "A2/3 - Detailed wmiprvse.exe executing powershell stager"}]}]}]}, {"TechniqueId": "T1096", "TechniqueName": "NTFS File Attributes", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Detections": [{"DetectionNote": "An MSSP detection for \"T1096\" occurred containing evidence of powershell.exe executing schemas ADS via Get-Content and IEX.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12843.png", "ScreenshotCaption": "MSSP - A1/2 - powershell and SBL"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6785.png", "ScreenshotCaption": "A1/2 - Process tree showing explorer.exe executing  powershell calling Get-Content"}]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.4", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Detections": [{"DetectionNote": "An MSSP detection for \"T1071\" occurred containing evidence of PowerShell process exchanging data with 192.168.0.5 over HTTPS.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12807.png", "ScreenshotCaption": "MSSP - B3/4/5 - port information"}]}, {"DetectionNote": "Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6515.png", "ScreenshotCaption": "B3/4/5 - Network connection, powershell exchanging data with host over https"}]}]}, {"SubStep": "11.A.14", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Detections": [{"DetectionNote": "An MSSP detection for \"T1071\" occurred containing evidence of PowerShell making network connection to C2 (192.168.0.4) over port 443 via HTTPS.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12849.png", "ScreenshotCaption": "MSSP - A13/14/15 - network information"}]}, {"DetectionNote": "Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6810.png", "ScreenshotCaption": "A13/14/15 - Connection information including, IP, port, protocol, and encryption dectection"}]}]}]}, {"TechniqueId": "T1497", "TechniqueName": "Virtualization/Sandbox Evasion", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Detections": [{"DetectionNote": "A Tactic alert detection for \"Discovery\" under \"SuspiciousWMIQuery\" was generated on a suspicious WMI query targeting Win32_BIOS.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6791.png", "ScreenshotCaption": "A3/4 - WMI win32_bios "}]}, {"DetectionNote": "An MSSP detection for \"T1497\" occurred containing evidence of WMI query targeting Win32_BIOS.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12844.png", "ScreenshotCaption": "MSSP - bios and computer system"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing\u00a0Compress-Archive", "Detections": [{"DetectionNote": "A Technique alert detection for \"Data Compressed. MITRE Exfiltration {T1002}\" was generated on powershell.exe compressing via Compress-Archive. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6486.png", "ScreenshotCaption": "A.4 - Shows that data compression has occurred"}]}, {"DetectionNote": "An MSSP detection occurred for powershell.exe compressing via Compress-Archive.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14545.png", "ScreenshotCaption": "MSSP - 2.A.4"}, {"ScreenshotName": "SentinelOne-APT29-14544.png", "ScreenshotCaption": "MSSP - 2.A.4"}, {"ScreenshotName": "SentinelOne-APT29-14546.png", "ScreenshotCaption": "MSSP - 2.A.4"}]}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14542.png", "ScreenshotCaption": "2.A.4 - Script block"}, {"ScreenshotName": "SentinelOne-APT29-14543.png", "ScreenshotCaption": "2.A.4 - Script block expanded"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}, {"SubStep": "7.B.2", "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Detections": [{"DetectionNote": "An MSSP detection for \"exfiltrate\" occurred containing evidence of OfficeSupplies.7z being created.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12828.png", "ScreenshotCaption": "MSSP - B2/3/4 - Invoke-Exfil SBL and OfficeSupplies.zip creation"}]}, {"DetectionNote": "Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6670.png", "ScreenshotCaption": "B2 - Powershell file creation of OfficeSupplies.7z"}]}]}, {"SubStep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Detections": [{"DetectionNote": "A Technique alert detection called \"Compression\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14735.png", "ScreenshotCaption": "9.B.7 - Data Compressed into Desktop\\working.zip"}]}, {"DetectionNote": "An MSSP detection for \"T1002\" occurred containing evidence of powershell.exe executing rar.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12839.png", "ScreenshotCaption": "MSSP - B5/6 - file creation event"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6744.png", "ScreenshotCaption": "B6/7 - powershell executing rar.exe"}]}]}, {"SubStep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Detections": [{"DetectionNote": "A Technique alert detection for \"Data Compressed\" was generated due to an entropy calculation of WindowsParentalControlMigration.tmp. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6950.png", "ScreenshotCaption": "C1 - Alert showing file is compressed"}]}, {"DetectionNote": "An MSSP detection for \"T1002\" occurred containing evidence of \"zip\" function compressing collection via ZipFile.CreateFromDirectory .NET method.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12885.png", "ScreenshotCaption": "MSSP - alert, SBL"}]}, {"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7273.png", "ScreenshotCaption": "CC - C2 - powershell alert showing zip function definition "}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesscheck.exe executing the CryptUnprotectedData API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe\u00a0reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Detections": [{"DetectionNote": "A Technique alert detection for \"SensitiveMemoryAccess\" under \"Credential Access {T1003}\" was generated when PowerShell read sensitive information from LSASS. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6573.png", "ScreenshotCaption": "C1 - Shows powershell doing sensitive memory access "}], "Footnotes": ["This activity would have been blocked."]}, {"DetectionNote": "An MSSP detection for \"T1003\" occurred containing evidence of credential dumping as indicated by \u201cInfostealer.\u201d", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12823.png", "ScreenshotCaption": "MSSP - C1 - lsass access info"}]}, {"DetectionNote": "Telemetry shows a remote process injection into lsass.exe by powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-17881.png", "ScreenshotCaption": "6.C.1 - RemoteInjection into LSASS"}]}]}, {"SubStep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection for \"SensitiveMemoryAccess\" under \"Credential Access {T1003}\" was generated when m.exe read sensitive memory from lsass.exe. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6870.png", "ScreenshotCaption": "B4 - Sensitive memory Access alert for m.exe"}]}, {"DetectionNote": "An MSSP detection for \"T1003\" occurred containing evidence of Mimikatz sekurlsa::logonpasswords usage via m.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12870.png", "ScreenshotCaption": "MSSP - m.exe CLI args, wmidump call/definition"}]}, {"DetectionNote": "Telemetry shows a remote process injection into lsass.exe by Mimikatz. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection for \"SensitiveMemoryAccess\" under \"Credential Access {T1003}\" was generated when m.exe read sensitive memory from lsass.exe. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6922.png", "ScreenshotCaption": "D2 - Sensitive memory access alert or LSASS"}]}, {"DetectionNote": "An MSSP detection for \"SensitiveMemoryAccess\" occurred containing evidence of mimikatz lsadump::lsa /inject /name:krbtgt via m.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12882.png", "ScreenshotCaption": "MSSP - SensitiveMemoryAccess"}, {"ScreenshotName": "SentinelOne-APT29-12881.png", "ScreenshotCaption": "MSSP - file creation, cli args, "}]}, {"DetectionNote": "Telemetry shows a remote process injection into lsass.exe by Mimikatz. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-17880.png", "ScreenshotCaption": "16.D.2 - RemoteInjection into LSASS"}]}]}]}, {"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Detections": [{"DetectionNote": "An MSSP detection for \"T1085\" occurred containing evidence of rundll32.exe executing kxwn.lock.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12891.png", "ScreenshotCaption": "MSSP - rundll32.exe executing kxwn.lock"}]}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6980.png", "ScreenshotCaption": "A1 - rundll32.exe process spawning and executing kxwn.lock"}]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe\u00a0spawning from the rcs.3aka3.doc\u200b process", "Detections": [{"DetectionNote": "A Tactic alert detection called \"ProcessCreationExtra\" was generated for rcs.3aka3.doc\u200b spawning cmd.exe.", "DetectionType": "Tactic", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-17871.png", "ScreenshotCaption": "1.B.1 - rcs.3aka3.doc executing cmd.exe"}]}, {"DetectionNote": "An MSSP detection for \u201cT1059\u201d contained evidence of cmd.exe spawning from rcs.3aka3.doc\u200b.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12794.png", "ScreenshotCaption": "B1/2 - MSSP - Command-line interface/powershell"}]}, {"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b.The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-16471.png", "ScreenshotCaption": "Detailed view of B1/2"}]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A Technique alert detection for \"TokenManipulation\" was generated when user Pam targeted user \"NT AUTHORITY\\SYSTEM\" in conjunction with \"setcbprivilege\" usage. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6512.png", "ScreenshotCaption": "B2 - shows process integrity level"}, {"ScreenshotName": "SentinelOne-APT29-6513.png", "ScreenshotCaption": "B2 - shows integrity level of \"3\" "}, {"ScreenshotName": "SentinelOne-APT29-6516.png", "ScreenshotCaption": "B2 - Was able to capture that token manipulation was used to escalate privs"}]}, {"DetectionNote": "An MSSP detection for \"T1088\" occurred containing evidence of new high integrity PowerShell callback spawning from control.exe\u200b\u200b (spawned from sdclt.exe).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12806.png", "ScreenshotCaption": "MSSP - B2 - UAC Bypass info"}, {"ScreenshotName": "SentinelOne-APT29-12805.png", "ScreenshotCaption": "MSSP - B2 - UAC Bypass info"}]}, {"DetectionNote": "Telemetry showed a new high integrity PowerShell callback spawning from control.exe\u200b\u200b (spawned from sdclt.exe). The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6514.png", "ScreenshotCaption": "B2 - Shows tree view of processes and their integrity level. "}]}]}, {"SubStep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "An MSSP detection for \"T1088\" occurred containing evidence of a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe) with TokenMismatch indicator.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12860.png", "ScreenshotCaption": "MSSP - TokenMissmatch, new ps session, sdlc.exe usage (medium integrity)"}, {"ScreenshotName": "SentinelOne-APT29-12863.png", "ScreenshotCaption": "MSSP - HI PowerShell, SBL"}, {"ScreenshotName": "SentinelOne-APT29-12861.png", "ScreenshotCaption": "MSSP - sdclt -> control.exe, sdclt (high integ)"}]}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6851.png", "ScreenshotCaption": "A2 - Process tree of HI powershell spawned from control.exe spawned from sdclt.exe"}, {"ScreenshotName": "SentinelOne-APT29-6850.png", "ScreenshotCaption": "A2 - Detailed process creation of control.exe at HI as well as encoded powershell command being executed"}]}]}]}, {"TechniqueId": "T1047", "TechniqueName": "Windows Management Instrumentation", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection for \"WMI Operation\" under \"Execution {T1047}\" was generated on Win32_AuditCode usage. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6874.png", "ScreenshotCaption": "B1/5/6 - WMI operation has occured"}]}, {"DetectionNote": "An MSSP detection for \"WMI Operation\" occurred containing evidence of Win32_AuditCode usage. WmiPrvSE.exe executed powershell.exe with decoded payload.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12864.png", "ScreenshotCaption": "MSSP - B1 - WMI usage"}, {"ScreenshotName": "SentinelOne-APT29-12866.png", "ScreenshotCaption": "MSSP - powershell parent process"}, {"ScreenshotName": "SentinelOne-APT29-12865.png", "ScreenshotCaption": "MSSP - SBL and process creation"}]}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6880.png", "ScreenshotCaption": "B1- wmiPrvSe.exe executing powershell"}]}]}]}, {"TechniqueId": "T1114", "TechniqueName": "Email Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Detections": [{"DetectionNote": "An MSSP detection for \"T1114\" occurred containing evidence of Outlook process being started from the parent process \u201csvchost.exe\u201d along with the function definition for \"psemail\".", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12883.png", "ScreenshotCaption": "MSSP - outlook access and SBL"}]}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6925.png", "ScreenshotCaption": "A1 - outlook.exe spawning from svchost.exe(OSParent name)/powershell(Parent name)"}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6469.png", "ScreenshotCaption": "A.4 - Shows that a cryptographic protocol was used"}, {"ScreenshotName": "SentinelOne-APT29-6470.png", "ScreenshotCaption": "A.4 - Specifically shows the library that was alerted on"}]}]}, {"SubStep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "An MSSP detection for \"T1032\" occurred containing evidence of the PowerShell process exchanging data with 192.168.0.5 over HTTPS.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12807.png", "ScreenshotCaption": "MSSP - B3/4/5 - port information"}]}, {"DetectionNote": "Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6515.png", "ScreenshotCaption": "B3/4/5 - Network connection, powershell exchanging data with host over https"}]}]}, {"SubStep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "An MSSP detection for \"T1032\" occurred containing evidence of PowerShell making network connection to C2 (192.168.0.4) over port 443 via HTTPS.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12849.png", "ScreenshotCaption": "MSSP - A13/14/15 - network information"}]}, {"DetectionNote": "Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6810.png", "ScreenshotCaption": "A13/14/15 - Connection information including, IP, port, protocol, and encryption dectection"}]}]}]}, {"TechniqueId": "T1106", "TechniqueName": "Execution through API", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Detections": [{"DetectionNote": "An MSSP detection for \"T1106\" occurred containing evidence of ConvertSidToStringSid API with Advapi32.dll.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12877.png", "ScreenshotCaption": "MSSP - ConvertSidToStringSid, Advapi32.dll"}]}, {"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7265.png", "ScreenshotCaption": "CC - B1/2 - powershell alert of siduser function definition "}, {"ScreenshotName": "SentinelOne-APT29-7264.png", "ScreenshotCaption": "CC - B1/2 - Powershell alert of ConvertSidToStringSid being used in script"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Detections": [{"DetectionNote": "An MSSP detection for the file creation of Draft.zip was received. The alert stated that \"C:\\Users\\pam\\AppData\\Roaming\\Draft.zip\" file was created.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-10769.png", "ScreenshotCaption": "A5 - MSSP - Creation of Draft.zip"}]}, {"DetectionNote": "Telemetry showed the creation of Draft.Zip. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-17890.png", "ScreenshotCaption": "2.A.5 - File Creation for Draft.zip"}]}]}, {"SubStep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Detections": [{"DetectionNote": "An MSSP detection for \"T1074\" occurred containing evidence of working.zip creation from file creation events.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12839.png", "ScreenshotCaption": "MSSP - B5/6 - file creation event"}]}, {"DetectionNote": "Telemetry showed a File Creation event for powershell.exe creating working.zip.The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6743.png", "ScreenshotCaption": "B5 - File creation of working.zip"}]}]}, {"SubStep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "An MSSP detection for \"T1074\" occurred containing evidence of Copy-Item with ..\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML being the destination file. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12884.png", "ScreenshotCaption": "MSSP - Copy-Item"}]}, {"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.  The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6938.png", "ScreenshotCaption": "B2 - File Write to C:\\Windows\\Temp\\WindowsParentalControlMigration\\ MITRE-ATTACK-EVALS.HTML"}]}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "A Technique alert detection for \"File Enumeration\" under \"Discovery {T1083}\" was generated when powershell.exe executed Get-ChildItem. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6487.png", "ScreenshotCaption": "A.3 - Shows that file enumeration took place"}]}, {"DetectionNote": "An MSSP detection for \"File Enumeration\" occurred containing evidence of PowerShell searching the filesystem. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12796.png", "ScreenshotCaption": "A1 - MSSP - File Enumeration alert"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6485.png", "ScreenshotCaption": "A.1/2 Shows -childitem call"}]}]}, {"SubStep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing\u00a0$env:TEMP", "Detections": [{"DetectionNote": "An MSSP detection occurred for \"basic discovery\" containing evidence of $env:TEMP usage.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12815.png", "ScreenshotCaption": "MSSP - C1-5 - readme.ps1"}]}]}, {"SubStep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "A Technique alert detection for \"File Enumeration\" under \"Discovery {T1083}\" was generated when powershell.exe executed Get-ChildItem. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6751.png", "ScreenshotCaption": "B2/3/4 - File Enumeration Alert"}]}, {"DetectionNote": "An MSSP detection for \"T1083\" occurred containing evidence of enumerating directories in search for specific files. The function \u201cChildItem\u201d is observed.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12838.png", "ScreenshotCaption": "MSSP - B2/3 -  child-item"}]}, {"DetectionNote": "Telemetry showed PowerShell executing ChildItem\u200b. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7235.png", "ScreenshotCaption": "CC - B2/3 - Powershell Calling child-item - Generic powershell alert"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}, {"SubStep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Detections": [{"DetectionNote": "An MSSP detection for \"information discovery\" occurred containing evidence of File Enumeration relating to Get-Item function.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12846.png", "ScreenshotCaption": "MSSP - SBL of all the above"}]}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7244.png", "ScreenshotCaption": "CC - A9 - Get-Item-Path on generic powershell alert"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}, {"SubStep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Detections": [{"DetectionNote": "An MSSP detection for \"T1083\" occurred containing evidence of PowerShell enumeration of System32.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12852.png", "ScreenshotCaption": "MSSP - A1 - FileEnum + gci SBL"}]}, {"DetectionNote": "Telemetry showed PowerShell enumeration of System32.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7245.png", "ScreenshotCaption": "CC - A1 - Powershell timestop function via generic powershell alert"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"TechniqueId": "T1119", "TechniqueName": "Automated Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "A Technique alert detection for \"Automated Collection\" was generated on powershell.exe executing Get-ChildItem after a short delay. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Delayed (Processing)", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6498.png", "ScreenshotCaption": "A.1/2/3 - Shows high level representation of Automated Collection - May take a few minutes to populate"}]}, {"DetectionNote": "An MSSP detection for \"InteractivePSCommand\" contained evidence of powershell.exe executing ChildItem. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12797.png", "ScreenshotCaption": "A2/3 - MSSP - ChildItem call"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6485.png", "ScreenshotCaption": "A.1/2 Shows -childitem call"}]}]}, {"SubStep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "A Technique alert detection called \"Automated Collection\" was generated when powershell.exe accessed multiple files when using ChildItem. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-17873.png", "ScreenshotCaption": "9.B.3 - Automated Collection for gathering files in Pam"}], "Footnotes": ["A UX Configuration Change was made to bring host file reads into the UI."]}, {"DetectionNote": "An MSSP detection for \"T1119\" occurred containing evidence of enumerating directories in search for specific files. The function \u201cChildItem\u201d is observed.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12838.png", "ScreenshotCaption": "MSSP - B2/3 -  child-item"}]}, {"DetectionNote": "Telemetry showed PowerShell executing ChildItem\u200b. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7235.png", "ScreenshotCaption": "CC - B2/3 - Powershell Calling child-item - Generic powershell alert"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Detections": [{"DetectionNote": "A Technique alert detection for \"Screenshot\" generated due to CopyFromScreen API execution. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7239.png", "ScreenshotCaption": "CC - A1 - Screencapture alert generated"}, {"ScreenshotName": "SentinelOne-APT29-7238.png", "ScreenshotCaption": "CC - A1 - Invoke-Screencapture powershell function call"}], "Footnotes": ["A Detection Configuration Change was made to align CopyFromScreen usage with \"Screenshot\"."]}, {"DetectionNote": "An MSSP detection for \"T1113\" occurred containing evidence of System.Drawing.dll being loaded and Invoke-ScreenCapture called.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12825.png", "ScreenshotCaption": "MSSP - A1 - SBL of invoke-screencapture"}, {"ScreenshotName": "SentinelOne-APT29-12824.png", "ScreenshotCaption": "MSSP - A1 - system.drawing.dll loading"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7219.png", "ScreenshotCaption": "CC - A1 - CopyFromScreen in script block"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.A.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Detections": [{"DetectionNote": "An MSSP detection for \"T1105\" occurred containing evidence of rcs.3aka3.doc creating monkey.png.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12801.png", "ScreenshotCaption": "MSSP - A1/2 - File creation and stego"}]}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc creating new file monkey.png. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6500.png", "ScreenshotCaption": "A.1 -Process tree of money.png being created"}, {"ScreenshotName": "SentinelOne-APT29-6499.png", "ScreenshotCaption": "A.1 -  Detailed view of file being created"}, {"ScreenshotName": "SentinelOne-APT29-6501.png", "ScreenshotCaption": "A.1 - File creation of monkey.png"}]}]}, {"SubStep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "An MSSP detection for \"T1105\" occurred containing evidence of the file write of the ZIP by PowerShell. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12809.png", "ScreenshotCaption": "MSSP - A1 - powershell.exe creating SysinternalsSuite.zip "}]}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell.  The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6521.png", "ScreenshotCaption": "A1 - Shows file creation of SysInternalsSuite without .zip"}]}]}, {"SubStep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Detections": [{"DetectionNote": "A Tactic alert detection for \"AdminShareAccess\" was generated when python.exe was written from host Nashua (10.0.1.6) to the ADMIN$ share on host Scranton (10.0.1.4), indicating Lateral Movement.  The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Tactic", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6697.png", "ScreenshotCaption": "A1 extra info - Shows access to the share"}]}, {"DetectionNote": "An MSSP detection for \"T1105\" occurred containing evidence of python.exe file creation. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12832.png", "ScreenshotCaption": "MSSP - B1 - file write of python.exe"}]}, {"DetectionNote": "Telemetry showed the file create event of python.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6699.png", "ScreenshotCaption": "Unknown File creation (does show \"related to threat\" as false)"}]}]}, {"SubStep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file rar.exe", "Detections": [{"DetectionNote": "An MSSP detection for \"Python spawns PowerShell which then writes rar.exe and sdelete64.exe\" occurred containing evidence of file write events for rar.exe and sdelete64.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12836.png", "ScreenshotCaption": "MSSP - A1/2 - File writes"}]}, {"DetectionNote": "Telemetry showed a file creation event for python.exe creating rar.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6738.png", "ScreenshotCaption": "A1 - python processes creating rar.exe"}]}]}, {"SubStep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file sdelete64.exe", "Detections": [{"DetectionNote": "An MSSP detection for \"Python spawns PowerShell which then writes Rar.exe and sdelete64.exe\" occurred containing evidence of file write events for rar.exe and sdelete64.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12836.png", "ScreenshotCaption": "MSSP - A1/2 - File writes"}]}, {"DetectionNote": "Telemetry showed File Creation event for python.exe creating sdelete64.exe. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6739.png", "ScreenshotCaption": "A2 - python processes creating sdelete64.exe"}]}]}, {"SubStep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Detections": [{"DetectionNote": "An MSSP detection for \"FileModification\" occurred containing evidence of file write and analysis of m.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12867.png", "ScreenshotCaption": "MSSP - powershell, get-process, m.exe being dropped."}, {"ScreenshotName": "SentinelOne-APT29-12869.png", "ScreenshotCaption": "MSSP - M.exe analysis"}]}, {"DetectionNote": "Telemetry showed the file write event for m.exe into the System32 folder. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-17875.png", "ScreenshotCaption": "14.B.3 - File creation for m.exe"}]}]}, {"SubStep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Detections": [{"DetectionNote": "A General alert detection (medium severity) was generated identifying m.exe as a threat file.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6917.png", "ScreenshotCaption": "Summary view m.exe is actually mimikatz"}]}, {"DetectionNote": "An MSSP detection for \"File Creation\" occurred containing evidence of file write of m.exe to System32 directory by WinRM.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12881.png", "ScreenshotCaption": "MSSP - file creation, cli args, "}]}, {"DetectionNote": "Telemetry showed a file write event for m.exe in the System32 directory by \"Host process for WinRM plug-ins\". The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6918.png", "ScreenshotCaption": "D1 - m.exe being dropped to disk"}]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam", "Criteria": "Successful logon as user Pam on\u00a0Scranton (10.0.1.4) ", "Detections": [{"DetectionNote": "A Technique alert detection \"UserLogin\" under \"Valid Accounts {T1078}\" showed a valid logon on Scranton (10.0.1.4) as user Pam.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-17872.png", "ScreenshotCaption": "8.C.1 - Valid Accounts for pam login"}]}]}, {"SubStep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4) ", "Detections": [{"DetectionNote": "A Technique alert detection for \"UserLogin\" was generated when valid user MScott was used to log onto NewYork (10.0.0.4).", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6915.png", "ScreenshotCaption": "C2 - UserLogin Alert generated"}]}, {"DetectionNote": "An MSSP detection for \"T1078\" occurred containing evidence of process wsmprovhost.exe creation by mscott on remote host proving valid logon.\n", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12880.png", "ScreenshotCaption": "MSSP - login justification"}]}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe\u00a0executing\u200b Get-WmiObject ...\u200b -Class\u00a0AntiVirusProduct", "Detections": [{"DetectionNote": "A Technique alert detection for \"Security Software Discovery\" specific to WMI was generated when PowerShell executed the suspicious WMI query containing AntiVirusProduct.  The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6532.png", "ScreenshotCaption": "C7 - Security software using suspicious wmi query - Antivirus product"}]}, {"DetectionNote": "An MSSP detection for \"use of Gwmi\" occurred containing evidence of WMI query containing AntiVirusProduct.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12817.png", "ScreenshotCaption": "MSSP - C7/8 - Gwmi AntiVirus and Firewall queries."}]}, {"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct. ", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe\u00a0executing Get-WmiObject\u00a0...\u200b\u200b -Class\u00a0FireWallProduct", "Detections": [{"DetectionNote": "A Technique alert detection for \"Security Software Discovery\" specific to WMI was generated when PowerShell executed the suspicious WMI query containing FireWallProduct. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6533.png", "ScreenshotCaption": "C8 - using suspicious wmi query - Firewall product"}]}, {"DetectionNote": "An MSSP detection for \"use of Gwmi\" occurred containing evidence of WMI query containing FireWallProduct.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12817.png", "ScreenshotCaption": "MSSP - C7/8 - Gwmi AntiVirus and Firewall queries."}]}, {"DetectionNote": "Telemetry showed powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Detections": [{"DetectionNote": "A Technique alert detection for \"SuspiciousWMIQuery\" under \"Discovery {T1063}\" was generated when PowerShell gwmi queried for AntiVirusProduct. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6830.png", "ScreenshotCaption": "B1 - Suspicious WMI alert with query for AntiVirusProduct"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of gwmi query being used to enumerate AV software via \"detectav\" PowerShell function.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12854.png", "ScreenshotCaption": "MSSP - B1 - General WMI alert"}, {"ScreenshotName": "SentinelOne-APT29-12855.png", "ScreenshotCaption": "MSSP  - B1 - SBL"}]}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1112", "TechniqueName": "Modify Registry", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Detections": [{"DetectionNote": "An MSSP detection for \"T1112\" occurred containing evidence of command subkey being removed from the Registry.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12808.png", "ScreenshotCaption": "MSSP - C1 - removal of subkey"}]}, {"DetectionNote": "Telemetry showed the deletion of the command subkey. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6520.png", "ScreenshotCaption": "C1 - Shows powershell command used to remove the regkey via TrueContext or UID"}]}]}, {"SubStep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command\u00a0subkey", "Detections": [{"DetectionNote": "An MSSP detection for \"T1112\" occurred containing evidence of \"bypass\" function definition removing Registry subkey.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12863.png", "ScreenshotCaption": "MSSP - HI PowerShell, SBL"}]}, {"DetectionNote": "Telemetry showed powershell.exe deleting the command subkey. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-7254.png", "ScreenshotCaption": "CC - A1/3 - Powershell alert of bypass function containing add and delete"}], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"TechniqueId": "T1120", "TechniqueName": "Peripheral Device Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Detections": [{"DetectionNote": "A Technique alert detection for \"SuspiciousWMIQuery\" under \"{T1120}\" (Peripheral Device Discovery) was generated due to a suspicious WMI query for Win32_PnPEntity.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6792.png", "ScreenshotCaption": "A5 - WMI win32_pnpEntity"}]}, {"DetectionNote": "An MSSP detection for \"T1120\" occurred containing evidence of WMI query targeting Win32_PnPEntity.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12845.png", "ScreenshotCaption": "MSSP - pnp, process enumeration, win32_process, file enumeration"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1045", "TechniqueName": "Software Packing", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Detections": [{"DetectionNote": "A Technique alert detection for \"UPXProcess\" under \"Defense Evasion {T1045}\" was generated due to python.exe being packed with UPX.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6725.png", "ScreenshotCaption": "B2 - UPX Packing Alert"}]}, {"DetectionNote": "An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12833.png", "ScreenshotCaption": "MSSP - B2 - python.exe being packed"}]}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Detections": [{"DetectionNote": "A Technique alert detection for \"ServiceCreate\" under \"Persistence {T1084}\" was generated due to \"javamtsup\" being added to the \"...\\Services\" registry path. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6554.png", "ScreenshotCaption": "A1 - Detailed view of the new service creation, specifically shows persistence"}, {"ScreenshotName": "SentinelOne-APT29-6556.png", "ScreenshotCaption": "A1 - Reg keys being created"}, {"ScreenshotName": "SentinelOne-APT29-6555.png", "ScreenshotCaption": "A1 -  Reg keys being created"}]}, {"DetectionNote": "An MSSP detection occurred for PowerShell initiating a new persistence service \"javamtsup\". ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12819.png", "ScreenshotCaption": "MSSP - A1 - New-Service info pt2"}, {"ScreenshotName": "SentinelOne-APT29-12818.png", "ScreenshotCaption": "MSSP - A1 - New-Service info pt1"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scanton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Detections": [{"DetectionNote": "A Technique alert detection for \"AdminShareAccess\" was generated due to PSEXESVC.exe being copied to $ADMIN on Scranton (10.0.1.4). The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6721.png", "ScreenshotCaption": "Admin share access alert from psexec64"}]}, {"DetectionNote": "An MSSP detection for \"T1077\" occurred containing evidence of  PsExec64.exe establishing SMB session to Scranton's IPC$ share, and writes PSEXESVC.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12834.png", "ScreenshotCaption": "MSSP - C2 - network information"}, {"ScreenshotName": "SentinelOne-APT29-12835.png", "ScreenshotCaption": "MSSP - C2/3 -network info + psexec + admin share access"}]}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over port 135 identified as RPC.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14733.png", "ScreenshotCaption": "8.C.2 - rpc network connection correlated"}, {"ScreenshotName": "SentinelOne-APT29-6718.png", "ScreenshotCaption": "C2 - SMB session being established"}]}]}]}, {"TechniqueId": "T1065", "TechniqueName": "Uncommonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Detections": [{"DetectionNote": "A Technique alert detection for \"T1065 - Uncommonly Used Port\" was generated for rcs.3aka3.doc due to TCP port 1234 being used.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6462.png", "ScreenshotCaption": "Shows full story at a higher level in the UI"}]}, {"DetectionNote": "An MSSP detection was generated for rcs.3aka3.doc connecting to 192.168.0.5 on port 1234.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14534.png", "ScreenshotCaption": "MSSP - 1.A.3"}]}, {"DetectionNote": "Telemetry showed the rcs.3aka.doc connected to 192.168.0.5 on TCP port 1234.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6468.png", "ScreenshotCaption": "A.3 - Shows uncommon port"}]}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Detections": [{"DetectionNote": "An MSSP detection for \"T1107\" occurred containing evidence of Sdelete (Secure Deletion) being used to remove the original *.3aka3.* RAT, Draft.zip, and SysinternalSuite.zip).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12814.png", "ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt3"}, {"ScreenshotName": "SentinelOne-APT29-12813.png", "ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt2"}, {"ScreenshotName": "SentinelOne-APT29-12812.png", "ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt1"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.  The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6528.png", "ScreenshotCaption": "B2/3/4 - Deleting files (sdelete.exe writing over path names)"}, {"ScreenshotName": "SentinelOne-APT29-6527.png", "ScreenshotCaption": "B2/3/4 - powershell procesess executing sdelete64.exe deleting 3aka3, draft.zip, and SysinternalsSuite.zip"}]}]}, {"SubStep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Detections": [{"DetectionNote": "An MSSP detection for \"T1107\" occurred containing evidence of Sdelete (Secure Deletion) being used to remove the original *.3aka3.* RAT, Draft.zip, and SysinternalSuite.zip).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12812.png", "ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt1"}, {"ScreenshotName": "SentinelOne-APT29-12813.png", "ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt2"}, {"ScreenshotName": "SentinelOne-APT29-12814.png", "ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt3"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6527.png", "ScreenshotCaption": "B2/3/4 - powershell procesess executing sdelete64.exe deleting 3aka3, draft.zip, and SysinternalsSuite.zip"}, {"ScreenshotName": "SentinelOne-APT29-6528.png", "ScreenshotCaption": "B2/3/4 - Deleting files (sdelete.exe writing over path names)"}]}]}, {"SubStep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "An MSSP detection for \"T1107\" occurred containing evidence of Sdelete (Secure Deletion) being used to remove the original *.3aka3.* RAT, Draft.zip, and SysinternalSuite.zip).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12813.png", "ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt2"}, {"ScreenshotName": "SentinelOne-APT29-12812.png", "ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt1"}, {"ScreenshotName": "SentinelOne-APT29-12814.png", "ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt3"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6527.png", "ScreenshotCaption": "B2/3/4 - powershell procesess executing sdelete64.exe deleting 3aka3, draft.zip, and SysinternalsSuite.zip"}, {"ScreenshotName": "SentinelOne-APT29-6528.png", "ScreenshotCaption": "B2/3/4 - Deleting files (sdelete.exe writing over path names)"}]}]}, {"SubStep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Detections": [{"DetectionNote": "An MSSP detection for \"sdelete\" occurred containing evidence of sdelete being run to delete rar.exe, and working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12840.png", "ScreenshotCaption": "MSSP - C1 - sdelete"}]}, {"DetectionNote": "Telemetry showed a file deletion event for secure file delete deleting rar.exe. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6767.png", "ScreenshotCaption": "C1 - sdelete64 removing Temp/rar.exe"}]}]}, {"SubStep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Detections": [{"DetectionNote": "An MSSP detection for \"sdelete\" occurred containing evidence of sdelete being run to delete rar.exe, and working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12840.png", "ScreenshotCaption": "MSSP - C1 - sdelete"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to Desktop\\working.zip. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6765.png", "ScreenshotCaption": "C2 - sdelete64.exe removing of Desktop/working.zip "}]}]}, {"SubStep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Detections": [{"DetectionNote": "An MSSP detection for \"sdelete\" occurred containing evidence of sdelete being run to delete rar.exe, and working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12840.png", "ScreenshotCaption": "MSSP - C1 - sdelete"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6769.png", "ScreenshotCaption": "C3 - sdelete64.exe removing of appdata/working.zip "}]}]}, {"SubStep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Detections": [{"DetectionNote": "An MSSP detection for \"executing a deletion\" occurred containing evidence of cmd.exe being run to delete sdelete64.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12840.png", "ScreenshotCaption": "MSSP - C1 - sdelete"}]}, {"DetectionNote": "Telemetry showed a file deletion event on \"Windows Command Processor\" deleting sdelete64.exe. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6766.png", "ScreenshotCaption": "C4 - \"Windows Command Processor\" removing Temp/sdelete64.exe"}]}]}, {"SubStep": "19.A.1", "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\System32\\m.exe", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.1", "Procedure": "Deleted exfiltrated data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration.tmp", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.1", "Procedure": "Deleted staged data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Detections": [{"DetectionNote": "A Tactic alert detection called \"ProcessCreationExtra\" was generated for explorer.exe executing rcs.3aka3.doc.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14532.png", "ScreenshotCaption": "1.A.1 - Execution for explorer.exe starting rcs.3aka3.doc"}]}, {"DetectionNote": "An MSSP detection contained evidence of explorer.exe executing rcs.3aka3.doc.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12790.png", "ScreenshotCaption": "A1 - MSSP - explorer.exe executing rcs.3aka3.doc"}]}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6457.png", "ScreenshotCaption": "A.1 - Showing explorer execution by 3aka3"}]}]}, {"SubStep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Detections": [{"DetectionNote": "A Tactic alert detection called \"ProcessCreationExtra\" was generated when explorer.exe executed powershell.exe.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-14963.png", "ScreenshotCaption": "11.A.1 - Execution for explorer.exe spawning powershell.exe"}]}, {"DetectionNote": "A General alert detection was generated for a suspicious powershell.exe process spawning. ", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6787.png", "ScreenshotCaption": "A1 - True context start point"}]}, {"DetectionNote": "An MSSP detection for \"T1204\" occurred containing evidence of powershell.exe execution targeting .lnk payload.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-12843.png", "ScreenshotCaption": "MSSP - A1/2 - powershell and SBL"}]}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "SentinelOne-APT29-6783.png", "ScreenshotCaption": "A1 - Process tree showing explorer.exe executing  powershell calling Get-Content"}]}]}]}]}