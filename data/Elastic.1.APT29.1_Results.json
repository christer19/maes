{"PublicRelease": "\u00a92020 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-03607-4", "Techniques": [{"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "A Tactic alert detection (medium severity) called \"Detected Command and Control\" was generated due to PowerShell connecting to 192.168.0.5 on TCP 443. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Tactic", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-14508.png", "ScreenshotCaption": "3b3 - tactic - vendor new pic"}]}, {"DetectionNote": "A General alert detection (medium severity) was generated for the first network connection for a known process. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-14509.png", "ScreenshotCaption": "3b3 - general vendor new pic"}]}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP 443. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1209.png", "ScreenshotCaption": "command and control enrichment"}]}]}, {"SubStep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "A Tactic alert detection (medium detection) for \"Command and Control\" with the rule name \"PowerShell Network Activity\" was generated for powershell.exe opening a network connection.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1380.png", "ScreenshotCaption": "same alert at (30) but with full tele view"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1377.png", "ScreenshotCaption": "powershell network comms over 443 with enrichment of c2"}]}]}]}, {"TechniqueId": "T1140", "TechniqueName": "Deobfuscate/Decode Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Detections": [{"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive. The detection was correlated to a parent alert for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1215.png", "ScreenshotCaption": "expand archive script block event"}]}]}, {"SubStep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection (high severity) for \"ATT&CK T1140 Deobfuscate/Decode Files or Information\" was generated for certutil.exe encoding or decoding files.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1371.png", "ScreenshotCaption": "command line of known.lock"}, {"ScreenshotName": "Elastic-APT29-1372.png", "ScreenshotCaption": "certutil.exe enrihment for deobfuscae/decode files"}]}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1371.png", "ScreenshotCaption": "command line of known.lock"}, {"ScreenshotName": "Elastic-APT29-1370.png", "ScreenshotCaption": "decoding via certutil alert with file created of known.lock"}]}]}, {"SubStep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Detections": [{"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class.  The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1457.png", "ScreenshotCaption": "b6 get wmi object in cmdlet event"}]}]}]}, {"TechniqueId": "T1122", "TechniqueName": "Component Object Model Hijacking", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of\u00a0the DelegateExecute\u00a0\u200bsubkey in\u00a0\u200bHKCU\\Software\\Classes\\Folder\\shell\\open\\\u200b\u200bcommand\u200b\u200b", "Detections": [{"DetectionNote": "A Technique detection (red label) for \"Registry Preparation of UAC Bypass\" was generated due to the addition of the DelegateExecute Registry Value. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Technique", "Modifiers": ["Correlated", "Configuration Change (Detections)", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1710.png", "ScreenshotCaption": "cc loosening rule logic to get the bypass uac enrichment and new alert. "}]}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1204.png", "ScreenshotCaption": "showing the registry modified of the delegateexecute"}]}]}, {"SubStep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Detections": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1439.png", "ScreenshotCaption": "registry modify event"}]}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERDOMAIN. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1230.png", "ScreenshotCaption": "4c4-6 script block event (same as above)"}]}]}, {"SubStep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "A Tactic alert detection (medium severity) called \"Reconnaissance of Multiple WMI Classes\" was generated for powershell.exe enumerating WMI classes associated with System Information Discovery.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1364.png", "ScreenshotCaption": "alert for multiple wmi discovery techniques"}]}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1361.png", "ScreenshotCaption": "win32 computersystem wmi event"}]}]}, {"SubStep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1412.png", "ScreenshotCaption": "netwrksta powershell event"}]}]}]}, {"TechniqueId": "T1005", "TechniqueName": "Data from Local System", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "Telemetry showed file reads of C:\\Users\\Pam\\*. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1200.png", "ScreenshotCaption": "files found from the file read for 2.a.3 (users\\pam)"}]}]}, {"SubStep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "Telemetry showed file reads of C:\\Users\\Pam\\*. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1337.png", "ScreenshotCaption": "compress-archive powershell event -- 9b4"}]}]}, {"SubStep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure. ", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby ", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) called \"User Account Creation\" was generated for the addition of the new user Toby.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1625.png", "ScreenshotCaption": "user account creation alert with command line"}]}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1625.png", "ScreenshotCaption": "user account creation alert with command line"}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "Telemetry showed script block with registry query for installed software. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1398.png", "ScreenshotCaption": "microsoft reg key in powershell data"}]}]}, {"SubStep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "Telemetry showed script block with registry query for installed software. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1398.png", "ScreenshotCaption": "microsoft reg key in powershell data"}]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Detections": [{"DetectionNote": "A Technique alert detection for \"ATT&CK T1060 Registry Run Keys / Startup Folder\" was generated due to powershell.exe creating hostui.lnk. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1251.png", "ScreenshotCaption": "hostui enrichments (bottom) shows full startup path and startup folder enrichment"}]}, {"DetectionNote": "A General alert detection (medium severity) for \"Shortcut File Written by Suspicious Process\" was generated due to powershell.exe creating hostui.lnk. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1252.png", "ScreenshotCaption": "shortcut file written alert"}]}, {"DetectionNote": "Telemetry showed powershell.exe creating the hostui.lnk file in the Startup folder. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1251.png", "ScreenshotCaption": "hostui enrichments (bottom) shows full startup path and startup folder enrichment"}]}]}, {"SubStep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1343.png", "ScreenshotCaption": "hostui.bat "}]}]}, {"SubStep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Detections": [{"DetectionNote": "A Technique detection for \"ATT&CK T1060 Registry Run Keys / Startup Folder\" was generated for powershell.exe adding Run key persistence into the Registry", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1375.png", "ScreenshotCaption": "registry modify for kxwn.lock with enrichment"}]}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1375.png", "ScreenshotCaption": "registry modify for kxwn.lock with enrichment"}]}]}]}, {"TechniqueId": "T1097", "TechniqueName": "Pass the Ticket", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Detections": [{"DetectionNote": "A General alert detection (medium severity) for \"Credential Access via PowerShell Cmdlets\"  was generated for PowerShell executing Invoke-Mimikatz.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1623.png", "ScreenshotCaption": "same as above with powershell enrichments"}]}]}]}, {"TechniqueId": "T1099", "TechniqueName": "Timestomp", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection (low severity) for \"Timestomping\" was generated for the modification of the timestamp of kxwn.lock. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1387.png", "ScreenshotCaption": "better timestomp aler - expanded showing API event. "}]}, {"DetectionNote": "A Technique alert detection (medium severity) for \"ATT&CK T1099 Timestomp\" was generated for PowerShell calling the NtSetInformationFile API. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1387.png", "ScreenshotCaption": "better timestomp aler - expanded showing API event. "}]}, {"DetectionNote": "Telemetry showed the modification of the timestamp of kxwn.lock, as well as the contents of the timestomp function. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1391.png", "ScreenshotCaption": "timestomp function in powershell event"}, {"ScreenshotName": "Elastic-APT29-14989.png", "ScreenshotCaption": "12a2 - timestomp telemetry"}]}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1220.png", "ScreenshotCaption": "get process powershell cmdlet event"}]}]}, {"SubStep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $PID. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1230.png", "ScreenshotCaption": "4c4-6 script block event (same as above)"}]}]}, {"SubStep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "Telemetry showed wsmprovhost.exe executing Get-Process. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1291.png", "ScreenshotCaption": "Get-process"}]}]}, {"SubStep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Detections": [{"DetectionNote": "A Tactic alert detection (medium severity) called \"Reconnaissance of Multiple WMI Classes\" was generated for powershell.exe enumerating WMI classes associated with System Information Discovery.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1364.png", "ScreenshotCaption": "alert for multiple wmi discovery techniques"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1365.png", "ScreenshotCaption": "win32 process wmi event"}]}]}, {"SubStep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-14973.png", "ScreenshotCaption": "13d1 - better vendor pic"}]}]}, {"SubStep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Process Discovery via WMI\" was generated for PowerShell executing Get-Process. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-13697.png", "ScreenshotCaption": "process discovery via wmi alert"}]}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1449.png", "ScreenshotCaption": "get process from script block event"}]}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERNAME. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1229.png", "ScreenshotCaption": "4c1-3 script block"}]}]}, {"SubStep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "A Tactic alert detection (medium severity) called \"Reconnaissance of Multiple WMI Classes\" was generated for powershell.exe enumerating WMI classes associated with System Information Discovery.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1364.png", "ScreenshotCaption": "alert for multiple wmi discovery techniques"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1361.png", "ScreenshotCaption": "win32 computersystem wmi event"}]}]}, {"SubStep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing the GetUserNameEx API. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1418.png", "ScreenshotCaption": "script block of getusernameex"}]}]}, {"SubStep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Detections": [{"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1484.png", "ScreenshotCaption": "script block of username"}]}]}, {"SubStep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1506.png", "ScreenshotCaption": "convertsidtostringsid script block"}]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port TCP 1234).", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1697.png", "ScreenshotCaption": "cc ntcreatefile api call (new monitoring) showing the read of draft.zip"}, {"ScreenshotName": "Elastic-APT29-1177.png", "ScreenshotCaption": "double check to make sure i got network connection info. "}]}]}, {"SubStep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe\u00a0reading the file working.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "Telemetry showed file read event for working.zip and an existing C2 channel (192.168.0.4 over TCP port 8443).  This event was correlated to a General detection for the execution of a malicious file (python.exe).", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)", "Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-13617.png", "ScreenshotCaption": "port 8443 connection "}]}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Detections": [{"DetectionNote": "Telemetry showed hostui.exe manipulating powershell.exe token via CreateProcessWithTokenW and that the authentication ID was that of explorer.exe. This event was correlated to a General detection for the execution of a malicious file. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1345.png", "ScreenshotCaption": "hostui createprocesswithtokenW"}]}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetGroups\u00a0API", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing Invoke-NetUserGetGroups. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1231.png", "ScreenshotCaption": "4c7-8 script block (same as above, but scrolled down the invoke discovery a little)"}]}]}, {"SubStep": "4.C.11", "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetLocalGroups\u00a0API", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing Invoke-NetUserGetLocalGroups. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1231.png", "ScreenshotCaption": "4c7-8 script block (same as above, but scrolled down the invoke discovery a little)"}]}]}]}, {"TechniqueId": "T1028", "TechniqueName": "Windows Remote Management", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection (orange indicator; medium severity) for \"WMI Lateral Movement via PowerShell over WinRM\" was generated for the user Pam invoking a WMI PowerShell cmdlet. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1293.png", "ScreenshotCaption": "wmi invoked on another host alert"}]}, {"DetectionNote": "Telemetry showed network connection to remote host Scranton (10.0.1.4) over port TCP 5985. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1287.png", "ScreenshotCaption": "port 5985 to DC"}]}]}, {"SubStep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) for \"WMI Lateral Movement via PowerShell over WinRM\" was generated for WMI invoked on another host via a PowerShell WMI cmdlet. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1511.png", "ScreenshotCaption": "wmi lateral movement via powershell over winrm alert"}]}, {"DetectionNote": "A General alert detection (medium severity) for \"First Seen Process in an Environment\" was generated for the execution of the WinRM process (wsmprovhost.exe).", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1514.png", "ScreenshotCaption": "mscott on new york execution alert - first seen process in environment alert"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for a suspicious Windows script.\t\n", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1521.png", "ScreenshotCaption": "endgame client view  showing port 5985"}]}]}, {"SubStep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) for \"WMI Lateral Movement via PowerShell over WinRM\" was generated for PowerShell executing on a remote host over WinRM. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1624.png", "ScreenshotCaption": "wmi lateral movement via powershell over winrm, with connection over 5985"}]}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-15096.png", "ScreenshotCaption": "20b2 - telemetry "}]}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Detections": [{"DetectionNote": "A Technique alert detection for \"ATT&CK T1056 Input Capture\" (low severity) was generated for powershell.exe calling the NtUserGetAsyncKeyState API. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1271.png", "ScreenshotCaption": "alert for keyboard, encriched with input capture based on api event "}]}, {"DetectionNote": "Telemetry showed powershell.exe calling the NtUserGetAsyncKeyState. API. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1271.png", "ScreenshotCaption": "alert for keyboard, encriched with input capture based on api event "}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Detections": [{"DetectionNote": "A Technique alert detection (low severity) for \"ATT&CK T1115 Clipboard Data\" was generated for powershell.exe calling the NtUserGetClipboardData API. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1272.png", "ScreenshotCaption": "clipboard collection alert and enrichment based on api call"}]}, {"DetectionNote": "Telemetry showed powershell.exe calling the NtUserGetClipboardData API. The detection was correlated to a parent alert for malicious file execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1272.png", "ScreenshotCaption": "clipboard collection alert and enrichment based on api call"}]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389.  The detection was correlated to a parent alert for malicious file execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1286.png", "ScreenshotCaption": "port 389 - data transfer to DC ESTABLISHED CONNECTION \nshowed terminated because it had data transfer"}]}]}, {"SubStep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing the Get-NetDomainController cmdlet then subsequently making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1497.png", "ScreenshotCaption": "endgame client view showing the ldap queries (port 389)"}, {"ScreenshotName": "Elastic-APT29-1498.png", "ScreenshotCaption": "script block  for get-netdomaincontroller"}, {"ScreenshotName": "Elastic-APT29-1496.png", "ScreenshotCaption": "get forestdomain powershel cmdlet with the  discovery  tag for powershell  (tactic tags is changing  for powershell)"}]}]}]}, {"TechniqueId": "T1102", "TechniqueName": "Web Service", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Detections": [{"DetectionNote": "A General alert detection (medium severity) for \"Accessing Windows Network Shares\" was generated for net.exe with command-line arguments. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-14357.png", "ScreenshotCaption": "port 443 connetion from net"}]}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-14357.png", "ScreenshotCaption": "port 443 connetion from net"}, {"ScreenshotName": "Elastic-APT29-14378.png", "ScreenshotCaption": "scriptblock net use command"}]}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav\u00a0network share (192.168.0.4:80)", "Detections": [{"DetectionNote": "Telemetry showed PoweShell Copy-Item to a remote adversary WebDav network share (192.168.0.4). The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1282.png", "ScreenshotCaption": "copy item to webdav (4)"}]}]}, {"SubStep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1588.png", "ScreenshotCaption": "copy item script block"}]}]}]}, {"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process \u200bOR the original filename (cod.3aka.scr)", "Detections": [{"DetectionNote": "A Technique alert detection (low severity) for \"Process with Left-to-Right Encoding Character \" was generated for rcs.3aka3.doc execution.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-18054.png", "ScreenshotCaption": "cc flex demo new alert after firing - config change new rule logic"}]}, {"DetectionNote": "Telemetry showed the file type .doc was an executable, and that the filename included the unicode character for RTLO.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1173.png", "ScreenshotCaption": "(use this pic) Malicious file execution (revolver view) showing the file type as executable"}]}]}, {"SubStep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesscheck.exe is not the legitimate Sysinternals tool", "Detections": [{"DetectionNote": "A General alert detection (high severity; red indicator) for \"Malicious File\" was generated for accesschk.exe execution. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1255.png", "ScreenshotCaption": "same  accesschk alert, but showing the hash for masquerading"}]}, {"DetectionNote": "Telemetry showed accesschk.exe is not a signed Microsoft binary with hash values provided. This can be used to verify it is not the legitimate Sysinternals tool. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1255.png", "ScreenshotCaption": "same  accesschk alert, but showing the hash for masquerading"}]}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:COMPUTERNAME. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1229.png", "ScreenshotCaption": "4c1-3 script block"}]}]}, {"SubStep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing\u200b Gwmi Win32_OperatingSystem", "Detections": [{"DetectionNote": "A Technique detection called \"Reconnaissance of Multiple WMI Classes\" was generated due to multiple WMI classes being executed in quick succession. The event was correlated to a parent General detection for malicious file execution. The detection was a medium severity alert.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1237.png", "ScreenshotCaption": "detected discovery alert based on recon of multiple wmi classes. x number of classes called over a period of time. "}]}, {"DetectionNote": "Telemetry showed powershell.exe executing $Gwmi Win32_OperatingSystem. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1230.png", "ScreenshotCaption": "4c4-6 script block event (same as above)"}, {"ScreenshotName": "Elastic-APT29-1234.png", "ScreenshotCaption": "os wmi event"}]}]}, {"SubStep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Detections": [{"DetectionNote": "A Technique detection for \"ATT&CK T1082 System Info Discovery\" was generated for powershell.exe querying Win32_ComputerSystem and Win32_BIOS.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1362.png", "ScreenshotCaption": "win32 computersystem wmi event  (sys info enrichment)"}]}, {"DetectionNote": "A Tactic alert detection (medium severity) called \"Reconnaissance of Multiple WMI Classes\"  was generated for powershell.exe enumerating WMI classes associated with System Information Discovery.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1364.png", "ScreenshotCaption": "alert for multiple wmi discovery techniques"}, {"ScreenshotName": "Elastic-APT29-1364.png", "ScreenshotCaption": "alert for multiple wmi discovery techniques"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1358.png", "ScreenshotCaption": "bios wmi event"}, {"ScreenshotName": "Elastic-APT29-1361.png", "ScreenshotCaption": "win32 computersystem wmi event"}]}]}, {"SubStep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1404.png", "ScreenshotCaption": "powershell cmdlet of getcomputernameex"}]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Detections": [{"DetectionNote": "Telemetry showed Powershell.exe executing Compress-7Zip ... -password \"lolol\". The event was correlated to a parent General detection for malicious file execution.\t", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1281.png", "ScreenshotCaption": "powershel cmdlet with compress-7zip (7b3)"}]}]}, {"SubStep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Detections": [{"DetectionNote": "A Technique alert detection (yellow indicator; medium severity) for \"Encrypting Files with WinRar\" \"T1022 Data Encrypted\" was generated when rar.exe used \"-hp\" command-line arguments. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1334.png", "ScreenshotCaption": "encrypting alert detail with rar.rexe data encrypted process terminated"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1336.png", "ScreenshotCaption": "powershell encrypted arguments for zipping file "}]}]}]}, {"TechniqueId": "T1086", "TechniqueName": "PowerShell", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u00a0spawning from cmd.exe", "Detections": [{"DetectionNote": "A Technique detection called \"ATT&CK T1086 PowerShell\" was generated for the execution of PowerShell. The event was correlated to a parent alert for malicious file execution. ", "DetectionType": "Technique", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1190.png", "ScreenshotCaption": "powershell enrichment with selection in resolver view (purple dot) enriched from malicious file detection (correlated)"}]}, {"DetectionNote": "Telemetry showed cmd.exe executing powershell.exe. The telemetry was correlated to a parent alert for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1190.png", "ScreenshotCaption": "powershell enrichment with selection in resolver view (purple dot) enriched from malicious file detection (correlated)"}]}]}, {"SubStep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (high severity) for \"ATT&CK T1086 Powershell\" was generated when powershell.exe spawned. The detection was correlated to a parent alert for malicious file execution. ", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1214.png", "ScreenshotCaption": "powersehll technique mapping enrichment"}]}, {"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1214.png", "ScreenshotCaption": "powersehll technique mapping enrichment"}]}]}, {"SubStep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u200b spawning from python.exe", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) for \"T1086 PowerShell\" was generated due to powershell.exe executing. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1326.png", "ScreenshotCaption": "python executing powershell with att&ck enrichment (9b1)"}, {"ScreenshotName": "Elastic-APT29-1326.png", "ScreenshotCaption": "python executing powershell with att&ck enrichment (9b1)"}]}, {"DetectionNote": "Telemetery showed python.exe executing powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1326.png", "ScreenshotCaption": "python executing powershell with att&ck enrichment (9b1)"}]}]}, {"SubStep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) was generated for powershell.exe executed with unusual arguments.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-13683.png", "ScreenshotCaption": "second powershell alert - arguments, obfuscated, network activity"}]}, {"DetectionNote": "A Technique alert detection (medium severity) was generated for powershell.exe executing an obfuscated command.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1368.png", "ScreenshotCaption": "obfustacted cmdlet alert"}]}, {"DetectionNote": "A Technique detection  for \"ATT&CK T1086 PowerShell\" was generated for powershell.exe spawned from a PowerShell stager.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1373.png", "ScreenshotCaption": "for 12 the powershell staging"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1373.png", "ScreenshotCaption": "for 12 the powershell staging"}]}]}, {"SubStep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (orange, medium severity) for \"PowerShell with Unusual Arguments\" was generated for the execution of PowerShell.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-13691.png", "ScreenshotCaption": "powershell with unusual arguements alert"}]}, {"DetectionNote": "A Technique detection for \"ATT&CK T1085 PowerShell\" was generated due to the execution of PowerShell.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-13691.png", "ScreenshotCaption": "powershell with unusual arguements alert"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawned from WMI event subscription (wmiprvse.exe) as SYSTEM. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1618.png", "ScreenshotCaption": "wmi taggin of parent powershell"}]}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesscheck.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Detections": [{"DetectionNote": "A Technique detection for \"ATT&CK 1081 Credentials in Files\" was generated for accesschk.exe reading the Chrome database file for credentials . The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1720.png", "ScreenshotCaption": "cc - new api monitoring on ntcreate file credential in files tag. (blacklist update + enrichment rule)"}]}, {"DetectionNote": "Telemetry showed accesschk.exe reading the Chrome database file for credentials. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)", "Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-15105.png", "ScreenshotCaption": "6a1 - better pic - shows correlated"}]}]}]}, {"TechniqueId": "T1145", "TechniqueName": "Private Keys", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Detections": [{"DetectionNote": "A Technique alert detection for \"ATT&CK T1145 Private Keys\" was generated for powershell.exe creating the $RandomFileName.pfx file. The event was correlated to a parent General detection for malicious file execution.\t", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1258.png", "ScreenshotCaption": "pfx file creation with private keys enrichment "}]}, {"DetectionNote": "Telemetry showed powershell.exe creating the $RandomFileName.pfx file. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1260.png", "ScreenshotCaption": "whole message of script block for get privatekeys"}]}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Detections": [{"DetectionNote": "A Technique alert detection (high severity) for \"ATT&CK T1035 Service Execution\" for PsExec64.exe calling the CreateServiceW API. The detection was correlated to a parent alert for malicious file execution.\t", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1307.png", "ScreenshotCaption": "service executed tag for psexec64 - 8.c.3 technique alert"}]}, {"DetectionNote": "A Technique alert detection (low severity) for \"Service Creation/Modification\" was generated due to PsExec64.exe creating the psexesvc.exe service.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1308.png", "ScreenshotCaption": "service created/executed alert for psexec64  - 8.c.3 technique"}]}, {"DetectionNote": "Telemetry showed PSEXESVC.exe executing python.exe. The detection was correlated to a parent alert for the \"First Seen Process in an Environment\". ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1310.png", "ScreenshotCaption": "python executed better view - 8.c.3"}]}]}, {"SubStep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1027", "TechniqueName": "Obfuscated Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within\u00a0monkey.png", "Detections": [{"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-14010.png", "ScreenshotCaption": "powershell -- monkey.png"}]}]}, {"SubStep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Detections": [{"DetectionNote": "A Technique detection for \"ATT&CK T1027 Obfuscated Files or Information\" was generated for PowerShell executing Set-WmiInstance. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1811.png", "ScreenshotCaption": "cc - metadata upgrade - new wmi and obfuscated enrichment for put instance. "}]}, {"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1458.png", "ScreenshotCaption": "b5 script block for set wmiinstance"}]}]}, {"SubStep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Detections": [{"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-13979.png", "ScreenshotCaption": "17C2 - vendor pic - set-content"}]}]}]}, {"TechniqueId": "T1084", "TechniqueName": "Windows Management Instrumentation Event Subscription", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Windows Management Instrumentation Consumer Binding\" was generated due to the modification a WMI filter. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1494.png", "ScreenshotCaption": "wmi persistence via consumer binding  alert"}]}, {"DetectionNote": "A Technique detection for \"ATT&CK T1084 Windows Management Instrumentation Event Subscription\" was generated due to a PowerShell script containing WindowsParentalControlMigration. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Technique", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1481.png", "ScreenshotCaption": "powershell event enrichment tag for peristence - T1084 wmi event subscription "}]}, {"DetectionNote": "Telemetry showed a PowerShell script containing WindowsParentalControlMigration. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1484.png", "ScreenshotCaption": "script block of username"}]}]}, {"SubStep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Detections": [{"DetectionNote": "A Technique detection for \"ATT&CK T1047 Windows Management Instrumentation\" was generated for PowerShell being executed via WMI. ", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1618.png", "ScreenshotCaption": "wmi taggin of parent powershell"}]}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1617.png", "ScreenshotCaption": "showing lineage with process tree. "}]}]}]}, {"TechniqueId": "T1096", "TechniqueName": "NTFS File Attributes", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Detections": [{"DetectionNote": "A Technique alert detection (low severity) for \"Suspicious Read from Alternate Data Streams (ADS)\" was generated for powershell.exe accessing an NTFS ADS.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1381.png", "ScreenshotCaption": "suspicisos read from ADS alert with enrichment expanded. "}]}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1354.png", "ScreenshotCaption": "showing the get content commandline in powershell"}]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.4", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": [], "Footnotes": ["Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so a detection does not apply."]}]}, {"SubStep": "11.A.14", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1497", "TechniqueName": "Virtualization/Sandbox Evasion", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Detections": [{"DetectionNote": "A Tactic alert detection (medium severity) called \"Reconnaissance of Multiple WMI Classes\" was generated for powershell.exe enumerating WMI classes associated with System Information Discovery.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1364.png", "ScreenshotCaption": "alert for multiple wmi discovery techniques"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1358.png", "ScreenshotCaption": "bios wmi event"}]}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing\u00a0Compress-Archive", "Detections": [{"DetectionNote": "A Technique detection for \"Data Compressed\" was generated for powershell.exe compressing via Compress-Archive. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Technique", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1195.png", "ScreenshotCaption": "data compressed  enrichment, showing the childitem - since it stemed  off the malicious file execution and enrichments, correlated to that"}]}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1195.png", "ScreenshotCaption": "data compressed  enrichment, showing the childitem - since it stemed  off the malicious file execution and enrichments, correlated to that"}]}]}, {"SubStep": "7.B.2", "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Detections": [{"DetectionNote": "Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent alert for malicious file execution.\t", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1280.png", "ScreenshotCaption": "file create for officesupplies.7z"}]}]}, {"SubStep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) for \"T1002 Data Compressed\" was generated when rar.exe used \"-hp\" command-line arguments. This event was correlated to a General detection for the execution of a malicious file (python.exe).", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1335.png", "ScreenshotCaption": "another working.zip file file create with enrichments for data compressed, data encrypted"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. This event was correlated to a General detection for the execution of a malicious file (python.exe).", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1332.png", "ScreenshotCaption": "encrypted rar command line args tele"}]}]}, {"SubStep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Detections": [{"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1568.png", "ScreenshotCaption": "zipfilename powershell script block event"}]}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesscheck.exe executing the CryptUnprotectedData API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe\u00a0reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Detections": [{"DetectionNote": "A Technique alert detection (high severity) for \"Credential Dumping\" was generated for lsass.exe memory access. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1262.png", "ScreenshotCaption": "cred dumping alert - shows its high"}, {"ScreenshotName": "Elastic-APT29-1263.png", "ScreenshotCaption": "cred dumping alert - shows lsass.exe is the target"}]}, {"DetectionNote": "A Technique alert detection (low severity) for \"Credential Access: SAM Registry Reads\" was generated for lsass.exe reading the SAM database through the registry.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1729.png", "ScreenshotCaption": "cc  - cred access alert (existing) fired because of fixing black list - \n alert for sam registry reads"}]}, {"DetectionNote": "Telemetry showed lsass.exe accessing the NtOpenKey API. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1729.png", "ScreenshotCaption": "cc  - cred access alert (existing) fired because of fixing black list - \n alert for sam registry reads"}]}]}, {"SubStep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection (high severity) for \"Credential Dumping\" was generated for the execution of m.exe executing with command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1453.png", "ScreenshotCaption": "cred dumping alert for m.exe-lsass.exe,  showing details"}, {"ScreenshotName": "Elastic-APT29-1452.png", "ScreenshotCaption": "cred dumping alert, shows high sev"}]}]}, {"SubStep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection for \"Process Injection\" was generated for the injection into lsass.exe. The detection was correlated to a parent alert for the \"First Seen Process in an Environment\".", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1532.png", "ScreenshotCaption": "process injection alert related to cred dump"}, {"ScreenshotName": "Elastic-APT29-13700.png", "ScreenshotCaption": "target of process injection  with timstomping alert"}]}, {"DetectionNote": "A Technique alert detection (high severity) for \"Credential Dumping\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for the \"First Seen Process in an Environment\".", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1534.png", "ScreenshotCaption": "and now with cmdline"}]}]}]}, {"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) for \"RunDLL32 with Suspicious DLL Location\" was generated for rundll32.exe executing kxwn.lock.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1613.png", "ScreenshotCaption": "rundll32 with suspicious dll location alert, showing command line with .lock"}]}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1613.png", "ScreenshotCaption": "rundll32 with suspicious dll location alert, showing command line with .lock"}]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe\u00a0spawning from the rcs.3aka3.doc\u200b process", "Detections": [{"DetectionNote": "A General alert detection (medium severity) was generated for a \"Suspicious Parent of Built-in Shells.\" The detection was correlated to a parent alert for malicious file execution. ", "DetectionType": "General", "Modifiers": ["Configuration Change (Detections)", "Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1674.png", "ScreenshotCaption": "cc (strictness modification) suspicious parent of built-in shells alert"}]}, {"DetectionNote": "Telemetry showed rcs.3aka.doc spawning cmd.exe. The telemetry was correlated to a parent alert for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1189.png", "ScreenshotCaption": ""}]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1208.png", "ScreenshotCaption": "endgame client search to show integrity levels of powershell. shows high, and all others medium"}, {"ScreenshotName": "Elastic-APT29-1207.png", "ScreenshotCaption": "powershell running with unusual arguments execution alert"}]}]}, {"SubStep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).  The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-14971.png", "ScreenshotCaption": "14a2 - better pic for EG client"}]}]}]}, {"TechniqueId": "T1047", "TechniqueName": "Windows Management Instrumentation", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Potential Code Execution via WMI-based PowerShell Cmdlet\" was generated for PowerShell using WMI. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1444.png", "ScreenshotCaption": "potential code execution via wmi alert"}]}, {"DetectionNote": "A Technique alert detection (medium severity) for \"Suspicious Execution via WMI\" was generated for PowerShell using WMI. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1462.png", "ScreenshotCaption": "suspicious execution via wmi (from powershell) win32 process create"}]}, {"DetectionNote": "A Technique detection for \"ATT&CK T1047 Windows Management Instrumentation\" was generated for PowerShell using WMI. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Technique", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1445.png", "ScreenshotCaption": "process created via wmi event for child powershell with wmi enrichment"}]}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1444.png", "ScreenshotCaption": "potential code execution via wmi alert"}]}]}]}, {"TechniqueId": "T1114", "TechniqueName": "Email Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Detections": [{"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent alert for the \"First Seen Process in an Environment\".", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1555.png", "ScreenshotCaption": "psemail script block with contents"}, {"ScreenshotName": "Elastic-APT29-1559.png", "ScreenshotCaption": "outlook spawning from  svchost.exe"}, {"ScreenshotName": "Elastic-APT29-1562.png", "ScreenshotCaption": "new screenshot of outlook spawning from svhost with file created event. "}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-14343.png", "ScreenshotCaption": "1A4 - new pic - EG client DLLs"}]}]}, {"SubStep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1106", "TechniqueName": "Execution through API", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Detections": [{"DetectionNote": "Telemetry showed Netapi32.dll loaded into powershell.exe.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1711.png", "ScreenshotCaption": "cc 4c10 config change showing the dll load library (new api monitoring) 4.c.9 not working still"}, {"ScreenshotName": "Elastic-APT29-1243.png", "ScreenshotCaption": "4c11-12 "}]}]}, {"SubStep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Detections": [{"DetectionNote": "Telemetry showed Netapi32.dll loaded into powershell.exe.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1243.png", "ScreenshotCaption": "4c11-12 "}, {"ScreenshotName": "Elastic-APT29-1711.png", "ScreenshotCaption": "cc 4c10 config change showing the dll load library (new api monitoring) 4.c.9 not working still"}]}]}, {"SubStep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Detections": [{"DetectionNote": "Telemetry showed hostui.exe executing powershell.exe via CreateProcessWithTokenW. This event was correlated to a General detection for the execution of a malicious file. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1345.png", "ScreenshotCaption": "hostui createprocesswithtokenW"}]}]}, {"SubStep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Detections": [{"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1506.png", "ScreenshotCaption": "convertsidtostringsid script block"}]}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Detections": [{"DetectionNote": "A Technique detection for \"Data Staged\" was generated due to the NtCreateFile API being used to create Draft.zip. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1679.png", "ScreenshotCaption": "cc i think, showing enrichments for data staged and data compressed. "}]}, {"DetectionNote": "Telemetry showed file creation of Draft.zip. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1196.png", "ScreenshotCaption": "file create event - showing the file created (zip) coming off of powershell. "}]}]}, {"SubStep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Detections": [{"DetectionNote": "Telemetry showed a File Created event for powershell.exe creating working.zip. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1327.png", "ScreenshotCaption": "working.zip file created"}]}]}, {"SubStep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "Telemetry showed the file creation event for MITRE-ATTACK-EVALS.HTML. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1564.png", "ScreenshotCaption": "17b2 file create of ATTCK Evals html"}]}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1198.png", "ScreenshotCaption": "should be the same as the first screen, but showing script block again. "}]}]}, {"SubStep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing\u00a0$env:TEMP", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:TEMP. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1229.png", "ScreenshotCaption": "4c1-3 script block"}]}]}, {"SubStep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1330.png", "ScreenshotCaption": "get-child item with att&ck enrichment for data compressed"}]}]}, {"SubStep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1367.png", "ScreenshotCaption": "get item powershell cmdlet"}]}]}, {"SubStep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Detections": [{"DetectionNote": "A General alert detection for \"Stealthy PowerShell Commands\" (medium severity) was generated for PowerShell executing the timestomp function. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1388.png", "ScreenshotCaption": "stealthy powershell commands alert"}]}, {"DetectionNote": "Telemetry showed powershell.exe enumerating System32. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1391.png", "ScreenshotCaption": "timestomp function in powershell event"}]}]}]}, {"TechniqueId": "T1119", "TechniqueName": "Automated Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1198.png", "ScreenshotCaption": "should be the same as the first screen, but showing script block again. "}]}]}, {"SubStep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. This event was correlated to a General detection for the execution of a malicious file (python.exe).", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1330.png", "ScreenshotCaption": "get-child item with att&ck enrichment for data compressed"}]}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Detections": [{"DetectionNote": "A Technique alert detection (low severity) for \"Screen Capture\" was generated for powershell.exe calling the NtGdiCreateCompatibleBitmap API. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-13630.png", "ScreenshotCaption": "CC - not new rule, just updated blacklist  to show screen cap alert enrichment is same logic (some enrichments would be tagged as alert)"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll. The event was correlated to a parent General detection for malicious file execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-14951.png", "ScreenshotCaption": "7A1 - vendor pic for Telem "}]}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.A.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Detections": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1201.png", "ScreenshotCaption": "maybe something with monkey.png obfuscated????"}]}]}, {"SubStep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell.  The detection was correlated to a parent alert for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1213.png", "ScreenshotCaption": "making sure i got the full file create details for sysinternals zip"}]}]}, {"SubStep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Detections": [{"DetectionNote": "A General alert detection (high severity; red indicator) was generated for the malicious file create event of python.exe. ", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1302.png", "ScreenshotCaption": "python.exe in temp - malicious file "}]}, {"DetectionNote": "Telemetry showed a file create event of python.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1302.png", "ScreenshotCaption": "python.exe in temp - malicious file "}]}]}, {"SubStep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file rar.exe", "Detections": [{"DetectionNote": "Telemetry showed file created event for python.exe creating rar.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1324.png", "ScreenshotCaption": "rar.exe created ignore some of the ones above he moved fast "}]}]}, {"SubStep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file sdelete64.exe", "Detections": [{"DetectionNote": "Telemetry showed File Created event for python.exe creating sdelete64.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1325.png", "ScreenshotCaption": "sdelete created"}]}]}, {"SubStep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Detections": [{"DetectionNote": "A General alert detection (medium severity) for \"Suspicious Download Command via PowerShell\" was generated for the PowerShell command to download m.exe. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-13638.png", "ScreenshotCaption": "suspicious download alert pulling down mimikatz"}]}, {"DetectionNote": "Telemetry showed the file write event for m.exe into the System32 folder. The detection was correlated to a parent alert for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1450.png", "ScreenshotCaption": "m file create event from powershell"}]}]}, {"SubStep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated for the creation of a malicious file (m.exe). The detection was correlated to a parent alert for the \"First Seen Process  in an Environment\".", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1531.png", "ScreenshotCaption": "and better still with the file create of wsmprovhost.exe"}]}, {"DetectionNote": "Telemetry showed a file write event for m.exe in the System32 directory by wsmprovhost.exe. The detection was correlated to a parent alert for the \"First Seen Process  in an Environment\".", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1531.png", "ScreenshotCaption": "and better still with the file create of wsmprovhost.exe"}]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam", "Criteria": "Successful logon as user Pam on\u00a0Scranton (10.0.1.4) ", "Detections": [{"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1315.png", "ScreenshotCaption": "admin logons - 8c1 tele"}]}]}, {"SubStep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4) ", "Detections": [{"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1525.png", "ScreenshotCaption": "remote logon event of mscott onto new york"}]}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe\u00a0executing\u200b Get-WmiObject ...\u200b -Class\u00a0AntiVirusProduct", "Detections": [{"DetectionNote": "A Tactic detection called \"Reconnaissance of Multiple WMI Classes\" was generated due to multiple WMI classes being executed in quick succession. The event was correlated to a parent General detection for malicious file execution. The detection was a medium severity alert.", "DetectionType": "Tactic", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1237.png", "ScreenshotCaption": "detected discovery alert based on recon of multiple wmi classes. x number of classes called over a period of time. "}]}, {"DetectionNote": "Telemetry showed powershell.exe executing $Gwmi WmiObject ...\u200b -Class AntiVirusProduct. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1233.png", "ScreenshotCaption": "antivirus wmi event"}]}]}, {"SubStep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe\u00a0executing Get-WmiObject\u00a0...\u200b\u200b -Class\u00a0FireWallProduct", "Detections": [{"DetectionNote": "A Tactic detection called \"Reconnaissance of Multiple WMI Classes\" was generated due to multiple WMI classes being executed in quick succession. The event was correlated to a parent General detection for malicious file execution. The detection was a medium severity alert.", "DetectionType": "Tactic", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1237.png", "ScreenshotCaption": "detected discovery alert based on recon of multiple wmi classes. x number of classes called over a period of time. "}]}, {"DetectionNote": "Telemetry showed powershell.exe executing $Gwmi WmiObject ...\u200b -Class FireWallProduct. The event was correlated to a parent General detection for malicious file execution.\t", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1235.png", "ScreenshotCaption": "firewall wmi event"}]}]}, {"SubStep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Detections": [{"DetectionNote": "A Technique detection (medium severity) for \"ATT&CK T1063 Security Software Discovery\"  was generated due to PowerShell executing the detectav function. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Configuration Change (Detections)", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1807.png", "ScreenshotCaption": "cc - powershell enrichment change to security software discovery. "}]}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct. The event was correlated to a parent General detection for a suspicious Windows script.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1395.png", "ScreenshotCaption": "wmi  event for av product"}]}]}]}, {"TechniqueId": "T1112", "TechniqueName": "Modify Registry", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Detections": [{"DetectionNote": "Telemetry showed PowerShell command to remove DelegateExecute Registry Value.  The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1211.png", "ScreenshotCaption": "file deletion  of the registry path from powershell"}]}]}, {"SubStep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command\u00a0subkey", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the system was interrogated and the Registry key could not be found indicating it had been deleted, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-13682.png", "ScreenshotCaption": "endgame client reg delete maybe??"}]}]}]}, {"TechniqueId": "T1120", "TechniqueName": "Peripheral Device Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Detections": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1363.png", "ScreenshotCaption": "win32 pnpentity wmi event"}]}]}]}, {"TechniqueId": "T1045", "TechniqueName": "Software Packing", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though python.exe was manually recovered from the system by the analyst, and it was identified as UPX packed. This is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-18081.png", "ScreenshotCaption": "8b2-rebuttal pic details"}, {"ScreenshotName": "Elastic-APT29-18080.png", "ScreenshotCaption": "8b2 rebuttal pic of hunt"}]}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Detections": [{"DetectionNote": "A Technique alert detection (low severity) for \"Service Creation/Modification\" was generated due to powershell.exe creating the javamtsup.exe service. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1245.png", "ScreenshotCaption": "same pric esc alert with the file renamed event."}]}, {"DetectionNote": "Telemetry showed PowerShell created the new service javamtsup. The event was correlated to a parent General detection for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-15109.png", "ScreenshotCaption": "5a1 - vendor pic for telem"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scanton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Detections": [{"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135. The detection was correlated to a parent alert for malicious file execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1318.png", "ScreenshotCaption": "smb connection - 8c2 tactic"}]}]}]}, {"TechniqueId": "T1065", "TechniqueName": "Uncommonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Detections": [{"DetectionNote": "Telemetry showed the rcs.3aka.doc connected to 192.168.0.5 on TCP port 1234.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1177.png", "ScreenshotCaption": "double check to make sure i got network connection info. "}]}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Detections": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1225.png", "ScreenshotCaption": "making sure i got the .scr deletion"}]}]}, {"SubStep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Detections": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1226.png", "ScreenshotCaption": "draft.zip file deletion"}]}]}, {"SubStep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for malicious file execution. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1228.png", "ScreenshotCaption": "delete of sysinternals"}]}]}, {"SubStep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Detections": [{"DetectionNote": "A Technique alert detection (high severity) for \"ATT&CK T1107 File Deletion\" was generated when sdelete64.exe made a NtSetInformationFile API call deleting rar.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1766.png", "ScreenshotCaption": "cc - file deletion enrichment for 9.c.3 based on api monitoring"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1341.png", "ScreenshotCaption": "rar.exe file delete"}]}]}, {"SubStep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Detections": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-15005.png", "ScreenshotCaption": "9c2 - file delete working.zip"}]}]}, {"SubStep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Detections": [{"DetectionNote": "A Technique alert detection (high severity) for \"ATT&CK T1107 File Deletion\" was generated when sdelete64.exe made a NtSetInformationFile API call deleting Roaming\\working.zip. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1766.png", "ScreenshotCaption": "cc - file deletion enrichment for 9.c.3 based on api monitoring"}], "Footnotes": ["Configuration changes were made to increase detection capability, specifically additional API monitoring. "]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip.This event was correlated to a Technique detection for the creation of psexesvc.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1767.png", "ScreenshotCaption": "cc - commandline for the  enrichment above"}]}]}, {"SubStep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Detections": [{"DetectionNote": "A Technique alert detection for \"ATT&CK T1107 File Deletion\" was generated when cmd.exe deleted sdelete64.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1340.png", "ScreenshotCaption": "sdlete64.exe file delete "}]}, {"DetectionNote": "Telemetry showed cmd.exe deleting sdelete64.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1341.png", "ScreenshotCaption": "rar.exe file delete"}]}]}, {"SubStep": "19.A.1", "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\System32\\m.exe", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.1", "Procedure": "Deleted exfiltrated data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration.tmp", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.1", "Procedure": "Deleted staged data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Detections": [{"DetectionNote": "A General alert detection (high severity) was generated for the execution of a malicious file (rcs.3aka3.doc). ", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1173.png", "ScreenshotCaption": "(use this pic) Malicious file execution (revolver view) showing the file type as executable"}]}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1173.png", "ScreenshotCaption": "(use this pic) Malicious file execution (revolver view) showing the file type as executable"}]}]}, {"SubStep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Detections": [{"DetectionNote": "A General alert detection (medium severity) was generated for \"Suspicious Windows Script from Parent Process\" for explorer.exe executing powershell.exe.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1352.png", "ScreenshotCaption": "Resolver view of suspicious windows script from parent process -- shows explorer starting powershell"}]}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Elastic-APT29-1354.png", "ScreenshotCaption": "showing the get content commandline in powershell"}]}]}]}]}