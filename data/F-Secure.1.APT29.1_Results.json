{"PublicRelease": "\u00a92020 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-03607-4", "Techniques": [{"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Rare DLL explicitly loaded by rundll32\" was generated due to rundll32.exe executing kxwn.lock.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10499.png", "ScreenshotCaption": "20a1 - detection name, rundll32 /kxwn from explorer  - need to move"}]}, {"DetectionNote": "A Technique alert detection (medium severity) called \"Rundll32 launching a DLL in the AppData directory\" was generated due to rundll32.exe executing kxwn.lock.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10526.png", "ScreenshotCaption": "poshc2 tag"}]}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10518.png", "ScreenshotCaption": "rundll32 .lock"}]}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Detections": [{"DetectionNote": "A General alert detection (informational) was generated due to a suspicious download by PowerShell. The detection was correlated to a parent alert for Abnormal File Modification.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10016.png", "ScreenshotCaption": "process tree, powershell payload, sus download "}]}]}, {"SubStep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "A General alert detection (low severity) was generated for PowerShell downloading a significant amount of data using HTTP(S).", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10036.png", "ScreenshotCaption": "powershell downloaded a significiant amount of data using HTTPS - https based off of "}]}]}, {"SubStep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence that python.exe was copied to remote host Scranton (10.0.1.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14494.png", "ScreenshotCaption": ""}, {"ScreenshotName": "F-Secure-APT29-11294.png", "ScreenshotCaption": "MSSP - webdav stuff"}]}, {"DetectionNote": "Telemetry showed a file create event of python.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10112.png", "ScreenshotCaption": "python.exe file create"}]}]}, {"SubStep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file rar.exe", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence that rar.exe was copied to remote host Scranton (10.0.1.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11297.png", "ScreenshotCaption": "MSSP - pythong and rar"}, {"ScreenshotName": "F-Secure-APT29-14494.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed FILE_CREATE event for python.exe creating rar.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10136.png", "ScreenshotCaption": "file creations of sdelete.exe, rar.exe, also rar.exe creating working.zip"}]}]}, {"SubStep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file sdelete64.exe", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence that sdelete.exe was copied to remote host Scranton (10.0.1.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14495.png", "ScreenshotCaption": ""}, {"ScreenshotName": "F-Secure-APT29-14494.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed FILE_CREATE event for python.exe creating sdelete64.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10136.png", "ScreenshotCaption": "file creations of sdelete.exe, rar.exe, also rar.exe creating working.zip"}]}]}, {"SubStep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Detections": [{"DetectionNote": "A Technique alert detection (info severity) was generated for a suspicious download by PowerShell.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10250.png", "ScreenshotCaption": "ip address and port 443 and HTTPS "}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of the download and file write of m.exe into System32 folder.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-13276.png", "ScreenshotCaption": "MSSP Summary"}, {"ScreenshotName": "F-Secure-APT29-11314.png", "ScreenshotCaption": "MSSP - wc function - no context"}]}, {"DetectionNote": "Telemetry showed the file create event for m.exe in the System32 folder.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10346.png", "ScreenshotCaption": "file create of m.exe"}]}]}, {"SubStep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the file write of m.exe to System32.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11318.png", "ScreenshotCaption": "MSSP - copy item"}, {"ScreenshotName": "F-Secure-APT29-11303.png", "ScreenshotCaption": "MSSP - day2 executive summary - pt2"}]}, {"DetectionNote": "Telemetry showed the file create of m.exe in the System32 directory by wsmprovhost.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10428.png", "ScreenshotCaption": "m.exe file create"}]}]}]}, {"TechniqueId": "T1112", "TechniqueName": "Modify Registry", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Detections": [{"DetectionNote": "An MSSP detection occurred for the recursive deletion of the registry key.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11275.png", "ScreenshotCaption": "MSSP - remove item"}]}, {"DetectionNote": "Telemetry showed PowerShell command to remove DelegateExecute Registry Value.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-17351.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command\u00a0subkey", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the deletion of the Registry value.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11313.png", "ScreenshotCaption": "MSSP - raw function"}, {"ScreenshotName": "F-Secure-APT29-11302.png", "ScreenshotCaption": "MSSP - day2 executive summary pt1"}]}]}]}, {"TechniqueId": "T1086", "TechniqueName": "PowerShell", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u00a0spawning from cmd.exe", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for Abnormal Process.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10004.png", "ScreenshotCaption": "cmd parent to powershel, 3aka3 spawning cmd."}, {"ScreenshotName": "F-Secure-APT29-10571.png", "ScreenshotCaption": "powershell part of tree spawning from .doc"}]}]}, {"SubStep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection for PowerShell (medium severity) was generated due to a suspicious PowerShell command. The detection was correlated to a parent alert for a suspicious download by PowerShell.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14969.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for a suspicious download by PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14969.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u200b spawning from python.exe", "Detections": [{"DetectionNote": "Telemetry showed python.exe executing powershell.exe. This event was correlated to prior detection for the python.exe process.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10138.png", "ScreenshotCaption": "process tree showing python spawning powershell"}]}]}, {"SubStep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Detections": [{"DetectionNote": "A Technique alert detection (high severity)  for a Powershell script launched from ads was generated due to a PowerShell script launched from an ADS.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10249.png", "ScreenshotCaption": "ads with schemas"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10249.png", "ScreenshotCaption": "ads with schemas"}]}]}, {"SubStep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (high severity) was generated for powershell.exe running with parameters that are typically used in post-exploitation payloads.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10698.png", "ScreenshotCaption": "wmi spawning powershell"}]}, {"DetectionNote": "Telemetry showed PowerShell spawned from WMI event subscription (wmiprvse.exe).", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10515.png", "ScreenshotCaption": "wmiprvse executing powershell"}]}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Detections": [{"DetectionNote": "A Technique alert detection (low severity) for \"Service Execution\" was generated due to PsExec running a process remotely. The event was correlated to parent alert for Abnormal File Modification.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10135.png", "ScreenshotCaption": "with att&ck ids"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of PSEXESVC.exe executing python.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14494.png", "ScreenshotCaption": ""}, {"ScreenshotName": "F-Secure-APT29-11295.png", "ScreenshotCaption": "MSSP - command line arg for lateral movement via psexec"}]}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10134.png", "ScreenshotCaption": "psexec executing python"}]}]}, {"SubStep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1102", "TechniqueName": "Web Service", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Detections": [{"DetectionNote": "A General alert detection (informational severity) was generated for net.exe making a network connection. It included details of net.exe executing and connecting to a public IP over port 443. This is correlated to a previous detection for PowerShell.", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10478.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of file exfiltration to a Microsoft OneDrive that is mapped as a share drive \"Y:\".", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11320.png", "ScreenshotCaption": "MSSP - move to B- copy-item"}, {"ScreenshotName": "F-Secure-APT29-11303.png", "ScreenshotCaption": "MSSP - day2 executive summary - pt2"}]}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10462.png", "ScreenshotCaption": "a1 - remote ip and port"}, {"ScreenshotName": "F-Secure-APT29-10460.png", "ScreenshotCaption": "a1 - net use "}]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10107.png", "ScreenshotCaption": "port 389 for 10.0.0.4"}, {"ScreenshotName": "F-Secure-APT29-10113.png", "ScreenshotCaption": "invoke command script block get-process"}]}]}, {"SubStep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389 and a modload for System.DirectoryServices.dll.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10397.png", "ScreenshotCaption": "port 389 "}, {"ScreenshotName": "F-Secure-APT29-10401.png", "ScreenshotCaption": "function API names being called"}]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam", "Criteria": "Successful logon as user Pam on\u00a0Scranton (10.0.1.4) ", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of a valid logon on Scranton (10.0.1.4) as user Pam.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14494.png", "ScreenshotCaption": ""}, {"ScreenshotName": "F-Secure-APT29-11295.png", "ScreenshotCaption": "MSSP - command line arg for lateral movement via psexec"}]}, {"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10125.png", "ScreenshotCaption": "4624 logon events of pam on scranton"}]}]}, {"SubStep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4) ", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of lateral movement from utica to new york as the user mscott.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11317.png", "ScreenshotCaption": "MSSP - winrmsession raw function"}, {"ScreenshotName": "F-Secure-APT29-11303.png", "ScreenshotCaption": "MSSP - day2 executive summary - pt2"}]}, {"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10423.png", "ScreenshotCaption": "logon events "}]}]}]}, {"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process \u200bOR the original filename (cod.3aka.scr)", "Detections": [{"DetectionNote": "An MSSP detection occurred showing the original filename:\u200b cod.3aka.scr.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11250.png", "ScreenshotCaption": "MSSP - a2/3 - rtlo and network connection "}]}, {"DetectionNote": "Telemetry showed a process \"?cod.3aka\" with filename \"rcs.3aka.doc\", indicative of masquerading.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-9989.png", "ScreenshotCaption": "process name is different from full path name"}]}]}, {"SubStep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesscheck.exe is not the legitimate Sysinternals tool", "Detections": [{"DetectionNote": "A General alert detection (medium severity) was generated identifying accesschk.exe as potentially unwanted application (PUA). This indicates that the file is not the legitimate Sysinternals tool.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10077.png", "ScreenshotCaption": "bad bad file kibana pua for accesschk"}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-17345.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "Telemetry showed PowerShell process exchanging data over HTTPS.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-15101.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14657.png", "ScreenshotCaption": ""}]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Detections": [{"DetectionNote": "A General alert detection (low severity) was generated for a shortcut file (hostui.lnk) being modified. The event was correlated to a parent alert for suspicious powershell.", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10618.png", "ScreenshotCaption": "hostui.lnk rdr"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of the creation of the hostui.lnk file in the Startup folder.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11301.png", "ScreenshotCaption": "MSSP - executive overview (lots of steps alert) pt2"}, {"ScreenshotName": "F-Secure-APT29-11280.png", "ScreenshotCaption": "MSSP - hostui stuff"}]}, {"DetectionNote": "Telemetry showed Startup folder registry modification for hostui.lnk.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10068.png", "ScreenshotCaption": "hostui.lnk"}]}]}, {"SubStep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Detections": [{"DetectionNote": "A Technique alert detection (high severity) was generated for a detected process performing a Registry write that looks like a launchpoint. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10246.png", "ScreenshotCaption": "possible persistence, .lock file"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of the creation of a registry value named \"Webcache.\"", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11308.png", "ScreenshotCaption": "MSSP - a11 - webcache"}]}, {"DetectionNote": "Telemetry showed a Registry write event of the Webcache subkey identified as an Autorun.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10248.png", "ScreenshotCaption": "webcache "}]}]}]}, {"TechniqueId": "T1045", "TechniqueName": "Software Packing", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the analyst was able to retrieve the file, and demonstrate that it is UPX packed, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10126.png", "ScreenshotCaption": "UPX - downloaded file and looking at binary"}]}]}]}, {"TechniqueId": "T1122", "TechniqueName": "Component Object Model Hijacking", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of\u00a0the DelegateExecute\u00a0\u200bsubkey in\u00a0\u200bHKCU\\Software\\Classes\\Folder\\shell\\open\\\u200b\u200bcommand\u200b\u200b", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the addition of the DelegateExecute Registry Value.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14338.png", "ScreenshotCaption": ""}, {"ScreenshotName": "F-Secure-APT29-11300.png", "ScreenshotCaption": "MSSP - executive overview (lots of steps alert) pt1"}]}, {"DetectionNote": "Telemetry showed a Registry write of the command subkey.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10024.png", "ScreenshotCaption": "shell open command reg write"}]}]}, {"SubStep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of executed function \"bypass.\"", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11302.png", "ScreenshotCaption": "MSSP - day2 executive summary pt1"}, {"ScreenshotName": "F-Secure-APT29-11313.png", "ScreenshotCaption": "MSSP - raw function"}]}, {"DetectionNote": "Telemetry showed a Registry command to add a new value, DelegateExecute. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10309.png", "ScreenshotCaption": "function bypass"}, {"ScreenshotName": "F-Secure-APT29-10311.png", "ScreenshotCaption": "delegateexecute and sdclt and open command"}]}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Detections": [{"DetectionNote": "A General alert detection (low severity) was generated for rcs.3aka3.doc being identified as a \"rare process executed.\"", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-9985.png", "ScreenshotCaption": "process tree detection information, rare process executed with command line from pam desktop, explorere.exe executing .doc"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of user Pam executing rcs.3aka3.doc.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11250.png", "ScreenshotCaption": "MSSP - a2/3 - rtlo and network connection "}]}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-9989.png", "ScreenshotCaption": "process name is different from full path name"}]}]}, {"SubStep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11304.png", "ScreenshotCaption": "MSSP - lnk file details "}]}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10228.png", "ScreenshotCaption": "explorer launching powershell"}]}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Detections": [{"DetectionNote": "An MSSP detection for Create New Service occurred containing evidence of the javamtsup service being installed. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11279.png", "ScreenshotCaption": "MSSP - new service with command line args"}]}, {"DetectionNote": "Telemetry showed a registry event and service creation of javamtsup.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10073.png", "ScreenshotCaption": "javamtsup"}, {"ScreenshotName": "F-Secure-APT29-10069.png", "ScreenshotCaption": "javamtsup service creation"}]}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell taking screenshots.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11283.png", "ScreenshotCaption": "MSSP - invoke screen capture (a1)"}, {"ScreenshotName": "F-Secure-APT29-11301.png", "ScreenshotCaption": "MSSP - executive overview (lots of steps alert) pt2"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10630.png", "ScreenshotCaption": "CopyFromScreen"}]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe\u00a0spawning from the rcs.3aka3.doc\u200b process", "Detections": [{"DetectionNote": "An MSSP detection for an anomalous script occurred containing evidence of cmd spawning from rcs.3aka3.doc\u200b.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11252.png", "ScreenshotCaption": "MSSP - cmd launched (not sure its close enough to what we are looking for)"}]}, {"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert for Abnormal File Modification.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10004.png", "ScreenshotCaption": "cmd parent to powershel, 3aka3 spawning cmd."}, {"ScreenshotName": "F-Secure-APT29-9996.png", "ScreenshotCaption": "process tree with cmd.exe"}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10091.png", "ScreenshotCaption": "get-clipboard "}]}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERDOMAIN.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10062.png", "ScreenshotCaption": "invoke-discovery"}]}]}, {"SubStep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11306.png", "ScreenshotCaption": "MSSP - enumeration - bios, pnpentity, computer system, process"}]}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10234.png", "ScreenshotCaption": "11a3-8 - thp - wmi stuff"}]}]}, {"SubStep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11312.png", "ScreenshotCaption": "MSSP - 13a/b/c/d - function imports "}, {"ScreenshotName": "F-Secure-APT29-11302.png", "ScreenshotCaption": "MSSP - day2 executive summary pt1"}]}, {"DetectionNote": "Telemetry showed the NetWkstaGetInfo API call. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10303.png", "ScreenshotCaption": "API calls"}]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell compressing and encrypting contents of the downloads folder.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11301.png", "ScreenshotCaption": "MSSP - executive overview (lots of steps alert) pt2"}, {"ScreenshotName": "F-Secure-APT29-11285.png", "ScreenshotCaption": "MSSP - invoke exfil "}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-17366.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence that rar.exe was used to compress and encrypt working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14494.png", "ScreenshotCaption": ""}, {"ScreenshotName": "F-Secure-APT29-11293.png", "ScreenshotCaption": "MSSP - raw command - childitem"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. This event was correlated to a previous detection for Abnormal File Modification.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10139.png", "ScreenshotCaption": "rar.exe with command line arguments"}]}]}]}, {"TechniqueId": "T1097", "TechniqueName": "Pass the Ticket", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Detections": [{"DetectionNote": "A General alert detection (medium severity) was generated for a suspicious PowerShell command.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10524.png", "ScreenshotCaption": "1 - invoke mimikatax"}, {"ScreenshotName": "F-Secure-APT29-10522.png", "ScreenshotCaption": "suspicious PS command"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of Mimikatz being used to execute a golden ticket attack impersonating mscott.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11323.png", "ScreenshotCaption": "MSSP - invoke mimikatz and toby useradd"}, {"ScreenshotName": "F-Secure-APT29-11303.png", "ScreenshotCaption": "MSSP - day2 executive summary - pt2"}]}, {"DetectionNote": "Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10534.png", "ScreenshotCaption": "golden ticket invoke mimi"}]}]}]}, {"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10035.png", "ScreenshotCaption": "port 443 with 192.168.0.5"}]}]}, {"SubStep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "An MSSP occurred containing evidence of a connection back to the C2 server 192.168.0.4 over port 443.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11305.png", "ScreenshotCaption": "MSSP - lnk being executed with iex/schemas"}, {"ScreenshotName": "F-Secure-APT29-11302.png", "ScreenshotCaption": "MSSP - day2 executive summary pt1"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14657.png", "ScreenshotCaption": ""}]}]}]}, {"TechniqueId": "T1028", "TechniqueName": "Windows Remote Management", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) was generated due to PowerShell using WinRM.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10111.png", "ScreenshotCaption": "Invoke command username powershell"}, {"ScreenshotName": "F-Secure-APT29-10110.png", "ScreenshotCaption": "using winrm detection"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Invoke-Command and connected to remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10109.png", "ScreenshotCaption": "5985 port number"}, {"ScreenshotName": "F-Secure-APT29-10113.png", "ScreenshotCaption": "invoke command script block get-process"}]}]}, {"SubStep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection (informational severity) for Windows Remote Management was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14506.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10418.png", "ScreenshotCaption": "5985 again, ty Skype, ty Microsoft"}]}]}, {"SubStep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection (informational severity) was generated for PowerShell using Windows Remote Management. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10699.png", "ScreenshotCaption": "2 / 3 "}]}, {"DetectionNote": "Telemetry showed PowerShell execution of Enter-PSSession and the corresponding powershell.exe network connection to remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10550.png", "ScreenshotCaption": "enter-pssesion"}, {"ScreenshotName": "F-Secure-APT29-10544.png", "ScreenshotCaption": "2 - ip and port"}]}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesscheck.exe executing the CryptUnprotectedData API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe\u00a0reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) for a possible LSASS memory dump was generated due powershell.exe opening handles to lsass.exe in a pattern that happens when a minidump of a process is generated.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10626.png", "ScreenshotCaption": "rdr lsass"}]}]}, {"SubStep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection (high severity) called \"Mimikatz command line parameters\" was generated due to m.exe executing with command-line arguments indicative of Mimikatz credential dumping. This detection was correlated to a parent alert for privilege escalation.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10348.png", "ScreenshotCaption": "m.exe executing password udmper executed"}]}, {"DetectionNote": "A Technique alert detection (medium severity) called \"Password Dumper Executed\" was generated due to a known password hash dumper running. This detection was correlated to a parent alert for privilege escalation.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10348.png", "ScreenshotCaption": "m.exe executing password udmper executed"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of Mimikatz execution.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-13276.png", "ScreenshotCaption": "MSSP Summary"}, {"ScreenshotName": "F-Secure-APT29-11314.png", "ScreenshotCaption": "MSSP - wc function - no context"}]}]}, {"SubStep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection (high severity) for Credential Dumping was generated due to a known password dumper being executed. This event was correlated to a parent detection for privilege escalation.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10438.png", "ScreenshotCaption": "more mimi process tree"}]}, {"DetectionNote": "A Technique alert detection (high severity) for \"Credential Dumping\" was generated due to lsass memory dump. This detection was correlated to a parent detection for privilege escalation.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10441.png", "ScreenshotCaption": "best mimikatz view lsass stuff too"}]}, {"DetectionNote": "A Technique alert detection (high severity) for \"Credential Dumping\" was generated due to Mimikatz command-line parameters being executed. This event was correlated to a parent detection for privilege escalation.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10441.png", "ScreenshotCaption": "best mimikatz view lsass stuff too"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of Mimikatz dumping the KRBTGT hash.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11303.png", "ScreenshotCaption": "MSSP - day2 executive summary - pt2"}, {"ScreenshotName": "F-Secure-APT29-11318.png", "ScreenshotCaption": "MSSP - copy item"}]}, {"DetectionNote": "Telemetry showed m.exe injecting a thread into lsass.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10435.png", "ScreenshotCaption": "threat injection lsass"}]}]}]}, {"TechniqueId": "T1497", "TechniqueName": "Virtualization/Sandbox Evasion", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_BIOS.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11306.png", "ScreenshotCaption": "MSSP - enumeration - bios, pnpentity, computer system, process"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10234.png", "ScreenshotCaption": "11a3-8 - thp - wmi stuff"}]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.4", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Detections": [{"DetectionNote": "Telemetry showed PowerShell process exchanging data over HTTPS.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-17349.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "11.A.14", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Detections": [{"DetectionNote": "Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14657.png", "ScreenshotCaption": ""}]}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe\u00a0executing\u200b Get-WmiObject ...\u200b -Class\u00a0AntiVirusProduct", "Detections": [{"DetectionNote": "A Technique alert detection labeled wmi-enumeration-av was generated due to a WMI query for AntivirusProduct.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10081.png", "ScreenshotCaption": "wmi stuff, wmi enum"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-17355.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe\u00a0executing Get-WmiObject\u00a0...\u200b\u200b -Class\u00a0FireWallProduct", "Detections": [{"DetectionNote": "A Technique alert detection was generated for WMI being used to query information about firewall products.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-17358.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-17360.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Detections": [{"DetectionNote": "A Technique alert detection (informational severity) was generated for for WMI querying information about anti-virus products. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14505.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell gwmi query for AntiVirusProduct.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11302.png", "ScreenshotCaption": "MSSP - day2 executive summary pt1"}, {"ScreenshotName": "F-Secure-APT29-11310.png", "ScreenshotCaption": "MSSP - detectav "}]}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10270.png", "ScreenshotCaption": "antivirusproduct"}]}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetGroups\u00a0API", "Detections": [{"DetectionNote": "Telemetry showed the NetUserGetGroups API call. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10064.png", "ScreenshotCaption": "Netapi namespace and methodname"}]}]}, {"SubStep": "4.C.11", "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetLocalGroups\u00a0API", "Detections": [{"DetectionNote": "Telemetry showed the NetUserGetLocalGroups API call. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10064.png", "ScreenshotCaption": "Netapi namespace and methodname"}]}]}]}, {"TechniqueId": "T1106", "TechniqueName": "Execution through API", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Detections": [{"DetectionNote": "Telemetry showed the NetUserGetGroups API function from Netapi32.dll. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10064.png", "ScreenshotCaption": "Netapi namespace and methodname"}]}]}, {"SubStep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Detections": [{"DetectionNote": "Telemetry showed the NetUserGetLocalGroups API function from Netapi32.dll. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10064.png", "ScreenshotCaption": "Netapi namespace and methodname"}]}]}, {"SubStep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed svchost.exe with -seclogon flag spawning before PowerShell.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10173.png", "ScreenshotCaption": "seclogon"}]}]}, {"SubStep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Detections": [{"DetectionNote": "Telemetry showed that PowerShell loaded Advapi32.dll in order to execute the ConvertSidToStringSid API function.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10401.png", "ScreenshotCaption": "function API names being called"}]}]}]}, {"TechniqueId": "T1005", "TechniqueName": "Data from Local System", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav\u00a0network share (192.168.0.4:80)", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PoweShell Copy-Item to remote WebDav network share (192.168.0.4)", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11285.png", "ScreenshotCaption": "MSSP - invoke exfil "}, {"ScreenshotName": "F-Secure-APT29-11301.png", "ScreenshotCaption": "MSSP - executive overview (lots of steps alert) pt2"}]}]}, {"SubStep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of file exfiltration to a Microsoft OneDrive that is mapped as a share drive \"Y:\".", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11320.png", "ScreenshotCaption": "MSSP - move to B- copy-item"}, {"ScreenshotName": "F-Secure-APT29-11303.png", "ScreenshotCaption": "MSSP - day2 executive summary - pt2"}]}, {"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10464.png", "ScreenshotCaption": "a2 - copy item of the .tmp"}]}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesscheck.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1099", "TechniqueName": "Timestomp", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the Powershell function \"timestomp\" being called to modify the creation time of kxwn.lock.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11309.png", "ScreenshotCaption": "MSSP - timestomp"}]}, {"DetectionNote": "Telemetry showed the LastWriteTime of kxwn.lock being accessed. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10264.png", "ScreenshotCaption": "timestop being called, and access to LastWriteTime "}]}]}]}, {"TechniqueId": "T1145", "TechniqueName": "Private Keys", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the Master File Table (MFT) was manually pulled in order to locate the written pfx private key file.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10632.png", "ScreenshotCaption": "grepping the table for the pfx"}]}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.A.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1096", "TechniqueName": "NTFS File Attributes", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Detections": [{"DetectionNote": "A Technique alert detection (high severity) was generated due to PowerShell running a script from an ADS.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10230.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing schemas ADS via Get-Content and IEX.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11305.png", "ScreenshotCaption": "MSSP - lnk being executed with iex/schemas"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10223.png", "ScreenshotCaption": "thp get-content "}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of Powershell functions which queried the WMI security centre class and also the software uninstall registry keys.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11302.png", "ScreenshotCaption": "MSSP - day2 executive summary pt1"}, {"ScreenshotName": "F-Secure-APT29-11311.png", "ScreenshotCaption": "MSSP - reg key queries"}]}, {"DetectionNote": "Telemetry showed script block with registry query for installed software.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10289.png", "ScreenshotCaption": "uninstall reg key"}, {"ScreenshotName": "F-Secure-APT29-10287.png", "ScreenshotCaption": "OpenSubKey"}]}]}, {"SubStep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of Powershell functions which queried the WMI security centre class and also the software uninstall registry keys.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11302.png", "ScreenshotCaption": "MSSP - day2 executive summary pt1"}, {"ScreenshotName": "F-Secure-APT29-11311.png", "ScreenshotCaption": "MSSP - reg key queries"}]}, {"DetectionNote": "Telemetry showed script block with registry query for installed software.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10289.png", "ScreenshotCaption": "uninstall reg key"}]}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing\u00a0Compress-Archive", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the Compress-Archive cmdlet being executed.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11254.png", "ScreenshotCaption": "MSSP - get-childitem and compress archive scriptblock"}]}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10009.png", "ScreenshotCaption": "Draft.Zip at the end of the CommandStart"}]}]}, {"SubStep": "7.B.2", "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence that rar.exe was used to compress and encrypt working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11293.png", "ScreenshotCaption": "MSSP - raw command - childitem"}, {"ScreenshotName": "F-Secure-APT29-14494.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. This event was correlated to a previous detection for Abnormal File Modification.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10138.png", "ScreenshotCaption": "process tree showing python spawning powershell"}, {"ScreenshotName": "F-Secure-APT29-10139.png", "ScreenshotCaption": "rar.exe with command line arguments"}]}]}, {"SubStep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell compressing WindowsParentalControlMigration.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11303.png", "ScreenshotCaption": "MSSP - day2 executive summary - pt2"}, {"ScreenshotName": "F-Secure-APT29-11320.png", "ScreenshotCaption": "MSSP - move to B- copy-item"}]}, {"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10453.png", "ScreenshotCaption": "set-content"}]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe\u00a0reading the file working.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed a connection to TCP port 8443.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10143.png", "ScreenshotCaption": "port 8443 for 9b8"}]}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10056.png", "ScreenshotCaption": "get-process"}]}]}, {"SubStep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $PID.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10062.png", "ScreenshotCaption": "invoke-discovery"}]}]}, {"SubStep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell being used to get process information from the remote system Scranton.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11289.png", "ScreenshotCaption": "MSSP "}, {"ScreenshotName": "F-Secure-APT29-14494.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10113.png", "ScreenshotCaption": "invoke command script block get-process"}]}]}, {"SubStep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11306.png", "ScreenshotCaption": "MSSP - enumeration - bios, pnpentity, computer system, process"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10234.png", "ScreenshotCaption": "11a3-8 - thp - wmi stuff"}]}]}, {"SubStep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell calling the CreateToolhelp32Snapshot API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11302.png", "ScreenshotCaption": "MSSP - day2 executive summary pt1"}, {"ScreenshotName": "F-Secure-APT29-11312.png", "ScreenshotCaption": "MSSP - 13a/b/c/d - function imports "}]}, {"DetectionNote": "Telemetry showed the CreateToolhelp32Snapshot API call.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10304.png", "ScreenshotCaption": "api calls with powershell"}]}]}, {"SubStep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10335.png", "ScreenshotCaption": "get process"}]}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Detections": [{"DetectionNote": "A Technique alert detection called dotnet-keylogging (medium severity) was generated for use of the GetAsyncKeyState API.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10099.png", "ScreenshotCaption": "get async keystate"}]}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10093.png", "ScreenshotCaption": "7a3"}]}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERNAME.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10062.png", "ScreenshotCaption": "invoke-discovery"}]}]}, {"SubStep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11306.png", "ScreenshotCaption": "MSSP - enumeration - bios, pnpentity, computer system, process"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10234.png", "ScreenshotCaption": "11a3-8 - thp - wmi stuff"}]}]}, {"SubStep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell calling the GetUserNameEx API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11312.png", "ScreenshotCaption": "MSSP - 13a/b/c/d - function imports "}, {"ScreenshotName": "F-Secure-APT29-11302.png", "ScreenshotCaption": "MSSP - day2 executive summary pt1"}]}, {"DetectionNote": "Telemetry showed the GetUserNameEx API call. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10303.png", "ScreenshotCaption": "API calls"}]}]}, {"SubStep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing $env:UserName.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10669.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10401.png", "ScreenshotCaption": "function API names being called"}]}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the Childitem cmdlet. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11254.png", "ScreenshotCaption": "MSSP - get-childitem and compress archive scriptblock"}]}, {"DetectionNote": "Telemetry showed the execution of ChildItem. \n", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10008.png", "ScreenshotCaption": "command start for childitem"}]}]}, {"SubStep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing\u00a0$env:TEMP", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:TEMP.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10062.png", "ScreenshotCaption": "invoke-discovery"}]}]}, {"SubStep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing ChildItem to search the file system.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11293.png", "ScreenshotCaption": "MSSP - raw command - childitem"}, {"ScreenshotName": "F-Secure-APT29-14494.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10140.png", "ScreenshotCaption": "CommandStart ChildItem"}]}]}, {"SubStep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10237.png", "ScreenshotCaption": "Get-Item"}]}]}, {"SubStep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell enumeration of System32.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14497.png", "ScreenshotCaption": ""}, {"ScreenshotName": "F-Secure-APT29-11309.png", "ScreenshotCaption": "MSSP - timestomp"}]}, {"DetectionNote": "Telemetry showed the PowerShell enumeration of the System32 directory. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10268.png", "ScreenshotCaption": "function timestomp in thp"}]}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Detections": [{"DetectionNote": "A Technique alert detection for file deletion (medium severity) was generated due to sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert for PowerShell.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10058.png", "ScreenshotCaption": ".scr sdeletee"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting rcs.3aka3.doc.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11277.png", "ScreenshotCaption": "MSSP - all 3 sdeletes"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe deleting rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10057.png", "ScreenshotCaption": "sdelete doing its thing"}]}]}, {"SubStep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Detections": [{"DetectionNote": "A Technique alert detection for file deletion (medium severity) was generated due to sdelete64.exe deleting Draft.Zip. The detection was correlated to a parent alert for PowerShell.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10607.png", "ScreenshotCaption": "rdr sysinternals.zip and draft.zip"}, {"ScreenshotName": "F-Secure-APT29-10059.png", "ScreenshotCaption": "the next one for sdelte.command line cut it off"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.zip", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11277.png", "ScreenshotCaption": "MSSP - all 3 sdeletes"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe deleting Draft.zip. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10057.png", "ScreenshotCaption": "sdelete doing its thing"}]}]}, {"SubStep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) for file deletion  was generated due to sdelete64.exe deleting SysinternalsSuite.zip. This was correlated to a previous detection for PowerShell.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10607.png", "ScreenshotCaption": "rdr sysinternals.zip and draft.zip"}, {"ScreenshotName": "F-Secure-APT29-10059.png", "ScreenshotCaption": "the next one for sdelte.command line cut it off"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11277.png", "ScreenshotCaption": "MSSP - all 3 sdeletes"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe deleting SysinternalsSuite.zip. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10057.png", "ScreenshotCaption": "sdelete doing its thing"}]}]}, {"SubStep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Sdelete file removal\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10145.png", "ScreenshotCaption": "rar.exe and working.zip"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The event was correlated to a Technique detection on python.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10144.png", "ScreenshotCaption": "sdeltee rar.exe"}]}]}, {"SubStep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Sdelete file removal\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10146.png", "ScreenshotCaption": "working .zip being delteed twice."}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete deleting Desktop\\working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11298.png", "ScreenshotCaption": "MSSP - file deletes"}, {"ScreenshotName": "F-Secure-APT29-14494.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The event was correlated to a Technique detection on python.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10144.png", "ScreenshotCaption": "sdeltee rar.exe"}]}]}, {"SubStep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Sdelete file removal\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10146.png", "ScreenshotCaption": "working .zip being delteed twice."}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete deleting Roaming\\working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11298.png", "ScreenshotCaption": "MSSP - file deletes"}, {"ScreenshotName": "F-Secure-APT29-14494.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The event was correlated to a Technique detection on python.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10144.png", "ScreenshotCaption": "sdeltee rar.exe"}]}]}, {"SubStep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the deletion of sdelete.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14496.png", "ScreenshotCaption": ""}, {"ScreenshotName": "F-Secure-APT29-14494.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed the file deletion of sdelete64.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10148.png", "ScreenshotCaption": "deted a file - sdelete64.exe"}]}]}, {"SubStep": "19.A.1", "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\System32\\m.exe", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.1", "Procedure": "Deleted exfiltrated data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration.tmp", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.1", "Procedure": "Deleted staged data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1114", "TechniqueName": "Email Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of psemail Powershell function being used to read email for the user.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11303.png", "ScreenshotCaption": "MSSP - day2 executive summary - pt2"}, {"ScreenshotName": "F-Secure-APT29-11319.png", "ScreenshotCaption": "MSSP - raw psemail function"}]}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10446.png", "ScreenshotCaption": "svchost launching outlook.exe  telemetry"}]}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1140", "TechniqueName": "Deobfuscate/Decode Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell unzipping and moving SysInternals tools.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14345.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10052.png", "ScreenshotCaption": "sysinternals exe"}, {"ScreenshotName": "F-Secure-APT29-17353.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) was generated for certutil with decode switch usage.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-15053.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "An MSSP occurred containing evidence of certutil.exe decoding kxwn.lock.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11307.png", "ScreenshotCaption": "MSSP - certutil (a10)"}]}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10243.png", "ScreenshotCaption": "certuil summary"}]}]}, {"SubStep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Detections": [{"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10362.png", "ScreenshotCaption": "getwmiobject"}]}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby ", "Detections": [{"DetectionNote": "A Technique alert detection (high severity) for net_user_add was generated due to net.exe being used to add a user account.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10530.png", "ScreenshotCaption": "3 - net exe detection with toby cmd line args"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of new user \"Toby\" being created with net.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11323.png", "ScreenshotCaption": "MSSP - invoke mimikatz and toby useradd"}, {"ScreenshotName": "F-Secure-APT29-11303.png", "ScreenshotCaption": "MSSP - day2 executive summary - pt2"}]}, {"DetectionNote": "Telemetry showed the user Toby being created on the scranton host. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10541.png", "ScreenshotCaption": "user create"}]}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Detections": [{"DetectionNote": "Telemetry showed file creation of Draft.zip.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14964.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell staging files into working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11293.png", "ScreenshotCaption": "MSSP - raw command - childitem"}, {"ScreenshotName": "F-Secure-APT29-14494.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed a FILE_CREATE event for powershell.exe creating working.zip.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10136.png", "ScreenshotCaption": "file creations of sdelete.exe, rar.exe, also rar.exe creating working.zip"}]}]}, {"SubStep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of MITRE-ATTACK-EVALS.html being copied into the Temp folder.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11303.png", "ScreenshotCaption": "MSSP - day2 executive summary - pt2"}, {"ScreenshotName": "F-Secure-APT29-11320.png", "ScreenshotCaption": "MSSP - move to B- copy-item"}]}]}]}, {"TechniqueId": "T1084", "TechniqueName": "Windows Management Instrumentation Event Subscription", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of WMI persistence being installed using the PowerShell function \"wmi.\"", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11316.png", "ScreenshotCaption": "MSSP - raw wmi function"}, {"ScreenshotName": "F-Secure-APT29-11303.png", "ScreenshotCaption": "MSSP - day2 executive summary - pt2"}]}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-17372.png", "ScreenshotCaption": ""}, {"ScreenshotName": "F-Secure-APT29-10381.png", "ScreenshotCaption": "wmi stuff"}]}]}, {"SubStep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Detections": [{"DetectionNote": "A General alert detection (medium severity) was generated for WMI starting a system process it normally doesn't start.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10698.png", "ScreenshotCaption": "wmi spawning powershell"}]}, {"DetectionNote": "Telemetry showed WmiPrvSE executing powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10515.png", "ScreenshotCaption": "wmiprvse executing powershell"}]}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:COMPUTERNAME.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10062.png", "ScreenshotCaption": "invoke-discovery"}]}]}, {"SubStep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing\u200b Gwmi Win32_OperatingSystem", "Detections": [{"DetectionNote": "A Technique alert detection for \"wmi-enumerating-os\" was generated due to a WMI query for OS version.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-17678.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Gwmi Win32_OperatingSystem", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10061.png", "ScreenshotCaption": "wmi stuff (thp firewall, antivirus, os)"}]}]}, {"SubStep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11306.png", "ScreenshotCaption": "MSSP - enumeration - bios, pnpentity, computer system, process"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10234.png", "ScreenshotCaption": "11a3-8 - thp - wmi stuff"}]}]}, {"SubStep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell calling the GetComputerNameEx API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11312.png", "ScreenshotCaption": "MSSP - 13a/b/c/d - function imports "}, {"ScreenshotName": "F-Secure-APT29-11302.png", "ScreenshotCaption": "MSSP - day2 executive summary pt1"}]}, {"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10303.png", "ScreenshotCaption": "API calls"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scanton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Detections": [{"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10124.png", "ScreenshotCaption": "135 port for SMB "}]}]}]}, {"TechniqueId": "T1047", "TechniqueName": "Windows Management Instrumentation", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) for Windows Management Instrumentation was generated due to WMI starting a system process it normally doesn\u2019t start.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10342.png", "ScreenshotCaption": "wmi doest start a process it normally starts"}]}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-17370.png", "ScreenshotCaption": ""}]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A General alert detection (high severity) was generated due to powershell.exe running with parameters associated with post exploitation payloads.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14966.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "An MSSP detection occurred for User DMEVALS\\pam launching a command prompt from which the sdclt.exe program was used. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11267.png", "ScreenshotCaption": "MSSP - bypass uac "}]}, {"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-17347.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A General alert detection (high severity) was generated due to powershell.exe running with parameters associated with post exploitation payloads.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-15071.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of executed function \"bypass.\"", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11302.png", "ScreenshotCaption": "MSSP - day2 executive summary pt1"}, {"ScreenshotName": "F-Secure-APT29-11313.png", "ScreenshotCaption": "MSSP - raw function"}]}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (indicated by the true \"elev\" flag).", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10317.png", "ScreenshotCaption": "true elevated tag "}]}]}]}, {"TechniqueId": "T1027", "TechniqueName": "Obfuscated Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within\u00a0monkey.png", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of a PowerShell script contained within monkey.png.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-14335.png", "ScreenshotCaption": ""}, {"ScreenshotName": "F-Secure-APT29-11300.png", "ScreenshotCaption": "MSSP - executive overview (lots of steps alert) pt1"}]}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10021.png", "ScreenshotCaption": "script within monkey.png"}, {"ScreenshotName": "F-Secure-APT29-10022.png", "ScreenshotCaption": "new-object moneky.png andthen the script above it "}]}]}, {"SubStep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell Set-WmiInstance to write encoded content to Win32_AuditCode.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11314.png", "ScreenshotCaption": "MSSP - wc function - no context"}, {"ScreenshotName": "F-Secure-APT29-13276.png", "ScreenshotCaption": "MSSP Summary"}]}, {"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10359.png", "ScreenshotCaption": "wmiaudit code"}]}]}, {"SubStep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell appending the GIF file header to the compressed file.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11320.png", "ScreenshotCaption": "MSSP - move to B- copy-item"}, {"ScreenshotName": "F-Secure-APT29-11303.png", "ScreenshotCaption": "MSSP - day2 executive summary - pt2"}]}, {"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10453.png", "ScreenshotCaption": "set-content"}]}]}]}, {"TechniqueId": "T1065", "TechniqueName": "Uncommonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of cod.3aka3.scr connecting to 192.168.0.5 on port 1234.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11250.png", "ScreenshotCaption": "MSSP - a2/3 - rtlo and network connection "}]}, {"DetectionNote": "Telemetry showed a network connection to 192.168.0.5 over port 1234.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-9993.png", "ScreenshotCaption": "1234 port"}]}]}]}, {"TechniqueId": "T1120", "TechniqueName": "Peripheral Device Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_PnPEntity.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11306.png", "ScreenshotCaption": "MSSP - enumeration - bios, pnpentity, computer system, process"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10234.png", "ScreenshotCaption": "11a3-8 - thp - wmi stuff"}]}]}]}, {"TechniqueId": "T1119", "TechniqueName": "Automated Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the Childitem. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11254.png", "ScreenshotCaption": "MSSP - get-childitem and compress archive scriptblock"}]}, {"DetectionNote": "Telemetry showed the execution of the ChildItem. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10008.png", "ScreenshotCaption": "command start for childitem"}]}]}, {"SubStep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing ChildItem to search the file system.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-11293.png", "ScreenshotCaption": "MSSP - raw command - childitem"}, {"ScreenshotName": "F-Secure-APT29-14494.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "F-Secure-APT29-10140.png", "ScreenshotCaption": "CommandStart ChildItem"}]}]}]}]}