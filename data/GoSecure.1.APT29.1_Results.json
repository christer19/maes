{"PublicRelease": "\u00a92020 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-03607-4", "Techniques": [{"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process \u200bOR the original filename (cod.3aka.scr)", "Detections": [{"DetectionNote": "An MSSP detection for Masqurading contained evidence that showed the original file name cod.3aka3.scr.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12697.png"}]}, {"DetectionNote": "Telemetry showed the original filename cod.3aka.scr.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10819.png"}, {"ScreenshotName": "GoSecure-APT29-10813.png"}]}]}, {"SubStep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesschk.exe is not the legitimate Sysinternals tool", "Detections": [{"DetectionNote": "Telemetry showed hash of accesschk.exe which can be used to verify it is not the legitimate Sysinternals tool.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10956.png"}]}]}]}, {"TechniqueId": "T1028", "TechniqueName": "Windows Remote Management", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection (orange indicator) called Windows Remote Management was generated due to the connection to Scranton (10.0.1.4) over TCP port 5985.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11013.png"}]}, {"DetectionNote": "Telemetry showed HTTP connections to remote host Scranton (10.0.1.4) over TCP port 5985.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11010.png"}]}]}, {"SubStep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Detections": [{"DetectionNote": "A Technique detection called \"Windows Remote Management wsman in HTTP Request\" was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The event was correlated to a parent detection on \"PowerShell with Execution Bypass Command Launched.\"\n", "DetectionType": "Technique", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11424.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.  The event was correlated to a parent detection on \"PowerShell with Execution Bypass Command Launched.\"", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11424.png"}]}]}, {"SubStep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection (orange indicator) called \"Windows Remote Management\"  was generated for PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.\n", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11550.png"}]}, {"DetectionNote": "A Tactic alert detection (orange indicator) called \"Powershell: established network connections\" was generated for PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11550.png"}]}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11550.png"}]}]}]}, {"TechniqueId": "T1097", "TechniqueName": "Pass the Ticket", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Detections": [{"DetectionNote": "An MSSP detection occurred for evidence of pass the ticket.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12734.png"}, {"ScreenshotName": "GoSecure-APT29-12733.png"}, {"ScreenshotName": "GoSecure-APT29-12735.png"}]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe\u00a0spawning from the rcs.3aka3.doc\u200b process", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Command-Line Interface\" was generated due to cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert for rcs.3aka3.doc spawning explorer.exe.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10820.png"}]}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc spawning from cmd.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10827.png"}]}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.A.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe\u00a0executing\u200b Get-WmiObject ...\u200b -Class\u00a0AntiVirusProduct", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}]}]}, {"SubStep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe\u00a0executing Get-WmiObject\u00a0...\u200b\u200b -Class\u00a0FireWallProduct", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}]}]}, {"SubStep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of security software discovery attempts. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12744.png"}]}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Detections": [{"DetectionNote": "Telemetry showed accesschk.exe copying Chrome's credential database file. The event was correlated to a parent detection on \"Bypass User Account Control\".", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10942.png"}, {"ScreenshotName": "GoSecure-APT29-11680.png"}]}]}]}, {"TechniqueId": "T1099", "TechniqueName": "Timestomp", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Detections": [{"DetectionNote": "An MSSP detection occurred for evidence of file timestamp manipulation.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12736.png"}]}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby ", "Detections": [{"DetectionNote": "A Technique alert detection (orange indicator) called \"Create Account (Net Use Command)\" was generated for net.exe with the command-line arguments to add the new user Toby.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11551.png"}]}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11551.png"}]}]}]}, {"TechniqueId": "T1140", "TechniqueName": "Deobfuscate/Decode Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Detections": [{"DetectionNote": "Telemetry showed PowerShell writing the files that were decompressed from the ZIP.  The event was correlated to a parent detection on \"Bypass User Account Control\".", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10888.png"}, {"ScreenshotName": "GoSecure-APT29-10885.png"}]}]}, {"SubStep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Deobfuscate/Decode Files or Information (Certutil executed with suspicious commands)\" was generated for certutil decoding the payload with command-line arguments.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11330.png"}]}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11332.png"}, {"ScreenshotName": "GoSecure-APT29-11330.png"}]}]}, {"SubStep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1114", "TechniqueName": "Email Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Email Collection\" was generated due to PowerShell copying the HTML file. The event was correlated to a parent detection on \"Bypass User Account Control.\"", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11453.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of email collection.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12730.png"}]}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11445.png"}]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.4", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.14", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}]}]}, {"SubStep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell executing a gwmi query for Win32_Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12709.png"}]}]}, {"SubStep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing evidence of API execution was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10981.png"}]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Detections": [{"DetectionNote": "A Technique alert detection (orange indicator) called \"Registry Run Keys or Startup Folder\" was generated due to the creation of hostui.lnk in the Startup folder.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10937.png"}]}, {"DetectionNote": "Telemetry showed the creation of hostui.lnk in the Startup folder.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10937.png"}]}]}, {"SubStep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11100.png"}]}]}, {"SubStep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Detections": [{"DetectionNote": "A Technique alert detection (green indicator) called \"Registry Run Keys / Startup Folder\" was generated due to Run key persistence added into the Registry", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11331.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11331.png"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scanton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Detections": [{"DetectionNote": "A Technique detection called \"Windows Admin Shares\" was generated due to access of a remote admin share.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11052.png"}, {"ScreenshotName": "GoSecure-APT29-11057.png"}]}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11057.png"}]}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) was generated due to the use of SDelete to delete rcs.3aka3.doc.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10890.png"}, {"ScreenshotName": "GoSecure-APT29-10892.png"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The event was correlated to a parent detection on \"Bypass User Account Control\".", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10890.png"}, {"ScreenshotName": "GoSecure-APT29-10892.png"}]}]}, {"SubStep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) was generated due to the use of SDelete to delete rcs.3aka3.doc.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10892.png"}, {"ScreenshotName": "GoSecure-APT29-10893.png"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The event was correlated to a parent detection on \"Bypass User Account Control\".", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10892.png"}, {"ScreenshotName": "GoSecure-APT29-10893.png"}]}]}, {"SubStep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) was generated due to the use of SDelete to delete SysinternalsSuite.zip.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10892.png"}, {"ScreenshotName": "GoSecure-APT29-10894.png"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The event was correlated to a parent detection on \"Bypass User Account Control\".", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10894.png"}, {"ScreenshotName": "GoSecure-APT29-10892.png"}]}]}, {"SubStep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Detections": [{"DetectionNote": "A Technnique alert detection (red indicator) called \"Sdelete Tool Ran\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11090.png"}, {"ScreenshotName": "GoSecure-APT29-11089.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of the deletion of Rar.exe by SDelete.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12703.png"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The event was correlated to parent alert on New Windows Service Created.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11089.png"}, {"ScreenshotName": "GoSecure-APT29-11090.png"}]}]}, {"SubStep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Detections": [{"DetectionNote": "A Technnique alert detection (red indicator) called \"Sdelete Tool Ran\" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11092.png"}, {"ScreenshotName": "GoSecure-APT29-11089.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of the deletion of working.zip by SDelete.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12703.png"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The event was correlated to parent alert on New Windows Service Created.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11089.png"}, {"ScreenshotName": "GoSecure-APT29-11092.png"}]}]}, {"SubStep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Detections": [{"DetectionNote": "A Technnique alert detection (red indicator) called \"Sdelete Tool Ran\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11092.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of the deletion of working.zip by SDelete.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12703.png"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The event was correlated to parent alert on New Windows Service Created.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11092.png"}]}]}, {"SubStep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe deleting sdelete64.exe and file deletion event. The event was correlated to parent alert on New Windows Service Created.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11094.png"}]}]}, {"SubStep": "19.A.1", "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\System32\\m.exe", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.1", "Procedure": "Deleted exfiltrated data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration.tmp", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.1", "Procedure": "Deleted staged data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Detections": [{"DetectionNote": "A Technique alert detection (green indicator) called New Service was generated due to the creation of the javamtsup service. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10920.png"}]}, {"DetectionNote": "Telemetry showed a registry event and service creation of javamtsup.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10920.png"}]}]}]}, {"TechniqueId": "T1005", "TechniqueName": "Data from Local System", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "A Tactic detection for \"T1119 Possible Data Collection (file reads)\" was generated on file reads of C:\\Users\\Pam\\*.", "DetectionType": "Tactic", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11673.png"}], "Footnotes": ["Configuration changed to monitor Pam's user directory."]}, {"DetectionNote": "Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11673.png"}], "Footnotes": ["Configuration changed to monitor Pam's user directory."]}]}, {"SubStep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Detections": [{"DetectionNote": "Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11698.png"}], "Footnotes": ["Configuration changed to monitor Pam's user directory."]}]}, {"SubStep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "A Tactic detection for \"T1119 Possible Data Collection (file reads)\" was generated on file reads of C:\\Users\\Pam\\*.", "DetectionType": "Tactic", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11699.png"}], "Footnotes": ["Configuration changed to monitor Pam's user directory."]}, {"DetectionNote": "Telemetry showed file reads by powershell.exe in Pam's user directory. The event was correlated to parent alert on New Windows Service Created.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11699.png"}], "Footnotes": ["Configuration changed to monitor Pam's user directory."]}]}, {"SubStep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1084", "TechniqueName": "Windows Management Instrumentation Event Subscription", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Detections": [{"DetectionNote": "An MSSP detection occurred for WMI event subscription being used for a persistence mechanism. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12716.png"}]}]}, {"SubStep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetGroups\u00a0API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17440.png"}]}]}, {"SubStep": "4.C.11", "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetLocalGroups\u00a0API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17440.png"}]}]}]}, {"TechniqueId": "T1106", "TechniqueName": "Execution through API", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17440.png"}]}]}, {"SubStep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17440.png"}]}]}, {"SubStep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Detections": [{"DetectionNote": "A Technique alert detection (green indicator) called \"Execution through API (DLL Load)\" was generated for PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The event was correlated to a parent detection on \"PowerShell with Encoded Command Launched.\"", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11672.png"}], "Footnotes": ["Configuration changed to add monitoring of specific API. "]}, {"DetectionNote": "An MSSP detection contained evidence of the load of the ConvertSidToStringSid API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12725.png"}, {"ScreenshotName": "GoSecure-APT29-12726.png"}]}, {"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The event was correlated to a parent detection on \"PowerShell with Encoded Command Launched.\"", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11672.png"}], "Footnotes": ["Configuration changed to add monitoring of specific API. "]}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of rcs.3aka3.doc creating the monkey.png.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12705.png"}]}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10829.png"}]}]}, {"SubStep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "A General detection was generated for \"File archive created\" due to PowerShell creating a compressed archive. The event is correlated to a parent alert on Bypass User Account Control.", "DetectionType": "General", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10875.png"}]}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The event is correlated to a parent alert on Bypass User Account Control.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10875.png"}]}]}, {"SubStep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Detections": [{"DetectionNote": "A General alert detection (skull indicator) called \"hiddenShare.admin\" was generated due to the file creation of python.exe in an admin share.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11038.png"}]}, {"DetectionNote": "Telemetry showed a file create event of python.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11038.png"}, {"ScreenshotName": "GoSecure-APT29-11034.png"}, {"ScreenshotName": "GoSecure-APT29-11035.png"}]}]}, {"SubStep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file rar.exe", "Detections": [{"DetectionNote": "Telemetry showed a file create event for python.exe creating rar.exe downloaded from 192.164.0.4 port 8443.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11066.png"}]}]}, {"SubStep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file sdelete64.exe", "Detections": [{"DetectionNote": "Telemetry showed File Create event for python.exe creating sdelete64.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11070.png"}]}]}, {"SubStep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the creation of m.exe in the System32 folder.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12714.png"}, {"ScreenshotName": "GoSecure-APT29-12715.png"}]}, {"DetectionNote": "Telemetry showed the file create event for m.exe into the System32 folder. The event was correlated to a parent detection on \"PowerShell with Encoded Command Launched.\"", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11399.png"}]}]}, {"SubStep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Detections": [{"DetectionNote": "A General alert detection (red indicator) for a malicious file was generated for the file create of m.exe in the System32 directory by wsmprovhost.exe.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11427.png"}]}, {"DetectionNote": "Telemetry showed the file create of m.exe in the System32 directory by wsmprovhost.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11425.png"}]}]}]}, {"TechniqueId": "T1086", "TechniqueName": "PowerShell", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u00a0spawning from cmd.exe", "Detections": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"PowerShell process created\" was generated due to powershell.exe spawning from cmd.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10816.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The telemetry was correlated to a parent alert for rcs.3aka3.doc spawning cmd.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10820.png"}]}]}, {"SubStep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"PowerShell\" was generated due to powershell.exe spawning a new powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10877.png"}]}, {"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The event was correlated to a parent detection on \"Bypass User Account Control\".", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10887.png"}]}]}, {"SubStep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u200b spawning from python.exe", "Detections": [{"DetectionNote": "A Technique alert detection (yellow indicator) called PowerShell was generated due to python.exe spawning powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11078.png"}]}, {"DetectionNote": "Telemetry showed python.exe executing powershell.exe. The event was correlated to a parent detection on \"Bypass User Account Control\".", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11078.png"}]}]}, {"SubStep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"PowerShell with Invoke Expression Launched\" was generated due to the PowerShell stager executing (IEX) from schemas. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17445.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17445.png"}]}]}, {"SubStep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1122", "TechniqueName": "Component Object Model Hijacking", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of\u00a0the DelegateExecute\u00a0\u200bsubkey in\u00a0\u200bHKCU\\Software\\Classes\\Folder\\shell\\open\\\u200b\u200bcommand\u200b\u200b", "Detections": [{"DetectionNote": "An MSSP detection for Component Object Model Hijacking contained evidence of the DelegateExecute subkey added to the Registry.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12702.png"}]}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11677.png"}]}]}, {"SubStep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Detections": [{"DetectionNote": "A Tactic alert detection (green indicator) called \"T1088: User Account Control Bypass (\\Folder\\shell\\open\\command registry key)\" was generated for the setting of a Registry key used by User Account Control (UAC).", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11392.png"}]}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11392.png"}]}]}]}, {"TechniqueId": "T1045", "TechniqueName": "Software Packing", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}]}]}, {"SubStep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing\u200b Gwmi Win32_OperatingSystem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}]}]}, {"SubStep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1112", "TechniqueName": "Modify Registry", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Detections": [{"DetectionNote": "Telemetry showed the deletion of the command subkey.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10862.png"}]}]}, {"SubStep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command\u00a0subkey", "Detections": [{"DetectionNote": "A Technique detection called \"Registry key deleted\" was generated due to the deletion of the Registry value. ", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11397.png"}]}, {"DetectionNote": "Telemetry showed the deletion of the Registry value.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11397.png"}]}]}]}, {"TechniqueId": "T1102", "TechniqueName": "Web Service", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Detections": [{"DetectionNote": "A General alert detection (orange indicator) was generated for an outbound connection network operation over a commonly used port. The event was correlated to a parent detection on \"Bypass User Account Control.\"", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11487.png"}]}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The event was correlated to a parent detection on \"Bypass User Account Control.\"", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11487.png"}, {"ScreenshotName": "GoSecure-APT29-11472.png"}]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing evidence of compress-7zip execution with password was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11003.png"}]}]}, {"SubStep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Detections": [{"DetectionNote": "A Technique detection called \"T1022 Data Encrypted\" was generated when rar.exe created working.zip.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11082.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The event was correlated to parent alert on New Windows Service Created.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11083.png"}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Detections": [{"DetectionNote": "An MSSP detection occurred for rundll32.exe executing kxwn.lock.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12737.png"}]}]}]}, {"TechniqueId": "T1497", "TechniqueName": "Virtualization/Sandbox Evasion", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11022.png"}]}]}, {"SubStep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Detections": [{"DetectionNote": "An MSSP detection occurred for suspicious activity indicative of remote discovery attempts. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12721.png"}]}, {"DetectionNote": "Telemetry showed PowerShell making a network connection over port 389 to the domain controller NewYork (10.0.0.4). The event was correlated to a parent detection on \"PowerShell with Execution Bypass Command Launched.\"", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11406.png"}]}]}]}, {"TechniqueId": "T1027", "TechniqueName": "Obfuscated Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within\u00a0monkey.png", "Detections": [{"DetectionNote": "An MSSP detection for Obfuscated PowerShell occurred containing evidence of the PowerShell script contained within monkey.png.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12705.png"}]}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10851.png"}]}]}, {"SubStep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell executing Set-WmiInstance to write encoded content to Win32_AuditCode.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12715.png"}, {"ScreenshotName": "GoSecure-APT29-12714.png"}]}]}, {"SubStep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though file was manually pulled to show the GIF89 header, it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11461.png"}]}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of powershell.exe executing ChildItem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12745.png"}]}]}, {"SubStep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing\u00a0$env:TEMP", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}]}]}, {"SubStep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav\u00a0network share (192.168.0.4:80)", "Detections": [{"DetectionNote": "Telemetry showed PoweShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4).", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10997.png"}]}]}, {"SubStep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Detections": [{"DetectionNote": "Telemetry showed the creation of the exfiltrated data within the mapped OneDrive directory. The event was correlated to a parent detection for \"Bypass User Account Control.\"", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11477.png"}]}]}]}, {"TechniqueId": "T1120", "TechniqueName": "Peripheral Device Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}]}]}, {"SubStep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the execution of PowerShell calling the NetWkstaGetInfo API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12713.png"}, {"ScreenshotName": "GoSecure-APT29-12712.png"}]}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}]}]}, {"SubStep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.\n", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the execution of the GetUserNameEx API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12713.png"}, {"ScreenshotName": "GoSecure-APT29-12712.png"}]}]}, {"SubStep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the execution of the ConvertSidToStringSid API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12726.png"}, {"ScreenshotName": "GoSecure-APT29-12725.png"}]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Bypass User Account Control\" was generated due to PowerShell spawning from control.exe. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10841.png"}]}, {"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10841.png"}]}]}, {"SubStep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A Technique alert detection (green indicator) called \"User Account Control Bypass\" was generated due to the PowerShell callback spawned from control.exe. The event was correlated to a parent General detection for a suspicious process", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11392.png"}, {"ScreenshotName": "GoSecure-APT29-11396.png"}, {"ScreenshotName": "GoSecure-APT29-11394.png"}]}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). The event was correlated to a parent General detection for a suspicious process", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11396.png"}]}]}]}, {"TechniqueId": "T1096", "TechniqueName": "NTFS File Attributes", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"NTFS File Attributes\" was generated due to PowerShell executing the schemas ADS.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17445.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17445.png"}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam", "Criteria": "Successful logon as user Pam on\u00a0Scranton (10.0.1.4) ", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of Pam successfully logging on to Scranton (10.0.1.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12747.png"}]}]}, {"SubStep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4) ", "Detections": [{"DetectionNote": "An MSSP detection occurred for the successful logon on NewYork (10.0.0.4) as user mscott. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12729.png"}, {"ScreenshotName": "GoSecure-APT29-12728.png"}, {"ScreenshotName": "GoSecure-APT29-12727.png"}]}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Detections": [{"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10819.png"}, {"ScreenshotName": "GoSecure-APT29-10812.png"}]}]}, {"SubStep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Detections": [{"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17445.png"}]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over TCP port 1234).", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11676.png"}]}]}, {"SubStep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe\u00a0reading the file working.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of python.exe reading working.zip with established network connection to TCP port 8443.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12704.png"}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "A Technique alert detection (orange indicator) called Commonly Used Port was generated due to powershell.exe connecting to 192.168.0.5 on TCP port 443. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10849.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443. The event is correlated to a parent alert on PowerShell Invoke Expression Launched.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10848.png"}]}]}, {"SubStep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "A Technique alert detection (orange indicator) called \"Commonly Used Port (Outbound connection established)\" was generated due to PowerShell making network connection to C2 (192.168.0.4) over TCP port 443.\n", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11333.png"}]}, {"DetectionNote": "A General alert detection (orange indicator) called \"Powershell: established network connections\" was generated due to PowerShell making network connection to C2 (192.168.0.4) over TCP port 443.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11333.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11333.png"}]}]}]}, {"TechniqueId": "T1047", "TechniqueName": "Windows Management Instrumentation", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Detections": [{"DetectionNote": "Telemetry showed wmiprvse.exe executing powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11398.png"}]}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the creation of Draft.Zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12745.png"}]}, {"DetectionNote": "Telemetry showed the creation of Draft.Zip.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10822.png"}]}]}, {"SubStep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Detections": [{"DetectionNote": "Telemetry showed a File Create event for powershell.exe creating working.zip.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11081.png"}]}]}, {"SubStep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "A General alert detection (yellow indicator) called \"Email Collection (email file copy)\" was generated for the file copy MITRE-ATTACK-EVALS.HTML. The event was correlated to a parent detection on \"Bypass User Account Control.\"", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11453.png"}]}, {"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The event was correlated to a parent detection on \"Bypass User Account Control.\"", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11453.png"}]}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Detections": [{"DetectionNote": "A Technique detection called Screen Capture was generated due to the load of System.Drawing.dll.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11697.png"}], "Footnotes": ["Configuration changed to look for System.Drawing.dll loads."]}, {"DetectionNote": "Telemetry showed powershell.exe loading the System.Drawing.dll.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11697.png"}], "Footnotes": ["Configuration changed to look for System.Drawing.dll loads."]}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesschk.exe executing the CryptUnprotectedData API", "Detections": [{"DetectionNote": "An MSSP detection for \"Credential Dumping\" contained evidence of accesschk.exe dumping credentials.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12696.png"}, {"ScreenshotName": "GoSecure-APT29-12695.png"}]}]}, {"SubStep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe\u00a0reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Detections": [{"DetectionNote": "A Technique detection called \"Credential Theft\" was generated due to lsass.exe reading SAM Registry keys.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11695.png"}], "Footnotes": ["Lsass.exe Registry read event exclusion was removed from the configuration. The exclusion is in place because it's noisy."]}, {"DetectionNote": "Telemetry showed lsass.exe reading SAM Registry keys.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11696.png"}], "Footnotes": ["Lsass.exe Registry read event exclusion was removed from the configuration. The exclusion is in place because it's noisy."]}]}, {"SubStep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated for a \"Malicious file executed\" for the execution of m.exe.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11402.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of the execution of m.exe with Mimikatz arguments.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12714.png"}, {"ScreenshotName": "GoSecure-APT29-12715.png"}]}]}, {"SubStep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A General alert detection (red indicator) called \"Malicious File Executed\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11430.png"}]}, {"DetectionNote": "A General alert detection (red indicator) called \"Remote Process Compromise\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11432.png"}]}]}]}, {"TechniqueId": "T1065", "TechniqueName": "Uncommonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Detections": [{"DetectionNote": "A Technique detection called \"T1043: Commonly Used Port\" showed rcs.3aka3.doc connecting to 192.168.0.5 on TCP port 1234. ", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10814.png"}]}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc connecting to 192.168.0.5 on TCP port 1234.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10814.png"}, {"ScreenshotName": "GoSecure-APT29-10813.png"}]}]}]}, {"TechniqueId": "T1119", "TechniqueName": "Automated Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of powershell.exe executing ChildItem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12745.png"}]}]}, {"SubStep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Detections": [{"DetectionNote": "A Tactic detection was generated due to PsExec tool detected process created labeled \"Lateral Movement with Remote Execution.\" The event was correlated to a parent detection for \"Bypass User Account Control\".", "DetectionType": "Tactic", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11052.png"}]}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe. The event was correlated to a parent General detection for a suspicious process.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11052.png"}, {"ScreenshotName": "GoSecure-APT29-11049.png"}]}]}, {"SubStep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing\u00a0Compress-Archive", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of powershell.exe compressing via Compress-Archive.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12745.png"}]}]}, {"SubStep": "7.B.2", "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Detections": [{"DetectionNote": "A Technique alert detection for Data Compressed was generated due to the file creation event for OfficeSupplies.7z. ", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10997.png"}]}, {"DetectionNote": "Telemetry showed the file creation event for OfficeSupplies.7z. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10997.png"}]}]}, {"SubStep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Detections": [{"DetectionNote": "A Technique detection called \"T1002 Data Compressed\" was generated when rar.exe created working.zip.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11082.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The event was correlated to parent alert on New Windows Service Created.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11083.png"}]}]}, {"SubStep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1145", "TechniqueName": "Private Keys", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Detections": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"T1145: Private Keys\" was generated due to a file create event for the $RandomFileName.pfx file by powershell.exe. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10961.png"}]}, {"DetectionNote": "Telemetry showed a file creation event for the $RandomFileName.pfx file by powershell.exe. The event was correlated to a parent detection on \"Bypass User Account Control\".", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10961.png"}]}]}]}]}