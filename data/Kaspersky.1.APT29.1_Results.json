{"PublicRelease": "\u00a92020 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-03607-4", "Techniques": [{"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection (yellow, medium severity) called Rundll32 Execution was generated due to rundll32.exe executing kxwn.lock. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3355.png", "ScreenshotCaption": "20.a.1 - rundll32 exec kxwn.lock"}]}, {"DetectionNote": "An MSSP detection contained evidence of rundll32.exe executing kxwn.lock.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12421.png", "ScreenshotCaption": "20.a.1 MSSP report"}]}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3355.png", "ScreenshotCaption": "20.a.1 - rundll32 exec kxwn.lock"}]}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Detections": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png. The event was correlated to a parent detection for masquerading. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2681.png", "ScreenshotCaption": "3.A.1"}]}]}, {"SubStep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the file write of the ZIP by PowerShell. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-11776.png", "ScreenshotCaption": "MSSP Report Page 2 - Step 4"}, {"ScreenshotName": "Kaspersky-APT29-11777.png", "ScreenshotCaption": "MSSP Report Page 3 - Step 4"}]}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for suspicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2729.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of remote file copy of python.exe to Scranton (10.0.1.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18002.png", "ScreenshotCaption": "new mssp 8b1"}]}]}, {"SubStep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file rar.exe", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the creation of rar.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18005.png", "ScreenshotCaption": "new mssp 9a1 - remote file copy"}]}, {"DetectionNote": "Telemetry showed a file create event for python.exe creating rar.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-13798.png", "ScreenshotCaption": "9a1 - vendor better pic"}]}]}, {"SubStep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file sdelete64.exe", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the creation of sdelete64.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18006.png", "ScreenshotCaption": "new mssp 9a2 sdelete create"}]}, {"DetectionNote": "Telemetry showed a file create event for python.exe creating sdelete64.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2917.png", "ScreenshotCaption": "9.a.2 - python.exe creating sdelete64.exe"}]}]}, {"SubStep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Detections": [{"DetectionNote": "Telemetry showed the file create event for m.exe into the System32 folder.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3227.png", "ScreenshotCaption": ""}, {"ScreenshotName": "Kaspersky-APT29-3225.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the write of m.exe to the System32 directory by wsmprovhost.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12409.png", "ScreenshotCaption": "16.d.1-2 MSSP report"}]}, {"DetectionNote": "Telemetry showed the creation of m.exe in the System32 directory by wsmprovhost.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3263.png", "ScreenshotCaption": "16.d.1 - details"}, {"ScreenshotName": "Kaspersky-APT29-3261.png", "ScreenshotCaption": ""}]}]}]}, {"TechniqueId": "T1112", "TechniqueName": "Modify Registry", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command\u00a0subkey", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1086", "TechniqueName": "PowerShell", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u00a0spawning from cmd.exe", "Detections": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called PowerShell was generated due to the execution of powershell.exe by cmd.exe. The alert was correlated to a parent alert for command line execution.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2637.png", "ScreenshotCaption": "1.b.2 ps launced"}]}, {"DetectionNote": "An MSSP detection contained evidence of cmd.exe spawning powershell.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-11767.png", "ScreenshotCaption": "MSSP Report Page 4 - Step 1"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2637.png", "ScreenshotCaption": "1.b.2 ps launced"}]}]}, {"SubStep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called \"PowerShell\" was generated due to powershell.exe spawning a new powershell.exe. The detection  was correlated to a parent alert for suspicious PowerShell.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-13797.png", "ScreenshotCaption": "4a2 - vendor provided pic"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe spawning from powershell.exe and indicated the new PowerShell process was a meterpreter shell.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-11778.png", "ScreenshotCaption": "MSSP Report Page 4 - Step 4"}, {"ScreenshotName": "Kaspersky-APT29-11777.png", "ScreenshotCaption": "MSSP Report Page 3 - Step 4"}]}, {"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection  was correlated to a parent alert for suspicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2735.png", "ScreenshotCaption": "4.a.2 - ps launches ps"}]}]}, {"SubStep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u200b spawning from python.exe", "Detections": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called \"T1086_PowerShell\" was generated due to python.exe spawning powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2926.png", "ScreenshotCaption": "Medium level alert on powershell"}]}, {"DetectionNote": "An MSSP detection contained evidence of python spawning powershell.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18007.png", "ScreenshotCaption": "new mssp 9B1 and 9B5"}]}, {"DetectionNote": "Telemetry showed python.exe executing powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2926.png", "ScreenshotCaption": "Medium level alert on powershell"}]}]}, {"SubStep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Detections": [{"DetectionNote": "A Technique alert detection (yellow indicator) for \"PowerShell\" was generated for powershell.exe spawned from a PowerShell stager. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-13810.png", "ScreenshotCaption": "11a12 - vendor pic PS tag - technique"}, {"ScreenshotName": "Kaspersky-APT29-13802.png", "ScreenshotCaption": "11a12 - vendor pic PS tag - technique"}]}, {"DetectionNote": "A General alert detection (high severity) called \"PDM:Exploit.Win32.Generic\" was generated for a potential threat.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3155.png", "ScreenshotCaption": "11.a.12 - exec of schemas ads would be blocked"}]}, {"DetectionNote": "An MSSP detection contained evidence of PowerShell executing from schemas ADS.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18014.png", "ScreenshotCaption": "new mssp 11a12"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-13802.png", "ScreenshotCaption": "11a12 - vendor pic PS tag - technique"}, {"ScreenshotName": "Kaspersky-APT29-13810.png", "ScreenshotCaption": "11a12 - vendor pic PS tag - technique"}]}]}, {"SubStep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (red; high severity) called PowerShell was generated due to powershell executing a SYSTEM-level powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3363.png", "ScreenshotCaption": "2nd ps with SYSTEM user"}]}, {"DetectionNote": "An MSSP detection contained evidence of PowerShell spawned from a WMI event subscription.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18022.png", "ScreenshotCaption": "new mssp 20A3"}]}, {"DetectionNote": "Telemetry showed execution of SYSTEM level PowerShell.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3363.png", "ScreenshotCaption": "2nd ps with SYSTEM user"}]}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the execution of psexecsvc.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-11796.png", "ScreenshotCaption": "MSSP Report Page 3 - Step 8"}]}, {"DetectionNote": "Telemetry showed PSEXESVC.exe with command-line arguments to execute python.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-13410.png", "ScreenshotCaption": "8C3 - vendor provided screenshot, use this"}]}]}, {"SubStep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of javamtsup.exe spawning from services.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12574.png", "ScreenshotCaption": "10.a.1 mssp report #2"}, {"ScreenshotName": "Kaspersky-APT29-12573.png", "ScreenshotCaption": "10.a.1 mssp report #1"}]}, {"DetectionNote": "Telemetry showed javamtsup.exe with parent process services.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2982.png", "ScreenshotCaption": ""}]}]}]}, {"TechniqueId": "T1102", "TechniqueName": "Web Service", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Detections": [{"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-13803.png", "ScreenshotCaption": "18a1 - telemetry - vendor pic"}]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2875.png", "ScreenshotCaption": "8.a.1 - connection to 10.0.0.4:389"}]}]}, {"SubStep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of System.DirectoryServices.ni.dll loaded into PowerShell, which can be used to execute LDAP queries.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18018.png", "ScreenshotCaption": "new mssp 16a1"}]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam", "Criteria": "Successful logon as user Pam on\u00a0Scranton (10.0.1.4) ", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of a valid logon on Scranton (10.0.1.4) as user Pam.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18003.png", "ScreenshotCaption": "new mssp 8C1"}]}, {"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2891.png", "ScreenshotCaption": "Seeing event 4624 in windows event log"}, {"ScreenshotName": "Kaspersky-APT29-13410.png", "ScreenshotCaption": "8C3 - vendor provided screenshot, use this"}]}]}, {"SubStep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4) ", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the successful logon of MScott on NewYork (10.0.0.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12408.png", "ScreenshotCaption": "16.c.1-2 MSSP report"}]}, {"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3246.png", "ScreenshotCaption": ""}]}]}]}, {"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process \u200bOR the original filename (cod.3aka.scr)", "Detections": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called Masquerading was generated due to altered file name by the RTLO character.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2631.png", "ScreenshotCaption": "Threat hunting views, \"medium alert\" for the technique, \"yellow means medium\""}]}, {"DetectionNote": "An MSSP detection contained evidence of \"Defense Evasion\" contained evidence of RTLO character in rcs.3aka.doc.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17986.png", "ScreenshotCaption": "new mssp 1a2"}]}, {"DetectionNote": "Telemetry showed the original filename\u200b cod.3aka.scr as well as the RTLO ASCII characters.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2631.png", "ScreenshotCaption": "Threat hunting views, \"medium alert\" for the technique, \"yellow means medium\""}]}]}, {"SubStep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesscheck.exe is not the legitimate Sysinternals tool", "Detections": [{"DetectionNote": "An MSSP detection contained evidence showing accesschk.exe is not the legitimate Sysinternals tool.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17997.png", "ScreenshotCaption": "new mssp 6a3"}]}, {"DetectionNote": "Telemetry showed hash of accesschk.exe which can be used to verify it is not the legitimate Sysinternals tool.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2804.png", "ScreenshotCaption": ""}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": [], "Footnotes": ["Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so a detection does not apply."]}]}, {"SubStep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the creation of hostui.lnk.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17996.png", "ScreenshotCaption": "new mssp 5b"}]}, {"DetectionNote": "Telemetry showed powershell.exe creating the hostui.lnk file in the Startup folder. The event was correlated to a parent General detection for suspicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2798.png", "ScreenshotCaption": "javamtsup added to registry in Services -> indicates service is created."}, {"ScreenshotName": "Kaspersky-APT29-2802.png", "ScreenshotCaption": "5.b.1 hostui.lnk file created"}]}]}, {"SubStep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Detections": [{"DetectionNote": "A Technique alert detection (yellow tag) called Registy Run Keys Startup Folder  was generated due to powershell.exe adding the Webcache subkey Run key persistence into the Registry. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3152.png", "ScreenshotCaption": ""}, {"ScreenshotName": "Kaspersky-APT29-3155.png", "ScreenshotCaption": "11.a.12 - exec of schemas ads would be blocked"}]}, {"DetectionNote": "An MSSP detection contained evidence of the Webcache subkey added to the Registry to establish persistence.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18013.png", "ScreenshotCaption": "new mssp 11a11"}]}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3155.png", "ScreenshotCaption": "11.a.12 - exec of schemas ads would be blocked"}, {"ScreenshotName": "Kaspersky-APT29-3117.png", "ScreenshotCaption": ""}]}]}]}, {"TechniqueId": "T1045", "TechniqueName": "Software Packing", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2887.png", "ScreenshotCaption": "8.b.2 - file hex dump shows upx (host interrogation)"}]}]}]}, {"TechniqueId": "T1122", "TechniqueName": "Component Object Model Hijacking", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of\u00a0the DelegateExecute\u00a0\u200bsubkey in\u00a0\u200bHKCU\\Software\\Classes\\Folder\\shell\\open\\\u200b\u200bcommand\u200b\u200b", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the addition of DelegateExecute value in the Registry.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17990.png", "ScreenshotCaption": "new mssp 3b1 "}]}]}, {"SubStep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Detections": [{"DetectionNote": "A MSSP detection occurred containing evidence for a well-known UAC bypass technique. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12397.png", "ScreenshotCaption": "14.a.1-3 MSSP report"}]}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Detections": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called \"User Execution\" was generated due to execution of rcs.3aka3.doc file by explorer.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2623.png", "ScreenshotCaption": "1.a.1 - explorer.exe executing payload"}]}, {"DetectionNote": "An MSSP detection contained evidence of \"User Execution\" due to execution of rcs.3aka3.doc by explorer.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17985.png", "ScreenshotCaption": "new MSSP 1a1"}]}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2623.png", "ScreenshotCaption": "1.a.1 - explorer.exe executing payload"}]}]}, {"SubStep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Detections": [{"DetectionNote": "A Technique alert detection (yellow tag) called \"User Execution\" was generated due to the execution of powershell.exe from explorer.exe. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3118.png", "ScreenshotCaption": "11.a.2 - ps exec schemas ads"}]}, {"DetectionNote": "Telemetry showed explorer.exe spawning powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-13802.png", "ScreenshotCaption": "11a12 - vendor pic PS tag - technique"}]}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the creation of the javamtsup service.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17995.png", "ScreenshotCaption": "new mssp 5a1"}]}, {"DetectionNote": "Telemetry showed a registry event for the creation of javamtsup service. The event was correlated to a parent General detection for suspicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2798.png", "ScreenshotCaption": "javamtsup added to registry in Services -> indicates service is created."}, {"ScreenshotName": "Kaspersky-APT29-2777.png", "ScreenshotCaption": "javamtsup.exe created - tree"}]}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell loading .Net assemblies to capture screenshots.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17998.png", "ScreenshotCaption": "new mssp 7a1"}]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe\u00a0spawning from the rcs.3aka3.doc\u200b process", "Detections": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called  \"Command Line Interface\" was generated due to cmd.exe spawning from rcs.3aka3.doc\u200b.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2636.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "An MSSP detection contained evidence of rcs.3aka3.doc\u200b spawning cmd.exe", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17987.png", "ScreenshotCaption": "new mssp 1b1"}]}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc spawning from cmd.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2636.png", "ScreenshotCaption": ""}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18010.png", "ScreenshotCaption": "new mssp 11a5-7"}]}]}, {"SubStep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell executing the NetWKstaGetInfo API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18016.png", "ScreenshotCaption": "new mssp 13B1"}]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2863.png", "ScreenshotCaption": "Pulled the powershell script off the end system"}]}]}, {"SubStep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Detections": [{"DetectionNote": "A Technique alert detection (green; low severity) called Data Encrypted was generated due to powershell.exe executing rar.exe with command-line arguments to encrypt working.zip. The event was correlated to a parent Technique detection on powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2931.png", "ScreenshotCaption": "9.b.5-7 - rar compressing files and encrypting with password"}]}, {"DetectionNote": "An MSSP detection contained evidence of execution of rar.exe with command line arguments to encrypt working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18008.png", "ScreenshotCaption": "new mssp 9b6 and 7"}]}]}]}, {"TechniqueId": "T1097", "TechniqueName": "Pass the Ticket", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of use of a suspicious Kerberos ticket.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3414.png", "ScreenshotCaption": "successful logon of mscott on scranton & new york with event type 13"}, {"ScreenshotName": "Kaspersky-APT29-3413.png", "ScreenshotCaption": "20.b.1 - kerberos ticket age alert"}]}]}]}, {"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "A Technique alert detection (red; high severity) called \"Commonly Used Port\" was generated due to powershell.exe connecting to 192.168.0.5 on TCP 443. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2717.png", "ScreenshotCaption": ""}, {"ScreenshotName": "Kaspersky-APT29-2717.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2717.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called Commonly Used Port was generated for powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3172.png", "ScreenshotCaption": "11.a.13 - connection to 192.168.0.4:443 - tree"}]}, {"DetectionNote": "An MSSP detection contained evidence of PowerShell establishing C2 with 192.168.0.4 over TCP port 443.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12385.png", "ScreenshotCaption": "11.a.13-5 MSSP report #2"}, {"ScreenshotName": "Kaspersky-APT29-18015.png", "ScreenshotCaption": "new mssp 11a13"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3166.png", "ScreenshotCaption": "11.a.13 - connection to 192.168.0.4:443"}]}]}]}, {"TechniqueId": "T1028", "TechniqueName": "Windows Remote Management", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A General alert detection (red; high severity) was generated for \"PowerShell with network activity\".", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2880.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2880.png", "ScreenshotCaption": ""}, {"ScreenshotName": "Kaspersky-APT29-2880.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Detections": [{"DetectionNote": "A General detection alert (red; high severity) for PowerShell with network activity was generated for to powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3256.png", "ScreenshotCaption": "16.c.1 - connection with full tree"}]}, {"DetectionNote": "An MSSP detection contained evidence of a WinRM connection on NewYork (10.0.0.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12408.png", "ScreenshotCaption": "16.c.1-2 MSSP report"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18093.png", "ScreenshotCaption": "16C2 - new vendor pic with port"}]}]}, {"SubStep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of a WinRM session to remote host SchruteFarms (10.0.1.7).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12428.png", "ScreenshotCaption": "20.b.2-3 MSSP report #1"}, {"ScreenshotName": "Kaspersky-APT29-12429.png", "ScreenshotCaption": "20.b.2-3 MSSP report #2"}]}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesscheck.exe executing the CryptUnprotectedData API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe\u00a0reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": [], "Footnotes": ["Unable to test because execution blocked by the vendor solution."]}]}, {"SubStep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection (red; high severity) called \"mimikatz_command_patterns\" was generated for m.exe executing with command-line arguments indicative of Mimikatz credential dumping.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3231.png", "ScreenshotCaption": "14.b.4 - m.exe with cmd line args"}]}, {"DetectionNote": "An MSSP detection contained evidence of Mimikatz dumping credentials.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12403.png", "ScreenshotCaption": "14.b.4 MSSP report"}]}]}, {"SubStep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection (red; high severity) for Credential Dumping was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3265.png", "ScreenshotCaption": "16.d.2 - both detections based on command pattern"}]}, {"DetectionNote": "An MSSP detection contained evidence of Mimikatz command-line arguments to dump credentials.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12409.png", "ScreenshotCaption": "16.d.1-2 MSSP report"}]}]}]}, {"TechniqueId": "T1497", "TechniqueName": "Virtualization/Sandbox Evasion", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_BIOS.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18009.png", "ScreenshotCaption": "new mssp 11a3 and 11a4"}]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.4", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": [], "Footnotes": ["Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so a detection does not apply."]}]}, {"SubStep": "11.A.14", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12385.png", "ScreenshotCaption": "11.a.13-5 MSSP report #2"}, {"ScreenshotName": "Kaspersky-APT29-12384.png", "ScreenshotCaption": "11.a.13-5 MSSP report #1"}]}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe\u00a0executing\u200b Get-WmiObject ...\u200b -Class\u00a0AntiVirusProduct", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe\u00a0executing Get-WmiObject\u00a0...\u200b\u200b -Class\u00a0FireWallProduct", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of a PowerShell gwmi query for AntiVirusProduct.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12389.png", "ScreenshotCaption": "12.b.1 MSSP report"}]}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetGroups\u00a0API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "4.C.11", "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetLocalGroups\u00a0API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1106", "TechniqueName": "Execution through API", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1005", "TechniqueName": "Data from Local System", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav\u00a0network share (192.168.0.4:80)", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of OfficeSupplies.7z being uploaded to 192.168.0.4 using WebDav.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-11792.png", "ScreenshotCaption": "MSSP Report Page 6 - Step 7"}]}, {"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2864.png", "ScreenshotCaption": "7.b.3 - pwd lolol"}]}]}, {"SubStep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesscheck.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1099", "TechniqueName": "Timestomp", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of timestomping of kxwn.lock.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12388.png", "ScreenshotCaption": "12.a.2 MSSP report"}]}]}]}, {"TechniqueId": "T1145", "TechniqueName": "Private Keys", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Detections": [{"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The event was correlated to a parent General detection for suspicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2821.png", "ScreenshotCaption": ""}]}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.A.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1096", "TechniqueName": "NTFS File Attributes", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Detections": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called NTFS File Attributes was generated due to execution of schemas ADS by powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3118.png", "ScreenshotCaption": "11.a.2 - ps exec schemas ads"}]}, {"DetectionNote": "An MSSP detection contained evidence of PowerShell executing schemas ADS via Get-Content and IEX.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12375.png", "ScreenshotCaption": "11.a.2 - MSSP report #4"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3118.png", "ScreenshotCaption": "11.a.2 - ps exec schemas ads"}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing\u00a0Compress-Archive", "Detections": [{"DetectionNote": "A Technique alert detection (green indicator; low severity) called Data Compressed was generated due to the creation of Draft.Zip by powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3419.png", "ScreenshotCaption": "2.a.5 - CC ps creates Draft.Zip - details"}], "Footnotes": ["Additional PowerShell logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}, {"DetectionNote": "An MSSP detection contained evidence of draft.zip being created and compressed by PowerShell. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17988.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "7.B.2", "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the file create of OfficeSupplies.7z.", "DetectionType": "MSSP", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18000.png", "ScreenshotCaption": "new mssp 7b2"}]}, {"DetectionNote": "Telemetry showed the file write event for OfficeSupplies.7z. The detection was correlated to a parent alert for suspicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2861.png", "ScreenshotCaption": "7.b.2 - officesupplies.7z file created"}]}]}, {"SubStep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Detections": [{"DetectionNote": "A Technique alert detection (green; low severity) called \"T1002_Data_Compressed\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2931.png", "ScreenshotCaption": "9.b.5-7 - rar compressing files and encrypting with password"}]}, {"DetectionNote": "An MSSP detection contained evidence of execution of rar.exe with command line arguments to compress working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18008.png", "ScreenshotCaption": "new mssp 9b6 and 7"}]}]}, {"SubStep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Detections": [{"DetectionNote": "An MSSP detection occurred contained evidence of data compression.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12412.png", "ScreenshotCaption": "17.c.1 - MSSP report"}]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe\u00a0reading the file working.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18011.png", "ScreenshotCaption": "new mssp 11a8"}]}]}, {"SubStep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing the CreateToolhelp32Snapshot API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18017.png", "ScreenshotCaption": "new mssp 13d1"}, {"ScreenshotName": "Kaspersky-APT29-12396.png", "ScreenshotCaption": "13.d.1 MSSP report #2"}]}]}, {"SubStep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell collecting information about running processes.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12402.png", "ScreenshotCaption": "14.b.2 - MSSP report"}]}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell loading .NET assemblies to capture key strokes.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17999.png", "ScreenshotCaption": "new mssp 7a3"}]}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18010.png", "ScreenshotCaption": "new mssp 11a5-7"}]}]}, {"SubStep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell executing the GetUserNameEx API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12393.png", "ScreenshotCaption": "13.c.1 MSSP report #1"}]}]}, {"SubStep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing\u00a0$env:TEMP", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of sdelete64.exe deleting rcs.3aka3.doc.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17994.png", "ScreenshotCaption": "new mssp 4b2-4 (file deletes)"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2752.png", "ScreenshotCaption": "4.b.2 rcs file deleted"}]}]}, {"SubStep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of sdelete64.exe deleting Draft.Zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17994.png", "ScreenshotCaption": "new mssp 4b2-4 (file deletes)"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2755.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of sdelete64.exe deleting SysinternalsSuite.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17994.png", "ScreenshotCaption": "new mssp 4b2-4 (file deletes)"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2758.png", "ScreenshotCaption": "4.b.4 - sysinternalssuite.zip deleted"}]}]}, {"SubStep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Detections": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2949.png", "ScreenshotCaption": "9.c.3 - sdelete64 deleting roaming\\working.zip"}]}]}, {"SubStep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Detections": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2952.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Detections": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2950.png", "ScreenshotCaption": "Similar false positive with Data Compressed, likely due to zip in the filename."}]}]}, {"SubStep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "19.A.1", "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\System32\\m.exe", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.1", "Procedure": "Deleted exfiltrated data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration.tmp", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.1", "Procedure": "Deleted staged data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1114", "TechniqueName": "Email Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell interacting with Outlook.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12410.png", "ScreenshotCaption": "17.b.1 MSSP report"}]}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3289.png", "ScreenshotCaption": "17.a.1  details"}, {"ScreenshotName": "Kaspersky-APT29-3287.png", "ScreenshotCaption": ""}]}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1140", "TechniqueName": "Deobfuscate/Decode Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17993.png", "ScreenshotCaption": "new mssp 4A3"}]}, {"DetectionNote": "Telemetry showed PowerShell writing the files that were decompressed from the ZIP. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2734.png", "ScreenshotCaption": "4.a.3 - files created (22) #2"}, {"ScreenshotName": "Kaspersky-APT29-2735.png", "ScreenshotCaption": "4.a.2 - ps launches ps"}]}]}, {"SubStep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called \"suspicious_certutil_usage_decoding\" was generated due to certutil.exe decoding kxwn.lock. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3145.png", "ScreenshotCaption": "11.a.10 - certutil cmd line decode"}]}, {"DetectionNote": "An MSSP detection contained evidence of certutil.exe decoding the kxwn.lock payload.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18012.png", "ScreenshotCaption": "new mssp 11a10"}]}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3145.png", "ScreenshotCaption": "11.a.10 - certutil cmd line decode"}]}]}, {"SubStep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby ", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the creation of the user Toby on Scranton (10.0.1.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18023.png", "ScreenshotCaption": "new mssp 20b3"}]}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the creation of Draft.Zip by powershell.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17988.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "Telemetry showed the creation of Draft.Zip. The event was correlated to a parent Technique detection for a suspicious PowerShell process.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2650.png", "ScreenshotCaption": "2.a.5 - Creation of Draft.Zip"}]}]}, {"SubStep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the creation of working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18007.png", "ScreenshotCaption": "new mssp 9B1 and 9B5"}]}, {"DetectionNote": "Telemetry showed a file create event for powershell.exe creating working.zip.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2929.png", "ScreenshotCaption": "Triggering on  creation of a powershell process"}]}]}, {"SubStep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "An MSSP detection occurred containing the file write event for WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18020.png", "ScreenshotCaption": "new mssp or recrop current"}]}, {"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3296.png", "ScreenshotCaption": "17.b.2 - tree"}]}]}]}, {"TechniqueId": "T1084", "TechniqueName": "Windows Management Instrumentation Event Subscription", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of WMI persistence established for user Oscar.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12405.png", "ScreenshotCaption": "15.a.2 MSSP report #2"}, {"ScreenshotName": "Kaspersky-APT29-12404.png", "ScreenshotCaption": "15.a.2 MSSP report #1"}]}]}, {"SubStep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (red; high severity) called \"WMI Event Consumer Triggered\" was generated due to wmiprvse.exe executing powershell.exe. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3360.png", "ScreenshotCaption": "20.a.2 Detection of powershell obfuscation came from unpacking of command line base64 payload by their tool"}]}, {"DetectionNote": "An MSSP detection contained evidence of wmiprvse.exe executing the PowerShell stager.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12422.png", "ScreenshotCaption": "20.a.2 MSSP report"}]}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3357.png", "ScreenshotCaption": "20.a.2 - wmiprvse exe ps tree"}, {"ScreenshotName": "Kaspersky-APT29-3360.png", "ScreenshotCaption": "20.a.2 Detection of powershell obfuscation came from unpacking of command line base64 payload by their tool"}]}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing\u200b Gwmi Win32_OperatingSystem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of execution of WMI queries for Win32_BIOS and Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18009.png", "ScreenshotCaption": "new mssp 11a3 and 11a4"}]}]}, {"SubStep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing the GetComputerNameEx API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12390.png", "ScreenshotCaption": "13.a.1 MSSP report"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scanton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of psexec64 establishing an IPC share on Scranton (10.0.1.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-18004.png", "ScreenshotCaption": "new mssp 8c2"}]}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2895.png", "ScreenshotCaption": "Saw connection over SMB between systems"}]}]}]}, {"TechniqueId": "T1047", "TechniqueName": "Windows Management Instrumentation", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (red; high severity) called \"commandline_wmi_event_consumer_triggered\"  was generated due to WmiPrvSE.exe executing powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3210.png", "ScreenshotCaption": ""}, {"ScreenshotName": "Kaspersky-APT29-3208.png", "ScreenshotCaption": ""}]}, {"DetectionNote": "An MSSP detection contained evidence of WmiPrvSE.exe executing powershell.exe to execute the Win32_AuditCode WMI class.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12398.png", "ScreenshotCaption": "14.b.1 MSSP report #1"}, {"ScreenshotName": "Kaspersky-APT29-12399.png", "ScreenshotCaption": "14.b.1 MSSP report #2"}]}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-3210.png", "ScreenshotCaption": ""}]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A General alert detection (red; high severity) for \"Suspicious PowerShell\" was generated due to execution of powershell.exe by control.exe. ", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2709.png", "ScreenshotCaption": "3.b.2 - powershell from control with alert"}, {"ScreenshotName": "Kaspersky-APT29-2710.png", "ScreenshotCaption": "There was no indication the PowerShell process was high integrity."}]}, {"DetectionNote": "An MSSP detection for \"Possible UAC Bypass\" contained evidence of a new highiIntegrity PowerShell callback spawning from control.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17991.png", "ScreenshotCaption": "new mssp 3b2"}]}, {"DetectionNote": "Telemetry showed PowerShell spawning from control.exe\u200b\u200b.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2709.png", "ScreenshotCaption": "3.b.2 - powershell from control with alert"}]}]}, {"SubStep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A General alert detection (red; high severity) for \"Suspicious PowerShell\" was generated due to execution of powershell.exe by control.exe.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17915.png", "ScreenshotCaption": "14a2 - new vendor pic"}]}, {"DetectionNote": "An MSSP detection contained evidence of High Integrity PowerShell process spawned from control.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12397.png", "ScreenshotCaption": "14.a.1-3 MSSP report"}]}]}]}, {"TechniqueId": "T1027", "TechniqueName": "Obfuscated Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within\u00a0monkey.png", "Detections": [{"DetectionNote": "A Technique alert detection (red; high severity) for suspicious command-line obfuscation was generated for PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert for suspicious PowerShell.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2694.png", "ScreenshotCaption": "tree for powershell command"}, {"ScreenshotName": "Kaspersky-APT29-2693.png", "ScreenshotCaption": "powershell decoding script from monkey.png (likely 3.b.2)"}, {"ScreenshotName": "Kaspersky-APT29-2693.png", "ScreenshotCaption": "powershell decoding script from monkey.png (likely 3.b.2)"}]}, {"DetectionNote": "An MSSP detection contained evidence of a PowerShell script in monkey.png.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-17989.png", "ScreenshotCaption": "new mssp 3a2"}]}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2693.png", "ScreenshotCaption": "powershell decoding script from monkey.png (likely 3.b.2)"}]}]}, {"SubStep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Detections": [{"DetectionNote": "An MSSP detection contained evidence that WindowsParentalControlMigration.tmp was a ZIP archive with a gif file header.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12414.png", "ScreenshotCaption": "17.c.2 MSSP report #2"}, {"ScreenshotName": "Kaspersky-APT29-12413.png", "ScreenshotCaption": "17.c.2 MSSP report #1"}]}]}]}, {"TechniqueId": "T1065", "TechniqueName": "Uncommonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Detections": [{"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-2632.png", "ScreenshotCaption": "1.a.3 - connection to 192.168.0.5:1234"}]}]}]}, {"TechniqueId": "T1120", "TechniqueName": "Peripheral Device Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence for the execution of an WMI query for Win32_PnPEntity.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Kaspersky-APT29-12376.png", "ScreenshotCaption": "11.a.3-5 MSSP report"}, {"ScreenshotName": "Kaspersky-APT29-12376.png", "ScreenshotCaption": "11.a.3-5 MSSP report"}]}]}]}, {"TechniqueId": "T1119", "TechniqueName": "Automated Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}]}