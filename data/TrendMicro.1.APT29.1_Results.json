{"PublicRelease": "\u00a92020 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-03607-4", "Techniques": [{"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process \u200bOR the original filename (cod.3aka.scr)", "Detections": [{"DetectionNote": "A Technique detection called \"RTLO.Masquerading T1036\" was generated when an executable ran containing a RTLO character.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12293.png"}], "Footnotes": ["The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change."]}, {"DetectionNote": "Telemetry showed the original filename\u200b cod.3aka.scr, which became rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11813.png"}]}]}, {"SubStep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesschk.exe is not the legitimate Sysinternals tool", "Detections": [{"DetectionNote": "A General alert detection (suspicious severity) called \"Low global prevalence without signer\" was generated for accesscheck.exe, indicating it is not the legitimate Sysinternals tool. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11909.png"}]}, {"DetectionNote": "An MSSP detection occurred for accesschk.exe not being the legitimate Sysinternals tool due to a low census prevalence and the binary was unsigned.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12679.png"}]}, {"DetectionNote": "Telemetry showed that accesschk.exe received a reputation report that indicated it was known to be an untrusted file with the maximum suspicion rating, which indicates it is not a legitimate Sysinternals tool. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11909.png"}]}]}]}, {"TechniqueId": "T1028", "TechniqueName": "Windows Remote Management", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection (low severity) called \"Powershell Remote Command Execution Via WinRM\" was generated due to a connection to remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11959.png"}]}, {"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection called \"Powershell Remote Command Execution Via WinRM\" (low severity) was generated due to a connection to host NewYork (10.0.0.4) over port 5985.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14498.png"}]}, {"DetectionNote": "A Technique detection called \"WinRM Service Detected\" was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12130.png"}]}, {"DetectionNote": "An MSSP detection occurred for \"Powershell remote command execution via WinRM\". ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection called \"Identified Usage of Windows Remote Management\" was generated due to the WinRM session to remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17578.png"}]}, {"DetectionNote": "A Technique alert detection (low severity) called \"Windows Remote Management\" was generated for PowerShell with an open network connection to remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12213.png"}]}, {"DetectionNote": "An MSSP detection occurred for a golden ticket being used to establish a WinRM connection to host Scranton (10.0.0.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12693.png"}]}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1097", "TechniqueName": "Pass the Ticket", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Detections": [{"DetectionNote": "An MSSP detection occurred for a golden ticket being created and used.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12693.png"}]}, {"DetectionNote": "Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12217.png"}]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe\u00a0spawning from the rcs.3aka3.doc\u200b process", "Detections": [{"DetectionNote": "An MSSP detection was generated for cmd.exe spawning from rcs.3aka3.doc.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14004.png"}]}, {"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11836.png"}]}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.A.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe\u00a0executing\u200b Get-WmiObject ...\u200b -Class\u00a0AntiVirusProduct", "Detections": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11876.png"}]}]}, {"SubStep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe\u00a0executing Get-WmiObject\u00a0...\u200b\u200b -Class\u00a0FireWallProduct", "Detections": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11876.png"}]}]}, {"SubStep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell enumerating registered AV products. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12689.png"}]}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12058.png"}]}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Detections": [{"DetectionNote": "An MSSP detection occurred for accesschk.exe reading the Chrome database file for credentials.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12679.png"}]}, {"DetectionNote": "Telemetry showed accesschk.exe reading the Chrome database file for credentials. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11907.png"}]}]}]}, {"TechniqueId": "T1099", "TechniqueName": "Timestomp", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Detections": [{"DetectionNote": "A Technique detection called \"Timestomping\" was generated due to time modification of kxwn.lock. ", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12079.png"}]}, {"DetectionNote": "An MSSP detection occurred for evidence of file timestamp manipulation.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12689.png"}]}, {"DetectionNote": "Telemetry showed script block with commands to timestomp kxwn.lock.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby ", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Create Account\" was generated for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17580.png"}]}, {"DetectionNote": "An MSSP detection occurred for a new user Toby being created. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12693.png"}]}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17582.png"}]}]}]}, {"TechniqueId": "T1140", "TechniqueName": "Deobfuscate/Decode Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}]}, {"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11875.png"}, {"ScreenshotName": "TrendMicro-APT29-11873.png"}]}]}, {"SubStep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Detections": [{"DetectionNote": "A General alert detection (high severity) called \"Certutil Execution (Suspicious use)\" was generated identifying suspicious use of certutil.exe.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12065.png"}]}, {"DetectionNote": "An MSSP detection occurred for certutil.exe being used to decode the payload.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12688.png"}]}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload. ", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Detections": [{"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12108.png"}]}]}]}, {"TechniqueId": "T1114", "TechniqueName": "Email Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Detections": [{"DetectionNote": " An MSSP detection occurred for outlook using function psemail to dump outlook messages.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}]}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17561.png"}]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.4", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Detections": [{"DetectionNote": "A Technique detection called \"Standard Application Layer Protocol\" was generated due to the PowerShell process exchanging data with 192.168.0.5 over HTTPS.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11866.png"}]}]}, {"SubStep": "11.A.14", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Detections": [{"DetectionNote": "A Technique detection called \"Standard Application Layer Protocol\" was generated due to PowerShell making network connection to C2 (192.168.0.4) over HTTPS.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12075.png"}]}, {"DetectionNote": "An MSSP detection occurred for the network connection over HTTPS. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12688.png"}]}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "A Technique alert detection called \"Process Discovery\" (low severity) was generated due to powershell.exe executing Get-Process.\n", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12318.png"}], "Footnotes": ["The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change."]}, {"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing Get-Process. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11877.png"}]}]}, {"SubStep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Detections": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}]}]}, {"SubStep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "A Technique alert detection (low severity) called \"Process Discovery\" was generated due to powershell.exe executing Get-Process. ", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12324.png"}], "Footnotes": ["The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change."]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11962.png"}]}]}, {"SubStep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing Win32_Process. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12071.png"}]}]}, {"SubStep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the API call in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12266.png"}], "Footnotes": ["The script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation. "]}]}, {"SubStep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "A Technique detection called \"PS1.ProcessDiscover T1057\" was generated due to powershell.exe executing Get-Process.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12110.png"}]}, {"DetectionNote": "An MSSP detection occurred for PowerShell executing Get-Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}]}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12104.png"}]}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Detections": [{"DetectionNote": "A Technique detection mapped to \"T1056\" (Input Capture) was generated due to powershell.exe executing GetAsyncKeyState. ", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11934.png"}, {"ScreenshotName": "TrendMicro-APT29-11933.png"}]}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Registry Run Keys / Startup Folder\" was generated due to PowerShell creating the hostui.lnk file. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11900.png"}]}, {"DetectionNote": "An MSSP detection occurred for PowerShell dropping the hostui.lnk file.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12679.png"}]}, {"DetectionNote": "Telemetry showed the file write of hostui.lnk in the Startup folder.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Detections": [{"DetectionNote": "An MSSP detection occurred for hostui.lnk executing from Startup Folder. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12682.png"}]}, {"DetectionNote": "Telemetry showed hostui.lnk executing from the Startup Folder.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12042.png"}]}]}, {"SubStep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Registry Run Keys / Startup Folder\" was generated for powershell.exe adding Run key persistence into the Registry.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12067.png"}]}, {"DetectionNote": "An MSSP detection occurred for PowerShell creating persistence by modifying the Registry which launches at startup. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12688.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scanton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Executable file dropped in administrative share\"  was generated due PSEXESVC.exe being copied to Scranton.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11975.png"}]}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Detections": [{"DetectionNote": "A Technique alert detection called \"File Deletion\" (medium severity) was generated due to sdelete64.exe deleting rcs.3aka3.doc. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11886.png"}, {"ScreenshotName": "TrendMicro-APT29-11879.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting rcs.3aka3.doc. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11886.png"}, {"ScreenshotName": "TrendMicro-APT29-14014.png"}]}]}, {"SubStep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Detections": [{"DetectionNote": "A Technique alert detection called \"File Deletion\" (medium severity) was generated due to sdelete64.exe deleting Draft.zip. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11882.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.Zip. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11885.png"}]}]}, {"SubStep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "A Technique alert detection called \"File Deletion\" (medium severity) was generated due to sdelete64.exe deleting SysinternalsSuite.zip. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11881.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with commTelemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11883.png"}]}]}, {"SubStep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Detections": [{"DetectionNote": "A General alert detection for \"SysInternal Tools License Suppression\" (low severity) was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14024.png"}]}, {"DetectionNote": "A MSSP detection occurred for the file deletion of rar.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14023.png"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe deleting rar.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12013.png"}]}]}, {"SubStep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Detections": [{"DetectionNote": "A General alert detection for \"SysInternal Tools License Suppression\" (low severity) was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14025.png"}]}, {"DetectionNote": "A MSSP detection occurred for the file deletion of Desktop\\working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14023.png"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe deleting Desktop\\working.zip.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12013.png"}]}]}, {"SubStep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Detections": [{"DetectionNote": "A Technique alert detection for \"Possible SDELETE\" (medium severity) was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14026.png"}]}, {"DetectionNote": "A MSSP detection occurred for the file deletion of Roaming\\working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14023.png"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe deleting Roaming\\working.zip.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12017.png"}]}]}, {"SubStep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "19.A.1", "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\System32\\m.exe", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.1", "Procedure": "Deleted exfiltrated data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration.tmp", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.1", "Procedure": "Deleted staged data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell making a new service named javamtsup. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12678.png"}]}, {"DetectionNote": "Telemetry showed a Registry event and service creation of javamtsup.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11898.png"}]}]}]}, {"TechniqueId": "T1005", "TechniqueName": "Data from Local System", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11845.png"}]}]}, {"SubStep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of  powershell.exe accessing files from C:\\Users\\pam\\Downloads. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12680.png"}]}, {"DetectionNote": "Telemetry showed Powershell.exe accessing files from C:\\Users\\pam\\Downloads. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11947.png"}]}]}, {"SubStep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "Telemetry showed file accesses of C:\\Users\\Pam\\*.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12009.png"}]}]}, {"SubStep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "A MSSP detection occurred for a file collected from C:\\Users\\oscar\\Documents. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}]}, {"DetectionNote": "Telemetry showed the file access of MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for  PowerShell executing an ADS.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17563.png"}]}]}]}, {"TechniqueId": "T1084", "TechniqueName": "Windows Management Instrumentation Event Subscription", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Detections": [{"DetectionNote": "A Technique alert detection (medium risk) called \"Windows Management Instrumentation Event Subscription\" was generated due to the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12123.png"}]}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12120.png"}]}]}, {"SubStep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Detections": [{"DetectionNote": "An MSSP detection occurred for WMI event subscription executing the PowerShell. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12693.png"}]}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12206.png"}]}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetGroups\u00a0API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing NetUserGetGroups API.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11896.png"}]}]}, {"SubStep": "4.C.11", "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetLocalGroups\u00a0API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing NetUserGetLocalGroups API.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11896.png"}]}]}]}, {"TechniqueId": "T1106", "TechniqueName": "Execution through API", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Detections": [{"DetectionNote": "A Technique detection \"Noteworthy Behavior T1134\" was generated for token manipulation with the low level ZwDuplicateToken (NtDuplicateToken) API, which is invoked by the CreateProcessWithToken API.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12039.png"}]}]}, {"SubStep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12267.png"}], "Footnotes": ["The script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation. "]}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Detections": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11861.png"}]}]}, {"SubStep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the file write of the ZIP by PowerShell. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}]}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11872.png"}]}]}, {"SubStep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Detections": [{"DetectionNote": "A General alert detection (suspicious severity) was generated for the file write event of python.exe. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11965.png"}]}, {"DetectionNote": "A General detection was generated for python.exe being a potential virus or malware. ", "DetectionType": "General", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11968.png"}]}, {"DetectionNote": "Telemetry showed the file write event of python.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file rar.exe", "Detections": [{"DetectionNote": "Telemetry showed a file create event for python.exe creating rar.exe. The detection was correlated to a parent alert for service execution on python.exe. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11993.png"}]}]}, {"SubStep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file sdelete64.exe", "Detections": [{"DetectionNote": "Telemetry showed File Create event for python.exe creating sdelete64.exe. The detection was correlated to a parent alert for service execution on python.exe. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11993.png"}]}]}, {"SubStep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Detections": [{"DetectionNote": "A General alert detection (medium severity) was generated for \"Malicious content\" due to the HTTP download of m.exe. ", "DetectionType": "General", "Modifiers": ["Configuration Change (Detections)", "Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12365.png"}], "Footnotes": ["The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change."]}, {"DetectionNote": "An MSSP detection occurred for PowerShell downloading m.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}]}, {"DetectionNote": "Telemetry showed the file create event for m.exe into the System32 folder. The detection was correlated to a parent alert for  PowerShell executing an ADS.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12100.png"}]}]}, {"SubStep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Detections": [{"DetectionNote": "A General detection was generated for \"Microsoft Windows - System .dll or .exe files modified\".", "DetectionType": "General", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12148.png"}]}, {"DetectionNote": "A General detection was generated for \"Suspicious Files Detected in Operating System Directories\".", "DetectionType": "General", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14499.png"}]}, {"DetectionNote": "An MSSP detection occurred for the file write of m.exe to remote host NewYork (10.0.0.4). ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12694.png"}]}, {"DetectionNote": "Telemetry showed  the file write of m.exe to System32 directory by wsmprovhost.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1086", "TechniqueName": "PowerShell", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u00a0spawning from cmd.exe", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17548.png"}, {"ScreenshotName": "TrendMicro-APT29-17549.png"}, {"ScreenshotName": "TrendMicro-APT29-11836.png"}]}]}, {"SubStep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Detections": [{"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11872.png"}]}]}, {"SubStep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u200b spawning from python.exe", "Detections": [{"DetectionNote": "Telemetry showed python.exe executing powershell.exe\u200b. The detection was correlated to a parent alert for service execution on python.exe. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11995.png"}]}]}, {"SubStep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing IEX. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12049.png"}]}]}, {"SubStep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Detections": [{"DetectionNote": "A Technique detection called \"PowerShell\" was generated due to a SYSTEM-level PowerShell spawned from wmiprvse.exe.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17575.png"}]}, {"DetectionNote": "An MSSP detection occurred for WMI event subscription executing a SYSTEM-level PowerShell instance. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12693.png"}]}, {"DetectionNote": "Telemetry showed a SYSTEM-level powershell.exe spawning from wmiprvse.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12206.png"}]}]}]}, {"TechniqueId": "T1122", "TechniqueName": "Component Object Model Hijacking", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of\u00a0the DelegateExecute\u00a0\u200bsubkey in\u00a0\u200bHKCU\\Software\\Classes\\Folder\\shell\\open\\\u200b\u200bcommand\u200b\u200b", "Detections": [{"DetectionNote": "A Technique detection \"Noteworthy Behavior T1122\" was generated due to the addition of the DelegateExecute Registry Value. ", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12314.png"}], "Footnotes": ["The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change."]}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17559.png"}]}]}, {"SubStep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Detections": [{"DetectionNote": "An MSSP detection occurred for the addition of the DelegateExecute subkey to enable COM hijacking. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}]}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12091.png"}]}]}]}, {"TechniqueId": "T1045", "TechniqueName": "Software Packing", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Detections": [{"DetectionNote": "An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12787.png"}]}, {"DetectionNote": "Telemetry showed python.exe is packed. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11970.png"}]}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Detections": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}]}]}, {"SubStep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing\u200b Gwmi Win32_OperatingSystem", "Detections": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing: Gwmi Win32_OperatingSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11876.png"}]}]}, {"SubStep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing Win32_BIOS and Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12071.png"}]}]}, {"SubStep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the API call in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12266.png"}], "Footnotes": ["The script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation. "]}]}]}, {"TechniqueId": "T1112", "TechniqueName": "Modify Registry", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Detections": [{"DetectionNote": "A MSSP detection occurred for the deletion of the the command subkey.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}]}, {"DetectionNote": "Telemetry showed the deletion of the command subkey. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11870.png"}]}]}, {"SubStep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command\u00a0subkey", "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell removing the Registry value. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}]}, {"DetectionNote": "Telemetry showed the deletion of the Registry value. The detection was correlated to a parent alert for  PowerShell executing an ADS.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12098.png"}]}]}]}, {"TechniqueId": "T1102", "TechniqueName": "Web Service", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Detections": [{"DetectionNote": "A General alert detection (low severity) for \"Shared Resource Mapping (net use)\" was generated for net.exe making a network connection to public IP over port 443.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12173.png"}]}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for  PowerShell executing an ADS.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12200.png"}]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence that the 7z file was password protected.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12680.png"}]}]}, {"SubStep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Detections": [{"DetectionNote": "A MSSP detection occurred for rar.exe executing with command line arguments. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12685.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for service execution on python.exe. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12004.png"}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence PowerShell checked for installed software by querying the registry. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}]}, {"DetectionNote": "Telemetry showed script block with registry query for installed software.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12221.png"}]}]}, {"SubStep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence PowerShell checked for installed software by querying the registry. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}]}, {"DetectionNote": "Telemetry showed script block with registry query for installed software.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12221.png"}]}]}]}, {"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Detections": [{"DetectionNote": "An MSSP detection occurred for a previously planted persistence mechanism executing rundll32.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12693.png"}]}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17571.png"}]}]}]}, {"TechniqueId": "T1497", "TechniqueName": "Virtualization/Sandbox Evasion", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing Win32_BIOS. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12071.png"}]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Detections": [{"DetectionNote": "A General detection for \"Suspicious Behavior\" was generated due to LDAP queries to NewYork (10.0.0.4) over port 389. ", "DetectionType": "General", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11957.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Detections": [{"DetectionNote": "A General detection alert (informational severity) called \"LDAP SASL Connection Detected\" was generated for PowerShell  making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12140.png"}, {"ScreenshotName": "TrendMicro-APT29-12138.png"}]}, {"DetectionNote": "Telemetry showed PowerShell executing the Get-NetDomainController cmdlet and subsequently making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1027", "TechniqueName": "Obfuscated Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within\u00a0monkey.png", "Detections": [{"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17557.png"}]}]}, {"SubStep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Detections": [{"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12107.png"}]}]}, {"SubStep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of WindowsParentalControlMigration.tmp changing from PKZIP to GIF. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}]}, {"DetectionNote": "Telemetry showed WindowsParentalControlMigration.tmp filetype changing from PKZIP to GIF.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17567.png"}]}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "A Technique detection \"PS1.DiscoverCollectLocal T1083\" was generated for PowerShell enumerating files and directories using ChildItem recursively.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17552.png"}], "Footnotes": ["The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change."]}, {"DetectionNote": "An MSSP detection occurred showing evidence of PowerShell looking for certain files in a directory. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12674.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11846.png"}]}]}, {"SubStep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing\u00a0$env:TEMP", "Detections": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions. Details showing a PowerShell command containing $env:TEMP were verified.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}]}]}, {"SubStep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "A Technique detection \"PS1.DiscoverCollectLocal T1083\" was generated for PowerShell enumerating files and directories using ChildItem recursively.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14022.png"}], "Footnotes": ["The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change."]}, {"DetectionNote": "A MSSP detection occurred for PowerShell looking for certain files in a directory. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12788.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem\u200b.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12002.png"}]}]}, {"SubStep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Detections": [{"DetectionNote": "A Technique detection for \"ADS.Discover T1083\" was generated for PowerShell executing Get-Item from an Alternate Data Stream (ADS).", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12338.png"}], "Footnotes": ["The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change."]}]}, {"SubStep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Detections": [{"DetectionNote": "Telemetry showed the PowerShell performing numerous file reads in the System32 directory. The detection was correlated to a parent alert for  PowerShell executing an ADS.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12271.png"}]}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav\u00a0network share (192.168.0.4:80)", "Detections": [{"DetectionNote": "A General alert detection for \"Suspicious Behavior\" (low severity) was generated due to OfficeSupplies.7z being copied to remote WebDav network share (192.168.0.4:80).", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11943.png"}]}, {"DetectionNote": "Telemetry showed PoweShell Copy-Item to remote a remote adversary WebDav network share (192.168.0.4).", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though events showed the creation of the exfiltrated data within the previously mapped Y drive.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17569.png"}]}]}]}, {"TechniqueId": "T1120", "TechniqueName": "Peripheral Device Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing Win32_PnPEntity. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12071.png"}]}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Detections": [{"DetectionNote": "A Technique detection \"Noteworthy Behavior T1134\" was generated for token manipulation with the low level ZwDuplicateToken (NtDuplicateToken) API, which is invoked by the CreateProcessWithToken API.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12039.png"}]}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Detections": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}]}]}, {"SubStep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing Win32_ComputerSystem. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12071.png"}]}]}, {"SubStep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the API call in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12266.png"}], "Footnotes": ["The script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation. "]}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Detections": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions. Details showing a PowerShell command containing $env:USERNAME were verified.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}]}]}, {"SubStep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing Win32_ComputerSystem. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12071.png"}]}]}, {"SubStep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the API call in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation. ", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12266.png"}], "Footnotes": ["The script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation. "]}]}, {"SubStep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Detections": [{"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12119.png"}]}]}, {"SubStep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing siduser.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}]}, {"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the API function was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12267.png"}], "Footnotes": ["The script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation. "]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "Telemetry showed the PowerShell callback spawning from control.exe. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11867.png"}, {"ScreenshotName": "TrendMicro-APT29-11869.png"}]}]}, {"SubStep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "An MSSP detection occurred for sdclt.exe spawning a High Integrity level PowerShell. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}]}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). The detection was correlated to a parent alert for  PowerShell executing an ADS.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12143.png"}, {"ScreenshotName": "TrendMicro-APT29-12099.png"}]}]}]}, {"TechniqueId": "T1096", "TechniqueName": "NTFS File Attributes", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) called \"NTFS File Attributes\" was generated due to PowerShell executing the schemas ADS. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12064.png"}, {"ScreenshotName": "TrendMicro-APT29-12062.png"}, {"ScreenshotName": "TrendMicro-APT29-12063.png"}]}, {"DetectionNote": "An MSSP detection occurred for PowerShell accessing Alternative Data Streams (ADS) and executing its content. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12049.png"}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "A Technique detection called \"Standard Application Layer Protocol\" was generated due to the PowerShell process exchanging data with 192.168.0.5 over HTTPS.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11866.png"}]}]}, {"SubStep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "A Technique detection called \"Standard Cryptographic Protocol\" was generated due to PowerShell making network connection to C2 (192.168.0.4) over HTTPS.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12075.png"}]}, {"DetectionNote": "An MSSP detection occurred for the network connection over HTTPS. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12688.png"}]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam", "Criteria": "Successful logon as user Pam on\u00a0Scranton (10.0.1.4) ", "Detections": [{"DetectionNote": "A Technique detection called \"ATT&CK T1078 Windows Logon Success\" was generated due to a valid logon on Scranton (10.0.1.4) as user Pam. ", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11972.png"}, {"ScreenshotName": "TrendMicro-APT29-11971.png"}]}, {"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4) ", "Detections": [{"DetectionNote": "A Technique detection called \"Windows Logon Success\" was generated for the successful logon on NewYork (10.0.0.4) as user MScott.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12134.png"}]}, {"DetectionNote": "An MSSP detection occurred for valid MScott credentials being used to logon to NewYork (10.0.0.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}]}, {"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Detections": [{"DetectionNote": "A General alert detection (suspicious severity) was generated for rcs.3aka3.doc being a suspicious process.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17544.png"}]}, {"DetectionNote": "An MSSP detection occurred for user Pam executing rcs.3aka3.doc.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12674.png"}]}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17544.png"}]}]}, {"SubStep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Detections": [{"DetectionNote": "An MSSP detection was generated containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}]}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12060.png"}]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "Telemetry showed file accessed event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11847.png"}]}]}, {"SubStep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe\u00a0reading the file working.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "Telemetry showed file read event for working.zip and an existing C2 channel (192.168.0.4 over port 8443). The detection was correlated to a parent alert for service execution on python.exe. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12010.png"}, {"ScreenshotName": "TrendMicro-APT29-12012.png"}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Detections": [{"DetectionNote": "A Technique detection mapped to \"T1115\"(Clipboard Data) was generated due to powershell.exe executing Get-Clipboard.\n", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11932.png"}, {"ScreenshotName": "TrendMicro-APT29-11934.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "A Technique detection called \"Commonly Used Port\" was generated due to powershell.exe connecting to 192.168.0.5 on TCP 443. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Technique", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11866.png"}, {"ScreenshotName": "TrendMicro-APT29-11869.png"}]}, {"DetectionNote": "An MSSP detection occurred for powershell.exe connecting to 192.168.0.5 on TCP 443.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14012.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11869.png"}]}]}, {"SubStep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "A Technique detection called \"Commonly Used Port\" was generated due for powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12075.png"}]}, {"DetectionNote": "An MSSP detection occurred for the network connection over port 443. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12688.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12061.png"}]}]}]}, {"TechniqueId": "T1047", "TechniqueName": "Windows Management Instrumentation", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Detections": [{"DetectionNote": "A Technique detection called \"Windows Management Instrumentation\" was generated due to WmiPrvSE.exe executing powershell.exe. ", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12096.png"}]}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17676.png"}]}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell storing files in a zip file.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12674.png"}]}, {"DetectionNote": "Telemetry showed the creation of Draft.Zip. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11844.png"}]}]}, {"SubStep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Detections": [{"DetectionNote": "A MSSP detection occurred for PowerShell creating working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12788.png"}]}, {"DetectionNote": "Telemetry showed a File Created event for powershell.exe creating working.zip. The detection was correlated to a parent alert for service execution on python.exe. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12001.png"}]}]}, {"SubStep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "A MSSP detection occurred for a file collected then staged. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}]}, {"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for  PowerShell executing an ADS.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17563.png"}]}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Detections": [{"DetectionNote": "A Technique detection \"PS1.ScreenCapture T1113\" was generated due to CopyFromScreen API execution.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11931.png"}]}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesschk.exe executing the CryptUnprotectedData API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe\u00a0reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Detections": [{"DetectionNote": "A Technique alert detection (red 'x' indicator; high severity) called \"Credential Dumping (lsass read)\" was generated due to powershell.exe calling ReadProcessMemory on lsass.exe. \n", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11918.png"}, {"ScreenshotName": "TrendMicro-APT29-11919.png"}]}, {"DetectionNote": "An MSSP detection identified PowerShell injecting into the LSASS process. This activity was labeled as Credential Dumping.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14015.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe calling ReadProcessMemory on lsass.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11918.png"}]}]}, {"SubStep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique detection called \"Credential Dumping\" was generated due for a Lsass read.\n", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12097.png"}]}, {"DetectionNote": "An MSSP detection occurred for Mimikatz (m.exe) being used to access credentials in memory. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}]}, {"DetectionNote": "Telemetry showed a process accessing lsass.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique detection called \"Credential Dumping\" was generated due to LSASS having a suspicious process access mask. ", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12150.png"}, {"ScreenshotName": "TrendMicro-APT29-12149.png"}]}]}]}, {"TechniqueId": "T1065", "TechniqueName": "Uncommonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Detections": [{"DetectionNote": "An MSSP detection occurred for rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12674.png"}]}, {"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on port 1234.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11815.png"}]}]}]}, {"TechniqueId": "T1119", "TechniqueName": "Automated Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "A Technique detection \"PS1.DiscoverCollectLocal T1119\" was generated for PowerShell enumerating files and directories using ChildItem recursively.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17552.png"}], "Footnotes": ["The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change."]}, {"DetectionNote": "An MSSP detection occurred showing evidence of powershell.exe executing ChildItem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14011.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11846.png"}]}]}, {"SubStep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "A Technique detection \"PS1.DiscoverCollectLocal T1119\" was generated for PowerShell enumerating files and directories using ChildItem recursively.", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14022.png"}], "Footnotes": ["The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change."]}, {"DetectionNote": "A MSSP detection occurred for PowerShell looking for certain files in a directory. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12788.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem\u200b.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12002.png"}]}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Detections": [{"DetectionNote": "A Technique alert detection (high severity) for \"Service Execution\" was generated due to PSEXESVC.exe executing python.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11986.png"}]}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11989.png"}]}]}, {"SubStep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Detections": [{"DetectionNote": "An MSSP detection occurred for services.exe accessing javamtsup.exe. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12682.png"}]}, {"DetectionNote": "Telemetry showed  javamtsup.exe with parent process services.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12251.png"}]}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing\u00a0Compress-Archive", "Detections": [{"DetectionNote": "An MSSP detection occurred showing evidence of powershell.exe compressing via Compress-Archive.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14011.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11846.png"}]}]}, {"SubStep": "7.B.2", "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the OfficeSupplies.7z file create. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12680.png"}]}, {"DetectionNote": "Telemetry showed the file create event for OfficeSupplies.7z. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11940.png"}]}]}, {"SubStep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Detections": [{"DetectionNote": "A MSSP detection occurred for Data Compressed generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12685.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe. The detection was correlated to a parent alert for service execution on python.exe. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12004.png"}]}]}, {"SubStep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of data compression.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}]}, {"DetectionNote": "Telemetry showed PowerShell loading a DLL associated with compression and the subsequent creation of the tmp folder (identified as a ZIP).", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17565.png"}]}]}]}, {"TechniqueId": "T1145", "TechniqueName": "Private Keys", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Detections": [{"DetectionNote": "A Technique alert detection (low severity) called \"Private Keys\"  was generated due to Export-PfxCertificate. ", "DetectionType": "Technique", "Modifiers": ["Configuration Change (Detections)", "Alert"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12330.png"}], "Footnotes": ["The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change."]}, {"DetectionNote": "An MSSP detection occurred for the function Get-Private keys used to create $RandomFileName.pfx. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12679.png"}]}, {"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12270.png"}]}]}]}]}