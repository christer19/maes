{"PublicRelease": "\u00a92020 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-03607-4", "Techniques": [{"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process \u200bOR the original filename (cod.3aka.scr)", "Detections": [{"DetectionNote": "Telemetry showed that the file was a .scr binary, and that the filename included the unicode character for RTLO.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3713.png"}]}]}, {"SubStep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesschk.exe is not the legitimate Sysinternals tool", "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated for a \"PUP or Potentially Unwanted Program (PUP: ChromePassRecovery)\".", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3976.png"}]}, {"DetectionNote": "Telemetry showed accesschk.exe is not a signed Microsoft binary with hash values provided. This can be used to verify it is not the legitimate Sysinternals tool.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3975.png"}]}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3902.png"}]}]}, {"SubStep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}]}]}, {"SubStep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for Powershell or WinRM remoting activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4041.png"}]}]}, {"SubStep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Detections": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4167.png"}]}]}, {"SubStep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4189.png"}, {"ScreenshotName": "Carbon Black-APT29-4186.png"}]}]}, {"SubStep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "A Technique alert detection (orange indicator) was generated for PowerShell enumerating processes. The detection was correlated to a parent alert for Windows Management Instrumentation.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4223.png"}]}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed a file write of the passwordsdb output.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3981.png"}], "Footnotes": ["The vendor states that this activity would have been blocked. "]}]}]}, {"TechniqueId": "T1047", "TechniqueName": "Windows Management Instrumentation", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) for Windows Management Instrumentation was generated for WmiPrvSE.exe executing powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4236.png"}, {"ScreenshotName": "Carbon Black-APT29-4235.png"}]}, {"DetectionNote": "A General alert detection (red indicator) for Privilege Escalation was generated for suspicious PowerShell behavior. ", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4232.png"}]}, {"DetectionNote": "Telemetry showed WmiPrvSe.exe executing powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4223.png"}, {"ScreenshotName": "Carbon Black-APT29-4221.png"}]}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetGroups\u00a0API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3942.png"}, {"ScreenshotName": "Carbon Black-APT29-3938.png"}]}]}, {"SubStep": "4.C.11", "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetLocalGroups\u00a0API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3938.png"}, {"ScreenshotName": "Carbon Black-APT29-3941.png"}]}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Detections": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3780.png"}]}]}, {"SubStep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for \"Sysinternals Tools Downloaded via Command Interpreter.\" The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3885.png"}]}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3890.png"}]}]}, {"SubStep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Detections": [{"DetectionNote": "Telemetry showed the filemod event for the creation of python.exe on the remote host Scranton (10.0.1.4). Telemetry also showed the file write from the local host. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4044.png"}, {"ScreenshotName": "Carbon Black-APT29-4042.png"}]}]}, {"SubStep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file rar.exe", "Detections": [{"DetectionNote": "Telemetry showed the file create event for rar.exe by python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4058.png"}]}]}, {"SubStep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file sdelete64.exe", "Detections": [{"DetectionNote": "Telemetry showed the file create event for sdelete64.exe by python.exe.  The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4058.png"}]}]}, {"SubStep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated for .Net attempting suspicious network connections. The detection was correlated to a parent alert for Windows Management Instrumentation.\t", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4232.png"}]}, {"DetectionNote": "A General alert detection (red indicator) was generated for powershell.exe executing a fileless script or command.\t", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14756.png"}]}, {"DetectionNote": "A General alert detection (red indicator) was generated for PowerShell with network connections spawned by WMI. The detection was correlated to a parent alert for Windows Management Instrumentation.\t", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4237.png"}]}, {"DetectionNote": "Telemetry showed the PowerShell command to download m.exe. Telemetry also showed the file create event for m.exe into the System32 folder. The detection was correlated to a parent alert for Windows Management Instrumentation.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4242.png"}, {"ScreenshotName": "Carbon Black-APT29-4219.png"}]}]}, {"SubStep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for a code drop of m.exe (identified as Mimikatz by the file metadata).", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4271.png"}]}, {"DetectionNote": "Telemetry showed a filemod for the creation of m.exe in the System32 directory by wsmprovhost.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4308.png"}]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe\u00a0spawning from the rcs.3aka3.doc\u200b process", "Detections": [{"DetectionNote": "An MSSP detection was generated for cmd.exe spawning from rcs.3aka3.doc.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12751.png"}]}, {"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3724.png"}], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking Office documents or untrusted applications spawning command interpreters."]}]}]}, {"TechniqueId": "T1045", "TechniqueName": "Software Packing", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}]}]}, {"SubStep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing\u200b Gwmi Win32_OperatingSystem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}]}]}, {"SubStep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Detections": [{"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4163.png"}, {"ScreenshotName": "Carbon Black-APT29-4165.png"}]}]}, {"SubStep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4182.png"}, {"ScreenshotName": "Carbon Black-APT29-13959.png"}]}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of key logging.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12758.png"}, {"ScreenshotName": "Carbon Black-APT29-12757.png"}]}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4008.png"}]}]}]}, {"TechniqueId": "T1065", "TechniqueName": "Uncommonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Detections": [{"DetectionNote": "An MSSP detection was generated for rcs.3aka3.doc connecting to 192.168.0.5. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12751.png"}]}, {"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 over TCP port 1234.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3717.png"}, {"ScreenshotName": "Carbon Black-APT29-3709.png"}], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking Office Documents making network connections."]}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby ", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for the creation of a local user with Net.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13965.png"}, {"ScreenshotName": "Carbon Black-APT29-13966.png"}]}, {"DetectionNote": "A General alert detection (red indicator) was generated for a process spawned from PowerShell remoting (WinRM).", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13965.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell adding new user to the remote host Scranton (10.0.1.4) using net.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12778.png"}]}, {"DetectionNote": "Telemetry showed the PowerShell command to add the new User Toby to the remote host Scranton (10.0.1.4). Telemetry also subsequently showed wsmprovhost.exe spawning net.exe with the command-line arguments. The detection was correlated to a parent alert for Windows Management Instrumentation.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4395.png"}, {"ScreenshotName": "Carbon Black-APT29-4388.png"}, {"ScreenshotName": "Carbon Black-APT29-4396.png"}]}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Detections": [{"DetectionNote": "An MSSP detection was generated referencing the creation of Draft.zip for later exfiltration.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12751.png"}]}, {"DetectionNote": "Telemetry showed file creation of Draft.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3758.png"}]}]}, {"SubStep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Detections": [{"DetectionNote": "Telemetry showed a filemod event for powershell.exe creating working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4064.png"}]}]}, {"SubStep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell staging a collected file into a directory.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14758.png"}]}, {"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4330.png"}]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Detections": [{"DetectionNote": "A Technique alert detection called \"Persistence - PowerShell Startup Folder\" was generated due to hostui.lnk being written to the Startup folder. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3985.png"}, {"ScreenshotName": "Carbon Black-APT29-3984.png"}]}, {"DetectionNote": "Telemetry showed the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3983.png"}]}]}, {"SubStep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13953.png"}]}]}, {"SubStep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) for Registry Run Keys was generated based on powershell.exe modifying the Run key.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4124.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4171.png"}]}]}]}, {"TechniqueId": "T1086", "TechniqueName": "PowerShell", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u00a0spawning from cmd.exe", "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated for \"AMSI - Abnormal Fileless command-line length being executed.\" The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3737.png"}, {"ScreenshotName": "Carbon Black-APT29-3733.png"}]}, {"DetectionNote": "An MSSP detection was generated for cmd.exe spawning powershell.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12751.png"}]}, {"DetectionNote": "Telemetry showing powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3723.png"}, {"ScreenshotName": "Carbon Black-APT29-3727.png"}], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking Office documents or untrusted applications spawning command interpreters."]}]}, {"SubStep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Detections": [{"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3888.png"}], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking Powershell or untrusted applications spawning command interpreters."]}]}, {"SubStep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u200b spawning from python.exe", "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated for the execution of a abnormal fileless command-line length. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13946.png"}]}, {"DetectionNote": "Telemetry showed python.exe executing powershell.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4059.png"}]}]}, {"SubStep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for PowerShell executing hidden, encoded commands.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4123.png"}]}, {"DetectionNote": "A Technique alert detection (red indicator) was generated for powershell.exe executing encoded instructions.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4121.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4121.png"}]}]}, {"SubStep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for PowerShell executing hidden, encoded commands.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4371.png"}]}, {"DetectionNote": "A General alert detection was generated for a hidden PowerShell with an Unusual Parent.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4371.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawning from wmiprvse.exe with SYSTEM-level integrity.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4375.png"}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"AMSI - Clipboard Monitoring\" was generated for fileless_scriptload of Get-Clipboard. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4011.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell capturing clipboard data.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12757.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4012.png"}]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.4", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed powershell.exe loading of HTTP and cryptographic libraries.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13938.png"}, {"ScreenshotName": "Carbon Black-APT29-3825.png"}]}]}, {"SubStep": "11.A.14", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1028", "TechniqueName": "Windows Remote Management", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for \"Powershell or WinRM remoting activity\" based on wsmprovhost.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4040.png"}]}, {"DetectionNote": "A Tactic alert detection called \"Remote powershell activity\" was generated for the use of powershell.exe with a destination port 5985. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Tactic", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14748.png"}, {"ScreenshotName": "Carbon Black-APT29-14749.png"}]}, {"DetectionNote": "A Tactic alert detection called \"Remote Services\" was generated for the use of powershell.exe with a destination port 5985. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Tactic", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4036.png"}]}, {"DetectionNote": "A General alert detection (red indicator) was generated for suspicious fileless execution not originating from PowerShell.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4040.png"}]}, {"DetectionNote": "Telemetry showed network connection to remote host Scranton (10.0.1.4) over port TCP 5985. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4034.png"}]}]}, {"SubStep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) was generated on NewYork (10.0.0.4) for a remote PowerShell session based on the identification of the WinRM process (wsmprovhost.exe).", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4302.png"}]}, {"DetectionNote": "A Tactic alert detection (yellow indicator) was generated for powershell.exe accessing the network. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "DetectionType": "Tactic", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4298.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4298.png"}]}]}, {"SubStep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Powershell or WinRM remoting activity\" was generated for a powershell WinRM session on the remote host Scranton (10.0.1.4).", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4387.png"}]}, {"DetectionNote": "A Tactic alert detection (red indicator) called for remote PowerShell activity was generated for a PowerShell WinRM session. ", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4387.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell create a WinRM session to remote host Scranton (10.0.1.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12778.png"}]}, {"DetectionNote": "Telemetry showed PowerShell executing the Enter-PSSession cmdlet to open a network connection to the remote host Scranton (10.0.1.4). The detection was correlated to a parent alert for Windows Management Instrumentation.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4393.png"}, {"ScreenshotName": "Carbon Black-APT29-4392.png"}]}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Detections": [{"DetectionNote": "A General alert detection (blue indicator) was generated for rcs.3aka3.doc being tagged as suspicious.  ", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3707.png"}, {"ScreenshotName": "Carbon Black-APT29-3714.png"}], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking Suspect Malware from executing."]}, {"DetectionNote": "An MSSP detection for the execution of the malicious document rcs.3aka3.doc file.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12751.png"}]}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3702.png"}]}]}, {"SubStep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated for the execution of powershell.exe from explorer.exe. ", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4112.png"}]}, {"DetectionNote": "Telemetry showed explorer.exe spawning powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4112.png"}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell querying the registry.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14755.png"}]}, {"DetectionNote": "Telemetry showed script block with registry query for installed software. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13956.png"}, {"ScreenshotName": "Carbon Black-APT29-13958.png"}]}]}, {"SubStep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell querying the registry.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14755.png"}]}, {"DetectionNote": "Telemetry showed script block with registry query for installed software. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13956.png"}, {"ScreenshotName": "Carbon Black-APT29-13958.png"}]}]}]}, {"TechniqueId": "T1005", "TechniqueName": "Data from Local System", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1119", "TechniqueName": "Automated Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "An MSSP detection was generated for the use of ChildItem. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12751.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3750.png"}, {"ScreenshotName": "Carbon Black-APT29-3751.png"}]}]}, {"SubStep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4061.png"}]}]}]}, {"TechniqueId": "T1106", "TechniqueName": "Execution through API", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Delayed (Manual)", "Host Interrogation"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3938.png"}, {"ScreenshotName": "Carbon Black-APT29-3942.png"}]}]}, {"SubStep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3941.png"}, {"ScreenshotName": "Carbon Black-APT29-3938.png"}]}]}, {"SubStep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed svchost.exe interacting with powershell.exe via OpenProcess.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13954.png"}]}]}, {"SubStep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Detections": [{"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4293.png"}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3718.png"}]}]}, {"SubStep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed powershell.exe loading of HTTP and cryptographic libraries.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13938.png"}, {"ScreenshotName": "Carbon Black-APT29-3825.png"}]}]}, {"SubStep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed powershell.exe loading cryptographic libraries.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13955.png"}]}]}]}, {"TechniqueId": "T1102", "TechniqueName": "Web Service", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Detections": [{"DetectionNote": "A General alert detection was generated for net.exe making network connections. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14759.png"}]}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4333.png"}, {"ScreenshotName": "Carbon Black-APT29-4334.png"}]}]}]}, {"TechniqueId": "T1120", "TechniqueName": "Peripheral Device Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Detections": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4164.png"}]}]}]}, {"TechniqueId": "T1140", "TechniqueName": "Deobfuscate/Decode Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Detections": [{"DetectionNote": "A General alert detection (yellow indicator) for powershell.exe fileless script or command was generated for \"code_drop\" and \"detected_pup_app\". ", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3883.png"}]}, {"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive as well as the subsequent file writes. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3892.png"}, {"ScreenshotName": "Carbon Black-APT29-13939.png"}]}]}, {"SubStep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Deobfuscate/Decode Files or Information - certuil\" was generated for the use of certutil.exe decoding a payload.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4126.png"}]}, {"DetectionNote": "A Technique alert detection (red indicator) for \"Deobfuscate/Decode Files or Information\" was generated for the use of certutil.exe decoding a payload.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4126.png"}]}, {"DetectionNote": "A General alert detection (red indicator) was generated for a executable file found in memory.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14754.png"}]}, {"DetectionNote": "An MSSP detection for was received that described the adversary executing certutil.exe to decode a base64 blob into the payload kxwn.lock.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12763.png"}]}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4170.png"}, {"ScreenshotName": "Carbon Black-APT29-4127.png"}]}]}, {"SubStep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Detections": [{"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. The detection was correlated to a parent alert for Windows Management Instrumentation.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4244.png"}]}]}]}, {"TechniqueId": "T1096", "TechniqueName": "NTFS File Attributes", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated for the use of PowerShell executing with Invoke-Expression. ", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4113.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4162.png"}, {"ScreenshotName": "Carbon Black-APT29-4112.png"}]}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"T1035 & T1077 - Service Execution - psexec - target\" was generated due to a process running remotely with PsExec.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4055.png"}]}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4055.png"}]}]}, {"SubStep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Detections": [{"DetectionNote": "Telemetry showed rundll32.exe with a parent process of javamtsup.exe (identified as being spawned from services.exe).", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4101.png"}]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4026.png"}, {"ScreenshotName": "Carbon Black-APT29-13944.png"}]}]}, {"SubStep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13948.png"}, {"ScreenshotName": "Carbon Black-APT29-4060.png"}]}]}]}, {"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of rundll32.exe executing kxwn.lock.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12778.png"}]}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4364.png"}]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4029.png"}]}]}, {"SubStep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389 and a modload for System.DirectoryServices.dll. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4292.png"}, {"ScreenshotName": "Carbon Black-APT29-14757.png"}, {"ScreenshotName": "Carbon Black-APT29-4267.png"}]}]}]}, {"TechniqueId": "T1112", "TechniqueName": "Modify Registry", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Detections": [{"DetectionNote": "Telemetry showed the deletion of the command subkey. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3854.png"}, {"ScreenshotName": "Carbon Black-APT29-3851.png"}]}]}, {"SubStep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command\u00a0subkey", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the deletion of the DelegateExecute Registry value.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12767.png"}]}, {"DetectionNote": "Telemetry showed the deletion of the Registry value. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4207.png"}, {"ScreenshotName": "Carbon Black-APT29-4205.png"}]}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav\u00a0network share (192.168.0.4:80)", "Detections": [{"DetectionNote": "Telemetry showed PowerShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4028.png"}]}]}, {"SubStep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14758.png"}]}, {"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a OneDrive account, along with the creation of the exfiltrated data within the OneDrive. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4344.png"}, {"ScreenshotName": "Carbon Black-APT29-4341.png"}]}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.A.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesschk.exe executing the CryptUnprotectedData API", "Detections": [{"DetectionNote": "An MSSP detection was generated for the execution of accesschk.exe to dump passwords.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12755.png"}]}]}, {"SubStep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe\u00a0reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe opening a handle to a lsass.exe thread. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4017.png"}]}]}, {"SubStep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Credential Dumping\" was generated for command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for Windows Management Instrumentation.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4238.png"}, {"ScreenshotName": "Carbon Black-APT29-4239.png"}]}, {"DetectionNote": "A General alert detection (red indicator) was generated for powershell.exe executing a fileless script or command.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4219.png"}], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking powershell from executing untrusted applications or blocking PUP applications from executing. Credential dumping can be blocked by preventing untrusted applications from reading the memory of other processes."]}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing Mimikatz to obtain login credentials.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12768.png"}]}, {"DetectionNote": "Telemetry showed m.exe opening lsass.exe with OpenProcess. The detection was correlated to a parent alert for Windows Management Instrumentation.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4225.png"}]}]}, {"SubStep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Credential Dumping\" was generated for command-line arguments indicative of Mimikatz credential dumping.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13962.png"}]}, {"DetectionNote": "A General detection was generated for process injection by m.exe. The detection was correlated to a parent alert for a code drop of m.exe.", "DetectionType": "General", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4274.png"}], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking PUP applications from executing. Credential dumping can be prevented by implementing rules blocking untrusted applications reading the memory of another process."]}, {"DetectionNote": "Telemetry showed m.exe opening lsass.exe with OpenProcess. The detection was correlated to a parent alert for a code drop of m.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4271.png"}]}]}]}, {"TechniqueId": "T1099", "TechniqueName": "Timestomp", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell modifying filesystem access and write times of the kxwn.lock file.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14755.png"}]}, {"DetectionNote": "Telemetry showed script block with commands to timestomp kxwn.lock as well as the execution of the timestomp function against the kxwn.lock file. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4146.png"}, {"ScreenshotName": "Carbon Black-APT29-4145.png"}]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam", "Criteria": "Successful logon as user Pam on\u00a0Scranton (10.0.1.4) ", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the analyst was able to query to get a list of users logged on to remote host Scranton (10.0.1.4).", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4056.png"}]}]}, {"SubStep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4) ", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the analyst was able to query the DC to get a list of users logged on.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4300.png"}]}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}]}]}, {"SubStep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4165.png"}]}]}, {"SubStep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell calling the GetUserNameEx API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4189.png"}, {"ScreenshotName": "Carbon Black-APT29-4182.png"}]}]}, {"SubStep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Detections": [{"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4258.png"}]}]}, {"SubStep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4293.png"}]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A Tactic alert detection was generated for \"Privilege Escalation\" based on suspicious PowerShell behavior.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3799.png"}]}, {"DetectionNote": "An MSSP detection was generated for the use of sdclt.exe as a high privilege process, which called control.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12752.png"}]}, {"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3793.png"}]}]}, {"SubStep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A Technique alert detection was generated for bypassing UAC with sdclt.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4195.png"}, {"ScreenshotName": "Carbon Black-APT29-4193.png"}, {"ScreenshotName": "Carbon Black-APT29-4194.png"}]}, {"DetectionNote": "A Tactic alert detection was generated for supicious privilege escalation process behavior by PowerShell.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4193.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell elevating privileges via a UAC bypass using sdclt.exe and control.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12767.png"}]}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"File Deletion - sdelete execution\" was generated due to Sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3915.png"}]}, {"DetectionNote": "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3915.png"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments and subsequently writing to and deleting the file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3903.png"}, {"ScreenshotName": "Carbon Black-APT29-13940.png"}]}]}, {"SubStep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"File Deletion - sdelete execution\"  was generated due to Sdelete64.exe deleting Draft.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3911.png"}]}, {"DetectionNote": "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting Draft.Zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3911.png"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments and subsequently writing to and deleting the file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13941.png"}, {"ScreenshotName": "Carbon Black-APT29-3903.png"}]}]}, {"SubStep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"File Deletion - sdelete execution\" was generated due to Sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3914.png"}]}, {"DetectionNote": "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3914.png"}]}, {"DetectionNote": "An MSSP detection was generated for the of SysinternalsSuite.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12754.png"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments and subsequently writing to and deleting the file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13942.png"}, {"ScreenshotName": "Carbon Black-APT29-3903.png"}]}]}, {"SubStep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called File Deletion was generated when sdelete64.exe with command-line arguments was used to delete Rar.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13949.png"}]}, {"DetectionNote": "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting Rar.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13949.png"}]}, {"DetectionNote": "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13951.png"}, {"ScreenshotName": "Carbon Black-APT29-13950.png"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4078.png"}, {"ScreenshotName": "Carbon Black-APT29-4074.png"}]}]}, {"SubStep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called File Deletion was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4075.png"}]}, {"DetectionNote": "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting Desktop\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4075.png"}]}, {"DetectionNote": "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13951.png"}, {"ScreenshotName": "Carbon Black-APT29-13950.png"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4075.png"}, {"ScreenshotName": "Carbon Black-APT29-4074.png"}]}]}, {"SubStep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Detections": [{"DetectionNote": "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13951.png"}, {"ScreenshotName": "Carbon Black-APT29-13950.png"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13952.png"}, {"ScreenshotName": "Carbon Black-APT29-4076.png"}]}]}, {"SubStep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Detections": [{"DetectionNote": "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13951.png"}, {"ScreenshotName": "Carbon Black-APT29-13950.png"}]}, {"DetectionNote": "Telemetry showed cmd.exe deleting sdelete64.exe and filemod(delete) event. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4079.png"}]}]}, {"SubStep": "19.A.1", "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\System32\\m.exe", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.1", "Procedure": "Deleted exfiltrated data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration.tmp", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.1", "Procedure": "Deleted staged data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator)  called \"Screen Capture using Powershell\" was generated for a powershell.exe modload for gdiplus.dll. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4004.png"}]}, {"DetectionNote": "An MSSP detection was generated containing evidence of PowerShell capturing screenshots.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12757.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4007.png"}]}]}]}, {"TechniqueId": "T1114", "TechniqueName": "Email Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Fileless Reconnaissance of Outlook Folder data\"  was generated for powershell.exe interacting with Outlook.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4319.png"}]}, {"DetectionNote": "A General alert detection (red indicator) called \"Suspicious loading of Outlook .NET assembly\"  was generated for powershell.exe interacting with an Outlook DLL.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4319.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell collecting emails.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14758.png"}]}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4315.png"}, {"ScreenshotName": "Carbon Black-APT29-4322.png"}]}]}]}, {"TechniqueId": "T1027", "TechniqueName": "Obfuscated Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within\u00a0monkey.png", "Detections": [{"DetectionNote": "A General alert detection was generated for the execution of the PowerShell executing a fileless script or command. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3788.png"}, {"ScreenshotName": "Carbon Black-APT29-3790.png"}]}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3793.png"}]}]}, {"SubStep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Detections": [{"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent alert for Windows Management Instrumentation.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4241.png"}]}]}, {"SubStep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Detections": [{"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4326.png"}]}]}]}, {"TechniqueId": "T1145", "TechniqueName": "Private Keys", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated for \"PFX Extraction via PowerShell\" on filemod of the $RandomFileName.pfx file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4015.png"}]}, {"DetectionNote": "An MSSP detection was generated for a file create event of $RandomFileName.pfx file by powershell.exe. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12756.png"}]}, {"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13943.png"}, {"ScreenshotName": "Carbon Black-APT29-4016.png"}]}]}]}, {"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3824.png"}], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking powershell making network connections."]}]}, {"SubStep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated for .NET attempting to make suspicious network connections.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4119.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4110.png"}], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking powershell making network connections."]}]}]}, {"TechniqueId": "T1084", "TechniqueName": "Windows Management Instrumentation Event Subscription", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for PowerShell establishing WMI event subscription persistence.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13961.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell establishing WMI event subscription persistence.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12769.png"}]}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4258.png"}, {"ScreenshotName": "Carbon Black-APT29-4264.png"}]}]}, {"SubStep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for a PowerShell with network connections launched by WMI.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13964.png"}]}, {"DetectionNote": "A Technique alert detection (red indicator) was generated for Windows Management Instrumentation based on wmiprvse.exe executing PowerShell stager.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13963.png"}]}, {"DetectionNote": "A General alert detection was generated for PowerShell having an unusual parent.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4371.png"}]}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4358.png"}]}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "An MSSP detection was generated for the use of ChildItem. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12751.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3751.png"}, {"ScreenshotName": "Carbon Black-APT29-3750.png"}]}]}, {"SubStep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing\u00a0$env:TEMP", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}]}]}, {"SubStep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4061.png"}]}]}, {"SubStep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4168.png"}]}]}, {"SubStep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Detections": [{"DetectionNote": "Telemetry showed PowerShell enumeration of System32. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4145.png"}]}]}]}, {"TechniqueId": "T1122", "TechniqueName": "Component Object Model Hijacking", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of\u00a0the DelegateExecute\u00a0\u200bsubkey in\u00a0\u200bHKCU\\Software\\Classes\\Folder\\shell\\open\\\u200b\u200bcommand\u200b\u200b", "Detections": [{"DetectionNote": "An MSSP detection was generated for the Registry Modification of the command subkey.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12752.png"}]}, {"DetectionNote": "Telemetry showed the Registry modifications of the DelegateExecute \u200bRegistry value. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3795.png"}, {"ScreenshotName": "Carbon Black-APT29-3797.png"}, {"ScreenshotName": "Carbon Black-APT29-13937.png"}]}]}, {"SubStep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the addition of the DelegateExecute Registry value.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12767.png"}]}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4207.png"}, {"ScreenshotName": "Carbon Black-APT29-13960.png"}, {"ScreenshotName": "Carbon Black-APT29-4206.png"}]}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}]}]}, {"SubStep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4165.png"}]}]}, {"SubStep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4182.png"}, {"ScreenshotName": "Carbon Black-APT29-4191.png"}]}]}]}, {"TechniqueId": "T1097", "TechniqueName": "Pass the Ticket", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated for a Credential Theft Application Running. ", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4386.png"}]}, {"DetectionNote": "A General alert detection (red indicator) was generated for PowerShell running Mimikatz.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4386.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12778.png"}]}, {"DetectionNote": "Telemetry showed the contents of the Invoke-Mimikatz script along with PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session. The detection was correlated to a parent alert for Windows Management Instrumentation.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4390.png"}, {"ScreenshotName": "Carbon Black-APT29-4391.png"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scanton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Detections": [{"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13945.png"}]}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though a manual query for the showed the new service and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3957.png"}, {"ScreenshotName": "Carbon Black-APT29-3949.png"}]}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing\u00a0Compress-Archive", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Data Compressed via Command Interpreter for Staging\" was generated for a file modification with the .zip extension. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3776.png"}, {"ScreenshotName": "Carbon Black-APT29-3779.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3759.png"}, {"ScreenshotName": "Carbon Black-APT29-3751.png"}]}]}, {"SubStep": "7.B.2", "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Detections": [{"DetectionNote": "Telemetry showed the file creation event for OfficeSupplies.7z. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4028.png"}]}]}, {"SubStep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Data Compressed via Command Interpreter for Staging\" was generated due to powershell.exe executing rar.exe creating a filemod event for working.zip.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4070.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13948.png"}, {"ScreenshotName": "Carbon Black-APT29-4060.png"}]}]}, {"SubStep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell compressed a staging directory.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14758.png"}]}, {"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4331.png"}, {"ScreenshotName": "Carbon Black-APT29-4326.png"}]}]}]}, {"TechniqueId": "T1497", "TechniqueName": "Virtualization/Sandbox Evasion", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Detections": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4163.png"}]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe\u00a0reading the file working.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe\u00a0executing\u200b Get-WmiObject ...\u200b -Class\u00a0AntiVirusProduct", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}]}]}, {"SubStep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe\u00a0executing Get-WmiObject\u00a0...\u200b\u200b -Class\u00a0FireWallProduct", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}]}]}, {"SubStep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Detections": [{"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4150.png"}, {"ScreenshotName": "Carbon Black-APT29-4151.png"}]}]}]}]}